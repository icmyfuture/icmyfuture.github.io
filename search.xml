<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>go-kratos系列-其它</title>
      <link href="/2021/07/11/go-kratos-other/"/>
      <url>/2021/07/11/go-kratos-other/</url>
      <content type="html"><![CDATA[<p>本文描述了go微服务框架kratos使用过程中的一些额外事项<a id="more"></a></p><h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><h2 id="consul"><a href="#consul" class="headerlink" title="consul"></a><a href="https://www.consul.io/" target="_blank" rel="noopener">consul</a></h2><p><a href="https://www.cnblogs.com/niceyoo/p/14223158.html" target="_blank" rel="noopener">mac</a><br><a href="https://www.cnblogs.com/xingzhu-nan/p/12592834.html" target="_blank" rel="noopener">win</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ consul agent -dev</span><br><span class="line">$ curl localhost:8500</span><br></pre></td></tr></table></figure></p><h2 id="go-grpc"><a href="#go-grpc" class="headerlink" title="go grpc"></a><a href="https://grpc.io/docs/languages/go/quickstart/" target="_blank" rel="noopener">go grpc</a></h2><p><a href="https://go-kratos.dev/docs/guide/api-protobuf" target="_blank" rel="noopener">kratos pb规范</a></p><h3 id="生成api-proto"><a href="#生成api-proto" class="headerlink" title="生成api proto"></a>生成api proto</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ kratos proto add api/project/service/v1/project.proto</span><br><span class="line">$ kratos proto client api/project/service/v1/project.proto</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="comment"># 进入解决方案目录</span></span><br><span class="line">$ protoc --go_out=. \</span><br><span class="line">        --proto_path=. \</span><br><span class="line">        --proto_path=./third_party \</span><br><span class="line">        --go_opt=paths=source_relative \</span><br><span class="line">        --go-grpc_out=. \</span><br><span class="line">        --go-grpc_opt=paths=source_relative \</span><br><span class="line">        api/project/service/v1/project.proto</span><br></pre></td></tr></table></figure><h3 id="生成swagger-json"><a href="#生成swagger-json" class="headerlink" title="生成swagger json"></a><a href="https://go-kratos.dev/docs/guide/openapi" target="_blank" rel="noopener">生成swagger json</a></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="comment"># 进入解决方案目录</span></span><br><span class="line">$ protoc --proto_path=. \</span><br><span class="line">        --proto_path=./third_party \</span><br><span class="line">        --openapiv2_out . \</span><br><span class="line">        --openapiv2_opt logtostderr=<span class="literal">true</span> \</span><br><span class="line">        --openapiv2_opt json_names_for_fields=<span class="literal">false</span> \</span><br><span class="line">        api/project/service/v1/project.proto</span><br></pre></td></tr></table></figure><h3 id="生成conf-proto"><a href="#生成conf-proto" class="headerlink" title="生成conf proto"></a>生成conf proto</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="comment"># 进入解决方案目录</span></span><br><span class="line">$ protoc --go_out=. --go_opt=paths=source_relative app/project/service/internal/conf/conf.proto</span><br></pre></td></tr></table></figure><h2 id="wire"><a href="#wire" class="headerlink" title="wire"></a><a href="https://go-kratos.dev/docs/guide/wire" target="_blank" rel="noopener">wire</a></h2><p><a href="https://zhuanlan.zhihu.com/p/110453784" target="_blank" rel="noopener">生成wire文件</a></p><h2 id="Goland-Debug-配置"><a href="#Goland-Debug-配置" class="headerlink" title="Goland Debug 配置"></a>Goland Debug 配置</h2><p>Goland <code>Edit Configuration</code><br>选择<code>go build</code> -&gt; Directory<br>Directory: 选择入口go文件所在目录，如：<code>E:\src\_outer\beer-shop\app\user\service\cmd\server</code><br>勾选<code>Run after build</code><br>Working directory: 选择项目文件所在目录，如：<code>E:\src\_outer\beer-shop\app\user\service</code><br>Program arguments：填写执行时需传入的参数，如：<code>-conf E:\src\_outer\beer-shop\app\user\service\configs</code></p><h2 id="手工编译运行"><a href="#手工编译运行" class="headerlink" title="手工编译运行"></a>手工编译运行</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="comment"># 进入项目文件所在目录，如： `E:\src\_outer\beer-shop\app\user\service`</span></span><br><span class="line">$ go build -o ./bin/ ./...</span><br><span class="line">$ ./bin/server -conf ./configs</span><br></pre></td></tr></table></figure><h2 id="docker编译运行"><a href="#docker编译运行" class="headerlink" title="docker编译运行"></a>docker编译运行</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="comment"># 进入解决方案目录，如：`E:\src\_outer\beer-shop`</span></span><br><span class="line">$ docker build -f ./deploy/build/Dockerfile --build-arg APP_RELATIVE_PATH=user/service --build-arg APP_ENV=docker -t user .</span><br><span class="line">$ docker run -it --rm -p 8000:8000 -p 9000:9000 -v E:\\src\\_outer\\<span class="built_in">log</span>:/data/<span class="built_in">log</span> user</span><br></pre></td></tr></table></figure><h1 id="语言"><a href="#语言" class="headerlink" title="语言"></a>语言</h1><h1 id="库"><a href="#库" class="headerlink" title="库"></a>库</h1><h2 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h2><p>mysql连接报错: is not allowed to connect to this MySQL server<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> <span class="keyword">user</span> <span class="keyword">set</span> host = <span class="string">'%'</span> <span class="keyword">where</span> <span class="keyword">user</span> =<span class="string">'root'</span>;</span><br><span class="line"><span class="keyword">flush</span> <span class="keyword">privileges</span>;</span><br></pre></td></tr></table></figure></p><h1 id="框架"><a href="#框架" class="headerlink" title="框架"></a>框架</h1><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="https://www.cnblogs.com/chongyao/p/14867125.html" target="_blank" rel="noopener">kratos2.0 goland debug配置</a></p>]]></content>
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> go </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>go-kratos系列</title>
      <link href="/2021/07/11/go-kratos-000/"/>
      <url>/2021/07/11/go-kratos-000/</url>
      <content type="html"><![CDATA[<p>本系列描述了go微服务框架kratos使用历程<a id="more"></a></p><h1 id="概览"><a href="#概览" class="headerlink" title="概览"></a>概览</h1><p><a href="https://github.com/go-kratos/kratos" target="_blank" rel="noopener">github</a><br><a href="https://go-kratos.dev/docs/" target="_blank" rel="noopener">doc</a></p><h1 id="开始使用"><a href="#开始使用" class="headerlink" title="开始使用"></a>开始使用</h1><p>熟悉kratos</p><ul><li>项目结构</li><li>构建工具</li><li>代码示例</li></ul><h1 id="框架组件"><a href="#框架组件" class="headerlink" title="框架组件"></a>框架组件</h1><h1 id="运维部署"><a href="#运维部署" class="headerlink" title="运维部署"></a>运维部署</h1><h1 id="其它"><a href="#其它" class="headerlink" title="其它"></a><a href="/2021/07/11/go-kratos-other/">其它</a></h1>]]></content>
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> go </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>架构之旅-集群与管理-服务</title>
      <link href="/2018/08/14/iarc-220/"/>
      <url>/2018/08/14/iarc-220/</url>
      <content type="html"><![CDATA[<h1 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h1><p>本文中，将使用nginx+docker来搭建iarc-service的集群。<a id="more"></a></p><h1 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h1><p><a href="https://github.com/icmyfuture/iarc/tree/master/iarc-service" target="_blank" rel="noopener">iarc-service</a></p><h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><p>IDE: IntelliJ IDEA<br>JDK: 1.8.0_u162<br>Build: Maven 3.0.5<br>Framework: Spring Boot<br>WebServer: Nginx<br>Container: Docker</p><h1 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h1><p>以下步骤在CentOS7中完成</p><h2 id="创建Dockerfile"><a href="#创建Dockerfile" class="headerlink" title="创建Dockerfile"></a>创建Dockerfile</h2><p>在iarc-service根目录下新建文件’Dockerfile’，内容如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FROM frolvlad/alpine-oraclejdk8:slim</span><br><span class="line">ADD ./target/iarc-service-0.0.1-SNAPSHOT.war app.war</span><br><span class="line">ENTRYPOINT [&quot;java&quot;,&quot;-Djava.security.egd=file:/dev/./urandom&quot;,&quot;-jar&quot;,&quot;/app.war&quot;]</span><br></pre></td></tr></table></figure></p><h2 id="构建docker镜像"><a href="#构建docker镜像" class="headerlink" title="构建docker镜像"></a>构建docker镜像</h2><p><code>docker build -t iarc/iarc-service .</code></p><h2 id="运行2个docker容器"><a href="#运行2个docker容器" class="headerlink" title="运行2个docker容器"></a>运行2个docker容器</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -it -p 8003:8080 --rm --name iarc-service-1 iarc/iarc-service</span><br><span class="line">$ docker run -it -p 8004:8080 --rm --name iarc-service-2 iarc/iarc-service</span><br></pre></td></tr></table></figure><h2 id="配置负载均衡"><a href="#配置负载均衡" class="headerlink" title="配置负载均衡"></a>配置负载均衡</h2><p>配置文件路径是 <code>/etc/nginx/nginx.conf</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    upstream iarc_service &#123;</span><br><span class="line">        server 127.0.0.1:8003;</span><br><span class="line">        server 127.0.0.1:8004;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen 8081;</span><br><span class="line">        location / &#123;</span><br><span class="line">            proxy_pass http://iarc_service;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="开放8081端口"><a href="#开放8081端口" class="headerlink" title="开放8081端口"></a>开放8081端口</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ firewall-cmd --zone=public --add-port=8081/tcp --permanent</span><br><span class="line">$ firewall-cmd --reload</span><br></pre></td></tr></table></figure><h1 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h1><h2 id="访问"><a href="#访问" class="headerlink" title="访问"></a>访问</h2><p>本地使用<code>curl localhost:8081/user/getUser/123</code>来验证，外部使用<code>http://192.168.56.102:8081/user/getUser/123</code>来访问</p><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>由于SELinux的限制，启动nginx时报错<code>[emerg] bind() to 0.0.0.0:8081 failed (13: Permission denied)</code><br>解决方案：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1、临时关闭selinux</span><br><span class="line">setenforce 0</span><br><span class="line">2、永久关闭selinux,需要重启</span><br><span class="line">修改/etc/selinux/config 文件</span><br><span class="line">将SELINUX=enforcing改为SELINUX=disabled</span><br></pre></td></tr></table></figure></p><h1 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h1><p>无</p><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul><li><a href="https://waylau.com/docker-spring-boot/" target="_blank" rel="noopener">用 Docker 构建、运行、发布一个 Spring Boot 应用</a></li><li><a href="https://spring.io/guides/gs/spring-boot-docker/" target="_blank" rel="noopener">Spring Boot with Docker</a></li></ul>]]></content>
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Architect </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>架构之旅-集群与管理-应用</title>
      <link href="/2018/08/14/iarc-210/"/>
      <url>/2018/08/14/iarc-210/</url>
      <content type="html"><![CDATA[<h1 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h1><p>本文中，将使用nginx+docker来搭建iarc-app的集群。<a id="more"></a></p><h1 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h1><p><a href="https://github.com/icmyfuture/iarc/tree/master/iarc-app" target="_blank" rel="noopener">iarc-app</a></p><h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><p>IDE: <a href="/2017/06/19/st-note">SublimeText3</a><br>Env: Nodejs, NPM<br>WebServer: Nginx<br>Container: Docker</p><h1 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h1><p>以下步骤在CentOS7中完成</p><h2 id="创建Dockerfile"><a href="#创建Dockerfile" class="headerlink" title="创建Dockerfile"></a>创建Dockerfile</h2><p>在iarc-app根目录下新建文件’Dockerfile’，内容如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">FROM node:9.11.1-alpine</span><br><span class="line"></span><br><span class="line"># install simple http server for serving static content</span><br><span class="line">RUN npm install -g http-server</span><br><span class="line"></span><br><span class="line"># make the &apos;app&apos; folder the current working directory</span><br><span class="line">WORKDIR /app</span><br><span class="line"></span><br><span class="line"># copy both &apos;package.json&apos; and &apos;package-lock.json&apos; (if available)</span><br><span class="line">COPY package*.json ./</span><br><span class="line"></span><br><span class="line"># install project dependencies</span><br><span class="line"># RUN npm install</span><br><span class="line"></span><br><span class="line"># copy project files and folders to the current working directory (i.e. &apos;app&apos; folder)</span><br><span class="line">COPY . .</span><br><span class="line"></span><br><span class="line"># build app for production with minification</span><br><span class="line">RUN npm run build</span><br><span class="line"></span><br><span class="line">EXPOSE 8080</span><br><span class="line">CMD [ &quot;http-server&quot;, &quot;dist&quot; ]</span><br></pre></td></tr></table></figure></p><h2 id="构建docker镜像"><a href="#构建docker镜像" class="headerlink" title="构建docker镜像"></a>构建docker镜像</h2><p><code>docker build -t iarc/iarc-app .</code></p><h2 id="运行2个docker容器"><a href="#运行2个docker容器" class="headerlink" title="运行2个docker容器"></a>运行2个docker容器</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -it -p 8001:8080 --rm --name iarc-app-1 iarc/iarc-app</span><br><span class="line">$ docker run -it -p 8002:8080 --rm --name iarc-app-2 iarc/iarc-app</span><br></pre></td></tr></table></figure><h2 id="安装nginx"><a href="#安装nginx" class="headerlink" title="安装nginx"></a>安装nginx</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ npm install nginx -y # 安装</span><br><span class="line">$ systemctl enable nginx # 开机自启</span><br><span class="line">$ systemctl restart nginx # 配置后重启nginx</span><br></pre></td></tr></table></figure><h2 id="配置负载均衡"><a href="#配置负载均衡" class="headerlink" title="配置负载均衡"></a>配置负载均衡</h2><p>配置文件路径是 <code>/etc/nginx/nginx.conf</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    upstream iarc_app &#123;</span><br><span class="line">        server 127.0.0.1:8001;</span><br><span class="line">        server 127.0.0.1:8002;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen 8080;</span><br><span class="line">        location / &#123;</span><br><span class="line">            proxy_pass http://iarc_app;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="开放8080端口"><a href="#开放8080端口" class="headerlink" title="开放8080端口"></a>开放8080端口</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ firewall-cmd --zone=public --add-port=8080/tcp --permanent</span><br><span class="line">$ firewall-cmd --reload</span><br></pre></td></tr></table></figure><h1 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h1><h2 id="访问"><a href="#访问" class="headerlink" title="访问"></a>访问</h2><p>本地使用<code>curl localhost:8080</code>来验证，外部使用<code>http://192.168.56.102:8080</code>来访问</p><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>由于<a href="https://selinuxproject.org/page/Main_Page" target="_blank" rel="noopener">SELinux</a>的影响，导致访问时报错<code>502 Bad Gateway</code>，检查日志<code>/var/log/nginx/error.log</code>后发现提示如下内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(13: Permission denied) while connecting to upstream:[nginx]</span><br></pre></td></tr></table></figure></p><p>解决方案是：<code>setsebool -P httpd_can_network_connect 1</code></p><h1 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h1><p>无</p><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul><li><a href="https://cn.vuejs.org/v2/cookbook/dockerize-vuejs-app.html" target="_blank" rel="noopener">Dockerized Vuejs</a></li><li><a href="https://juejin.im/post/5a142d7b6fb9a0451170c2c7" target="_blank" rel="noopener">使用Docker搭建前端CI</a></li></ul>]]></content>
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Architect </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>架构之旅-扩展-数据-搜索-Solr</title>
      <link href="/2018/04/25/iarc-441/"/>
      <url>/2018/04/25/iarc-441/</url>
      <content type="html"><![CDATA[<h1 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h1><p>本文中，将配置<code>solr</code>来提供搜索服务，并修改<code>iarc-data</code>来使用solr。<a id="more"></a></p><h1 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h1><p><a href="https://github.com/icmyfuture/iarc/tree/master/iarc-data" target="_blank" rel="noopener">iarc-data</a></p><h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><p>IDE: IntelliJ IDEA<br>JDK: 1.8.0_u162<br>MiddleWare: Solr 7.3.0<br>App Coordinator: Zookeeper 3.4.10<br>DB: MySQL</p><h1 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h1><h2 id="安装solr"><a href="#安装solr" class="headerlink" title="安装solr"></a>安装solr</h2><p>从<a href="http://www.apache.org/dyn/closer.lua/lucene/solr/7.3.0" target="_blank" rel="noopener">官网</a>下载并复制到centos下<code>/opt</code>目录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ cd /opt</span><br><span class="line">$ tar -zxvf solr-7.3.0.tgz</span><br><span class="line">$ ln -s /opt/solr-7.3.0 /opt/solr</span><br></pre></td></tr></table></figure></p><h2 id="集群配置"><a href="#集群配置" class="headerlink" title="集群配置"></a>集群配置</h2><p><code>$ vim /opt/solr/bin/solr.in.sh</code>, 找到如下配置节并修改<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SOLR_HOST=&quot;192.168.56.103&quot;</span><br><span class="line">SOLR_TIMEZONE=&quot;UTC+8&quot;</span><br></pre></td></tr></table></figure></p><h2 id="启动-停止-别名"><a href="#启动-停止-别名" class="headerlink" title="启动/停止 别名"></a>启动/停止 别名</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alias solrstart=&apos;/opt/solr/bin/solr start -cloud -p 8983 -s &quot;/opt/solr/server/solr&quot; -z localhost:2181 -force&apos;</span><br><span class="line">alias solrstop=&apos;/opt/solr/bin/solr stop&apos;</span><br></pre></td></tr></table></figure><h2 id="配置目录"><a href="#配置目录" class="headerlink" title="配置目录"></a>配置目录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir /opt/solr/conf</span><br><span class="line">$ cp /opt/solr/server/solr/configsets/_default/conf /opt/solr/conf/user -r</span><br></pre></td></tr></table></figure><h3 id="上传-更新配置"><a href="#上传-更新配置" class="headerlink" title="上传/更新配置"></a>上传/更新配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ /opt/solr/bin/solr zk -upconfig -z localhost:2181 -d /opt/solr/conf/user -n user</span><br></pre></td></tr></table></figure><h3 id="删除configset（非必须）"><a href="#删除configset（非必须）" class="headerlink" title="删除configset（非必须）"></a>删除configset（非必须）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.103:8983/solr/admin/configs?action=DELETE&amp;name=user</span><br></pre></td></tr></table></figure><h3 id="基于配置，创建Collection"><a href="#基于配置，创建Collection" class="headerlink" title="基于配置，创建Collection"></a>基于配置，创建Collection</h3><p>地址：<a href="http://192.168.56.103:8983/solr/#/~collections" target="_blank" rel="noopener">http://192.168.56.103:8983/solr/#/~collections</a><br>操作：add collection<br>选择：config set - user, 其余为默认</p><h2 id="中文分词"><a href="#中文分词" class="headerlink" title="中文分词"></a>中文分词</h2><h3 id="复制需要的jar包至webapp"><a href="#复制需要的jar包至webapp" class="headerlink" title="复制需要的jar包至webapp"></a>复制需要的jar包至webapp</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /opt/solr-7.3.0/contrib/analysis-extras/lucene-libs/lucene-analyzers-smartcn-7.3.0.jar /opt/solr/server/solr-webapp/webapp/WEB-INF/lib/</span><br></pre></td></tr></table></figure><h3 id="修改并更新配置"><a href="#修改并更新配置" class="headerlink" title="修改并更新配置"></a>修改并更新配置</h3><p><code>vim /opt/solr/conf/user/managed-schema</code>, 添加内容如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;fieldType name=&quot;text_cn&quot; class=&quot;solr.TextField&quot; positionIncrementGap=&quot;100&quot;&gt;</span><br><span class="line">  &lt;analyzer type=&quot;index&quot;&gt;</span><br><span class="line">    &lt;tokenizer class=&quot;org.apache.lucene.analysis.cn.smart.HMMChineseTokenizerFactory&quot;/&gt;</span><br><span class="line">  &lt;/analyzer&gt;</span><br><span class="line">  &lt;analyzer type=&quot;query&quot;&gt;</span><br><span class="line">    &lt;tokenizer class=&quot;org.apache.lucene.analysis.cn.smart.HMMChineseTokenizerFactory&quot;/&gt;</span><br><span class="line">  &lt;/analyzer&gt;</span><br><span class="line">&lt;/fieldType&gt;</span><br></pre></td></tr></table></figure></p><h2 id="数据导入"><a href="#数据导入" class="headerlink" title="数据导入"></a>数据导入</h2><h3 id="复制需要的jar包至webapp-1"><a href="#复制需要的jar包至webapp-1" class="headerlink" title="复制需要的jar包至webapp"></a>复制需要的jar包至webapp</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cp /opt/solr/dist/solr-dataimporthandler-* /opt/solr/server/solr-webapp/webapp/WEB-INF/lib/</span><br><span class="line">$ cp /opt/mycat/lib/mysql-connector-java-5.1.35.jar /opt/solr/server/solr-webapp/webapp/WEB-INF/lib/</span><br></pre></td></tr></table></figure><h3 id="修改并更新配置-1"><a href="#修改并更新配置-1" class="headerlink" title="修改并更新配置"></a>修改并更新配置</h3><ul><li><p><code>$ vim /opt/solr/conf/user/solrconfig.xml</code>, 添加内容如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;requestHandler name=&quot;/dataimport&quot; class=&quot;org.apache.solr.handler.dataimport.DataImportHandler&quot;&gt;</span><br><span class="line">  &lt;lst name=&quot;defaults&quot;&gt;</span><br><span class="line">    &lt;str name=&quot;config&quot;&gt;db-data-config.xml&lt;/str&gt;</span><br><span class="line">  &lt;/lst&gt;</span><br><span class="line">&lt;/requestHandler&gt;</span><br></pre></td></tr></table></figure></li><li><p><code>$ vim /opt/solr/conf/user/db-data-config.xml</code>, 内容如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;dataConfig&gt;</span><br><span class="line">    &lt;dataSource name=&quot;ijava&quot; type=&quot;JdbcDataSource&quot; driver=&quot;com.mysql.jdbc.Driver&quot; url=&quot;jdbc:mysql://192.168.56.103:3306/ijava&quot; user=&quot;root&quot; password=&quot;**&quot; /&gt;</span><br><span class="line">    &lt;document&gt;</span><br><span class="line">        &lt;entity name=&quot;user&quot; dataSource=&quot;ijava&quot; query=&quot;select id, name from ijava.user;&quot;&gt;</span><br><span class="line">        &lt;/entity&gt;</span><br><span class="line">    &lt;/document&gt;</span><br><span class="line">&lt;/dataConfig&gt;</span><br></pre></td></tr></table></figure></li><li><p><code>$ vim /opt/solr/conf/user/managed-schema</code>, 内容如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;schema name=&quot;user&quot; version=&quot;1.6&quot;&gt;</span><br><span class="line">    &lt;uniqueKey&gt;id&lt;/uniqueKey&gt;</span><br><span class="line">    &lt;field name=&quot;id&quot; type=&quot;string&quot; indexed=&quot;true&quot; stored=&quot;true&quot; required=&quot;true&quot; multiValued=&quot;false&quot; /&gt;</span><br><span class="line">    &lt;field name=&quot;name&quot; type=&quot;text_cn&quot; indexed=&quot;true&quot; stored=&quot;true&quot; required=&quot;true&quot; multiValued=&quot;false&quot; /&gt;</span><br></pre></td></tr></table></figure></li></ul><h3 id="手动导入"><a href="#手动导入" class="headerlink" title="手动导入"></a>手动导入</h3><p>地址：<a href="http://172.16.0.239:8101/solr/index.html#/user/dataimport//dataimport" target="_blank" rel="noopener">http://172.16.0.239:8101/solr/index.html#/user/dataimport//dataimport</a><br>选择：full-import - commit , clik <code>Execute</code><br>注意：如果点击’Dataimport’仍然提示<br>“The solrconfig.xml file for this index does not have an operational DataImportHandler defined!”, 可以直接使用 api来导入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.103:8983/solr/user/dataimport?command=full-import&amp;verbose=false&amp;clean=false&amp;commit=true&amp;optimize=false&amp;core=user&amp;indent=on&amp;wt=json</span><br></pre></td></tr></table></figure></p><h3 id="定时导入"><a href="#定时导入" class="headerlink" title="定时导入"></a>定时导入</h3><p><code>crontab -e</code>, 添加内容如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*/5  * * * * curl &quot;http://192.168.56.103:8983/solr/user/dataimport?command=full-import&amp;verbose=false&amp;clean=false&amp;commit=true&amp;optimize=false&amp;core=user&amp;indent=on&amp;wt=json&quot; &gt; /dev/null 2&gt;&amp;1</span><br></pre></td></tr></table></figure></p><h2 id="spring-boot使用solr"><a href="#spring-boot使用solr" class="headerlink" title="spring boot使用solr"></a>spring boot使用solr</h2><h3 id="application-properties"><a href="#application-properties" class="headerlink" title="application.properties"></a>application.properties</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">spring.data.solr.host=http://192.168.56.103:8983/solr</span><br><span class="line">spring.data.solr.repositories.enabled=true</span><br></pre></td></tr></table></figure><h3 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-data-solr&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.5.0.RELEASE&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><h3 id="solrdocument"><a href="#solrdocument" class="headerlink" title="solrdocument"></a>solrdocument</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@SolrDocument(solrCoreName = &quot;user&quot;)</span><br><span class="line">@Getter</span><br><span class="line">@Setter</span><br><span class="line">public class SolrUser implements Serializable &#123;</span><br><span class="line">    @Id</span><br><span class="line">    private String id;</span><br><span class="line">    private String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="repository"><a href="#repository" class="headerlink" title="repository"></a>repository</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public interface SolrUserRepository extends SolrCrudRepository&lt;SolrUser, String&gt; &#123;</span><br><span class="line">    List&lt;SolrUser&gt; findByNameContaining(String name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="UserServiceImpl"><a href="#UserServiceImpl" class="headerlink" title="UserServiceImpl"></a>UserServiceImpl</h3><p>接口中添加方法<code>getUsersByName</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public List&lt;User&gt; getUsersByName(String name) &#123;</span><br><span class="line">    List&lt;SolrUser&gt; users = userRepository.findByNameContaining(name);</span><br><span class="line">    List&lt;User&gt; results = new ArrayList&lt;&gt;();</span><br><span class="line">    if(users != null) &#123;</span><br><span class="line">        users.forEach( user -&gt; &#123;</span><br><span class="line">            User usr = new User();</span><br><span class="line">            usr.setId(Integer.parseInt(user.getId()));</span><br><span class="line">            usr.setName(user.getName());</span><br><span class="line">            results.add(usr);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    return results;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h1><h2 id="测试solr-colletion的search功能"><a href="#测试solr-colletion的search功能" class="headerlink" title="测试solr colletion的search功能"></a>测试solr colletion的search功能</h2><p>地址：<a href="http://192.168.56.103:8983/solr/#/user/query" target="_blank" rel="noopener">http://192.168.56.103:8983/solr/#/user/query</a><br>位置：Query, q输入框中输入<code>name:*v*</code>, 点击<code>Execute Query</code></p><h2 id="测试使用solr后的service功能"><a href="#测试使用solr后的service功能" class="headerlink" title="测试使用solr后的service功能"></a>测试使用solr后的service功能</h2><ul><li>使用mvn清理并构建:<code>mvn clean install -Dmaven.test.skip=true</code></li><li>IDE中启动data与service</li><li>访问地址: <a href="http://localhost:8001/user/getUsersByName/v" target="_blank" rel="noopener">http://localhost:8001/user/getUsersByName/v</a></li></ul><h1 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h1><h2 id="部署到linux下tomcat中"><a href="#部署到linux下tomcat中" class="headerlink" title="部署到linux下tomcat中"></a>部署到linux下tomcat中</h2><p>参考<a href="/2018/02/05/iarc-130">数据访问层</a>中<code>部署</code>部分</p><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul><li><a href="https://www.cnblogs.com/liushuan/p/8892717.html" target="_blank" rel="noopener">centos+solr7.3</a></li><li>solrcloud simple<br><a href="https://segmentfault.com/a/1190000008634902" target="_blank" rel="noopener">1</a><br><a href="https://segmentfault.com/a/1190000010836061" target="_blank" rel="noopener">2</a></li><li>Solr Reference Guide<br><a href="https://lucene.apache.org/solr/resources.html" target="_blank" rel="noopener">resource</a><br><a href="https://lucene.apache.org/solr/guide/7_3/solr-control-script-reference.html#solr-control-script-reference" target="_blank" rel="noopener">7.3 script</a><br><a href="https://lucene.apache.org/solr/guide/7_3/using-zookeeper-to-manage-configuration-files.html#comment-65147407" target="_blank" rel="noopener">solr 7.3 using zookeeper</a></li><li>sprintboot using solr<br><a href="https://zhuanlan.zhihu.com/p/28870571" target="_blank" rel="noopener">simple</a><br><a href="https://projects.spring.io/spring-data-solr/#quick-start" target="_blank" rel="noopener">官方</a></li></ul>]]></content>
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Architect </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>架构之旅-扩展-服务-日志</title>
      <link href="/2018/04/10/iarc-421/"/>
      <url>/2018/04/10/iarc-421/</url>
      <content type="html"><![CDATA[<h1 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h1><p>本文中，将使用logback为service/data提供日志功能，<a id="more"></a>并提供CONSOLE,FILE,KAFKA三种日志输出方式。</p><h1 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h1><p><a href="https://github.com/icmyfuture/iarc/tree/master/iarc-service" target="_blank" rel="noopener">iarc-service</a></p><h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><p>IDE: IntelliJ IDEA<br>JDK: 1.8.0_u162<br>Framework: spring boot, logback<br>Middleware: Kafka, Zookeeper</p><h1 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h1><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><h3 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h3><ul><li><p>parent</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">    &lt;janino.version&gt;2.5.16&lt;/janino.version&gt;</span><br><span class="line">    &lt;kafka-logback.version&gt;1.0.2&lt;/kafka-logback.version&gt;</span><br><span class="line">&lt;/properties&gt;</span><br><span class="line">...</span><br><span class="line">    &lt;!--kafka logback--&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;ru.sberned&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;kafka-logback&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;$&#123;kafka-logback.version&#125;&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- Logback EvaluatorFilter 需要使用 --&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.codehaus.janino&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;janino&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;$&#123;janino.version&#125;&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure></li><li><p>iarc-service</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--janino--&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.codehaus.janino&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;janino&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--kafka logback--&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;ru.sberned&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;kafka-logback&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></li></ul><h3 id="application-properties"><a href="#application-properties" class="headerlink" title="application.properties"></a>application.properties</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># kafka</span><br><span class="line">kafka.bootstrapServers=192.168.56.103:9092</span><br><span class="line"></span><br><span class="line"># log file</span><br><span class="line">logging.file=/var/log/iarc/iarc_service_data</span><br></pre></td></tr></table></figure><h3 id="logback-spring-xml"><a href="#logback-spring-xml" class="headerlink" title="logback-spring.xml"></a>logback-spring.xml</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;!--使用application配置--&gt;</span><br><span class="line">    &lt;springProperty scope=&quot;context&quot; name=&quot;kafkaBootstrapServers&quot; source=&quot;kafka.bootstrapServers&quot;/&gt;</span><br><span class="line">    &lt;!--其他配置參考 https://github.com/spring-projects/spring-boot/tree/master/spring-boot/src/main/resources/org/springframework/boot/logging/logback --&gt;</span><br><span class="line">    &lt;!--引入默认的一些设置--&gt;</span><br><span class="line">    &lt;include resource=&quot;org/springframework/boot/logging/logback/defaults.xml&quot;/&gt;</span><br><span class="line">    &lt;!--web信息--&gt;</span><br><span class="line">    &lt;logger name=&quot;org.springframework&quot; level=&quot;WARN&quot;/&gt;</span><br><span class="line">    &lt;logger name=&quot;com.alibaba.dubbo&quot; level=&quot;WARN&quot; /&gt;</span><br><span class="line">    &lt;logger name=&quot;org.apache.zookeeper&quot; level=&quot;WARN&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--写入日志到控制台的appender,用默认的,但是要去掉charset,否则windows下tomcat下乱码--&gt;</span><br><span class="line">    &lt;appender name=&quot;CONSOLE&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;</span><br><span class="line">        &lt;encoder&gt;</span><br><span class="line">            &lt;pattern&gt;$&#123;CONSOLE_LOG_PATTERN&#125;&lt;/pattern&gt;</span><br><span class="line">        &lt;/encoder&gt;</span><br><span class="line">    &lt;/appender&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--写入日志到文件的appender--&gt;</span><br><span class="line">    &lt;appender name=&quot;FILE&quot; class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;</span><br><span class="line">        &lt;filter class=&quot;ch.qos.logback.core.filter.EvaluatorFilter&quot;&gt;</span><br><span class="line">            &lt;evaluator&gt; &lt;!-- defaults to type ch.qos.logback.classic.boolex.JaninoEventEvaluator --&gt;</span><br><span class="line">                &lt;expression&gt;return message.contains(&quot;javax.BusinessException&quot;);&lt;/expression&gt;</span><br><span class="line">            &lt;/evaluator&gt;</span><br><span class="line">            &lt;OnMismatch&gt;DENY&lt;/OnMismatch&gt;</span><br><span class="line">            &lt;OnMatch&gt;NEUTRAL&lt;/OnMatch&gt;</span><br><span class="line">        &lt;/filter&gt;</span><br><span class="line">        &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt;</span><br><span class="line">            &lt;!--日志文件输出的文件名,每天一个文件--&gt;</span><br><span class="line">            &lt;FileNamePattern&gt;$&#123;LOG_FILE&#125;.%d&#123;yyyy-MM-dd&#125;.log&lt;/FileNamePattern&gt;</span><br><span class="line">            &lt;!--日志文件保留天数--&gt;</span><br><span class="line">            &lt;maxHistory&gt;30&lt;/maxHistory&gt;</span><br><span class="line">        &lt;/rollingPolicy&gt;</span><br><span class="line">        &lt;encoder class=&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;&gt;</span><br><span class="line">            &lt;pattern&gt;%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n&lt;/pattern&gt;</span><br><span class="line">        &lt;/encoder&gt;</span><br><span class="line">        &lt;!--日志文件最大的大小--&gt;</span><br><span class="line">        &lt;triggeringPolicy class=&quot;ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy&quot;&gt;</span><br><span class="line">            &lt;MaxFileSize&gt;10MB&lt;/MaxFileSize&gt;</span><br><span class="line">        &lt;/triggeringPolicy&gt;</span><br><span class="line">    &lt;/appender&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--异步到文件--&gt;</span><br><span class="line">    &lt;appender name=&quot;asyncFileAppender&quot; class=&quot;ch.qos.logback.classic.AsyncAppender&quot;&gt;</span><br><span class="line">        &lt;discardingThreshold&gt;0&lt;/discardingThreshold&gt;</span><br><span class="line">        &lt;queueSize&gt;50&lt;/queueSize&gt;</span><br><span class="line">        &lt;appender-ref ref=&quot;FILE&quot;/&gt;</span><br><span class="line">    &lt;/appender&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--写日志到kafka--&gt;</span><br><span class="line">    &lt;appender name=&quot;KAFKA&quot; class=&quot;ru.sberned.kafkalogback.KafkaAppender&quot;&gt;</span><br><span class="line">        &lt;topic&gt;iarc-log&lt;/topic&gt;</span><br><span class="line">        &lt;bootstrapServers&gt;$&#123;kafkaBootstrapServers&#125;&lt;/bootstrapServers&gt;</span><br><span class="line">        &lt;valueSerializer&gt;org.apache.kafka.common.serialization.StringSerializer&lt;/valueSerializer&gt;</span><br><span class="line">        &lt;failOnStartup&gt;false&lt;/failOnStartup&gt;</span><br><span class="line">        &lt;customProp&gt;acks|all&lt;/customProp&gt;</span><br><span class="line">        &lt;layout class=&quot;ch.qos.logback.classic.PatternLayout&quot;&gt;</span><br><span class="line">            &lt;pattern&gt;%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level mgt %logger&#123;50&#125; - %msg%n&lt;/pattern&gt;</span><br><span class="line">        &lt;/layout&gt;</span><br><span class="line">    &lt;/appender&gt;</span><br><span class="line">    &lt;!--引用KAFKA配置，并且会异步进行写入--&gt;</span><br><span class="line">    &lt;appender name=&quot;KafkaAsync&quot; class=&quot;ch.qos.logback.classic.AsyncAppender&quot;&gt;</span><br><span class="line">        &lt;neverBlock&gt;true&lt;/neverBlock&gt;</span><br><span class="line">        &lt;includeCallerData&gt;true&lt;/includeCallerData&gt;</span><br><span class="line">        &lt;appender-ref ref=&quot;KAFKA&quot; /&gt;</span><br><span class="line">    &lt;/appender&gt;</span><br><span class="line">    &lt;!--排除kafka client的log--&gt;</span><br><span class="line">    &lt;logger name=&quot;org.apache.kafka&quot; level=&quot;INFO&quot; additivity=&quot;false&quot;&gt;</span><br><span class="line">        &lt;appender-ref ref=&quot;CONSOLE&quot; /&gt;</span><br><span class="line">        &lt;appender-ref ref=&quot;FILE&quot; /&gt;</span><br><span class="line">    &lt;/logger&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--生产环境:打印控制台和输出到文件--&gt;</span><br><span class="line">    &lt;springProfile name=&quot;prd&quot;&gt;</span><br><span class="line">        &lt;root level=&quot;INFO&quot;&gt;</span><br><span class="line">            &lt;appender-ref ref=&quot;asyncFileAppender&quot;/&gt;</span><br><span class="line">            &lt;appender-ref ref=&quot;KafkaAsync&quot;/&gt;</span><br><span class="line">        &lt;/root&gt;</span><br><span class="line">    &lt;/springProfile&gt;</span><br><span class="line"></span><br><span class="line">    &lt;springProfile name=&quot;default&quot;&gt;</span><br><span class="line">        &lt;root level=&quot;INFO&quot;&gt;</span><br><span class="line">            &lt;appender-ref ref=&quot;asyncFileAppender&quot;/&gt;</span><br><span class="line">            &lt;appender-ref ref=&quot;KafkaAsync&quot;/&gt;</span><br><span class="line">            &lt;appender-ref ref=&quot;CONSOLE&quot;/&gt;</span><br><span class="line">        &lt;/root&gt;</span><br><span class="line">    &lt;/springProfile&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><ul><li>UserController<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public List&lt;User&gt; getAllUsers() &#123;</span><br><span class="line">    logger.warn(&quot;javax.BusinessException: complex getAllUsers&quot;);</span><br><span class="line">    logger.warn(&quot;simple getAllUsers&quot;);</span><br><span class="line">    return userService.getAllUsers();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="kafka"><a href="#kafka" class="headerlink" title="kafka"></a>kafka</h2><ul><li>新建一个topic用于日志<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ opt/kafka/bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic iarc-log</span><br></pre></td></tr></table></figure></li></ul><h1 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h1><h2 id="启动iarc-service"><a href="#启动iarc-service" class="headerlink" title="启动iarc-service"></a>启动iarc-service</h2><p>访问<code>http://localhost:8001/user/getAllUsers</code>，可以看到控制台显示了2条日志，而文件<code>C:\var\log\iarc\iarc_service_data.***.log</code>仅显示一条，这是由于我们使用filter进行了过滤。</p><h2 id="检查kafka日志"><a href="#检查kafka日志" class="headerlink" title="检查kafka日志"></a>检查kafka日志</h2><p>可以看到有2条日志显示<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd /tmp/kafka-logs/iarc-log-0</span><br><span class="line">$ tail 00000000000000000000.log</span><br></pre></td></tr></table></figure></p><h2 id="kafka-manager"><a href="#kafka-manager" class="headerlink" title="kafka-manager"></a>kafka-manager</h2><p>可按<a href="https://blog.csdn.net/isea533/article/details/73727485" target="_blank" rel="noopener">这里</a>的步骤配置kafka-manager，便于管理kafka。</p><h1 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h1><p>部署的过程与该系列中其他文章相同，不再赘述。</p><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul><li><a href="https://www.cnblogs.com/Leo_wl/p/5447910.html#_label4" target="_blank" rel="noopener">日志收集之kafka</a></li><li><a href="https://blog.csdn.net/isea533/article/category/6986649" target="_blank" rel="noopener">kafka入门</a></li></ul>]]></content>
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Architect </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>架构之旅-扩展-数据-Messaging_RabbitMQ</title>
      <link href="/2018/04/08/iarc-431/"/>
      <url>/2018/04/08/iarc-431/</url>
      <content type="html"><![CDATA[<h1 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h1><p>本文中，将使用rabbitmq来提供消息队列处理功能<a id="more"></a></p><h1 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h1><p><a href="https://github.com/icmyfuture/iarc/tree/master/iarc-data" target="_blank" rel="noopener">iarc-data</a></p><h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><p>IDE: IntelliJ IDEA<br>JDK: 1.8.0_u162<br>Framework: spring boot<br>Middleware: RabbitMQ</p><h1 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h1><h2 id="生产者"><a href="#生产者" class="headerlink" title="生产者"></a>生产者</h2><h3 id="application-properties"><a href="#application-properties" class="headerlink" title="application.properties"></a>application.properties</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">spring.rabbitmq.addresses=192.168.56.103:5672</span><br><span class="line">spring.rabbitmq.username=root</span><br><span class="line">spring.rabbitmq.password=***</span><br><span class="line">spring.rabbitmq.virtual-host=/</span><br><span class="line">spring.rabbitmq.connection-timeout=3000</span><br><span class="line">spring.rabbitmq.listener.retry.enabled=true</span><br><span class="line">spring.rabbitmq.listener.retry.max-attempts=1</span><br><span class="line">spring.rabbitmq.listener.concurrency=1</span><br><span class="line">spring.rabbitmq.listener.prefetch=3</span><br><span class="line">spring.rabbitmq.template.retry.enabled=true</span><br><span class="line">spring.rabbitmq.requested-heartbeat=60</span><br></pre></td></tr></table></figure><h3 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-amqp&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><h3 id="RabbitMQConfig"><a href="#RabbitMQConfig" class="headerlink" title="RabbitMQConfig"></a>RabbitMQConfig</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">public class RabbitMQConfig implements InitializingBean &#123;</span><br><span class="line">    public static final String DATA_RECEIVER_EXCHANGE = &quot;data-receiver-exchange&quot;;</span><br><span class="line">    public static final String DATA_RECEIVER_QUEUE = &quot;data-receiver-queue&quot;;</span><br><span class="line">    public static final String DATA_RECEIVER_KEY = &quot;data-receiver-key&quot;;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private CachingConnectionFactory cachingConnectionFactory;</span><br><span class="line"></span><br><span class="line">    //为了开启setAutomaticRecoveryEnabled功能，连接中断后自动恢复</span><br><span class="line">    @Override</span><br><span class="line">    public void afterPropertiesSet() &#123;</span><br><span class="line">        com.rabbitmq.client.ConnectionFactory conn = cachingConnectionFactory.getRabbitConnectionFactory();</span><br><span class="line">        conn.setAutomaticRecoveryEnabled(true);</span><br><span class="line">        conn.setTopologyRecoveryEnabled(true);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    public Queue dataReceiverQueue() &#123;</span><br><span class="line">        Map&lt;String, Object&gt; args = new HashMap&lt;String, Object&gt;();</span><br><span class="line">        return new Queue(DATA_RECEIVER_QUEUE, true, false, false, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    TopicExchange dataReceiverExchange() &#123;</span><br><span class="line">        return new TopicExchange(DATA_RECEIVER_EXCHANGE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    Binding bindingDataReceive() &#123;</span><br><span class="line">        return BindingBuilder.bind(dataReceiverQueue()).to(dataReceiverExchange()).with(DATA_RECEIVER_KEY);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="iarc-service更新"><a href="#iarc-service更新" class="headerlink" title="iarc-service更新"></a>iarc-service更新</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">@RequestMapping(value = &quot;/data_receiver&quot;)</span><br><span class="line">@Api(tags = &quot;data_receiver&quot;, description = &quot;数据接收接口&quot;)</span><br><span class="line">public class DataReceiverController implements RabbitTemplate.ConfirmCallback, RabbitTemplate.ReturnCallback &#123;</span><br><span class="line">    @Autowired</span><br><span class="line">    private RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    @PostConstruct</span><br><span class="line">    public void init() &#123;</span><br><span class="line">        rabbitTemplate.setConfirmCallback(this);</span><br><span class="line">        rabbitTemplate.setReturnCallback(this);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @ApiOperation(value=&quot;接受消息&quot;, notes=&quot;接受消息&quot;)</span><br><span class="line">    @CrossOrigin(origins = &quot;*&quot;)</span><br><span class="line">    @PostMapping(&quot;receive&quot;)</span><br><span class="line">    public void receive(@RequestBody User user) &#123;</span><br><span class="line">        sendToMQ(user.getName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void confirm(CorrelationData correlationData, boolean ack, String cause) &#123;</span><br><span class="line">        if (ack) &#123;</span><br><span class="line">            System.out.println(&quot;消息发送成功:&quot; + correlationData);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            System.out.println(&quot;消息发送失败:&quot; + cause);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void returnedMessage(Message message, int replyCode, String replyText, String exchange, String routingKey) &#123;</span><br><span class="line">        System.out.println(message.getMessageProperties().getCorrelationIdString() + &quot; 发送失败&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void sendToMQ(String msg)&#123;</span><br><span class="line">        CorrelationData correlationId = new CorrelationData(UUID.randomUUID().toString());</span><br><span class="line">        rabbitTemplate.convertAndSend(RabbitMQConfig.DATA_RECEIVER_EXCHANGE,</span><br><span class="line">                RabbitMQConfig.DATA_RECEIVER_KEY, msg, correlationId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="消费者"><a href="#消费者" class="headerlink" title="消费者"></a>消费者</h2><h3 id="application-properties-1"><a href="#application-properties-1" class="headerlink" title="application.properties"></a>application.properties</h3><p>与生产者相同</p><h3 id="pom-xml-1"><a href="#pom-xml-1" class="headerlink" title="pom.xml"></a>pom.xml</h3><p>与生产者相同</p><h3 id="RabbitMQConfig-1"><a href="#RabbitMQConfig-1" class="headerlink" title="RabbitMQConfig"></a>RabbitMQConfig</h3><p>与生产者相同</p><h3 id="iarc-data更新"><a href="#iarc-data更新" class="headerlink" title="iarc-data更新"></a>iarc-data更新</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Component</span><br><span class="line">public class DataReceiver &#123;</span><br><span class="line">    @RabbitListener(queues = RabbitMQConfig.DATA_RECEIVER_QUEUE)</span><br><span class="line">    public void process(String msg) &#123;</span><br><span class="line">        System.out.println(Thread.currentThread().getName() + &quot;: &quot; + msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="rabbitgmq集群"><a href="#rabbitgmq集群" class="headerlink" title="rabbitgmq集群"></a>rabbitgmq集群</h2><p>设置好集群后，仅需修改<code>application.properties</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.rabbitmq.addresses=192.168.56.103:5672,192.168.56.101:5672</span><br></pre></td></tr></table></figure></p><h1 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h1><h2 id="测试消息的生产与消费"><a href="#测试消息的生产与消费" class="headerlink" title="测试消息的生产与消费"></a>测试消息的生产与消费</h2><p>使用postman发起请求 <code>http://localhost:8001/data_receiver/receive</code><br>RequestBody如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;name&quot;:&quot;iarc&quot;&#125;</span><br></pre></td></tr></table></figure></p><p>可以观察到IDE中iarc-data相关站点console有日志输出</p><h2 id="使用rabbitmq远程管理"><a href="#使用rabbitmq远程管理" class="headerlink" title="使用rabbitmq远程管理"></a>使用rabbitmq远程管理</h2><p>登入<code>http://192.168.56.103:15672</code>，可观察到<code>Connections</code>, <code>Exchanges</code>, <code>Queues</code>下均有对应的内容</p><h1 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h1><h2 id="maven-编译打包"><a href="#maven-编译打包" class="headerlink" title="maven 编译打包"></a>maven 编译打包</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean install -Dmaven.test.skip=true</span><br></pre></td></tr></table></figure><h2 id="部署data-service至centos"><a href="#部署data-service至centos" class="headerlink" title="部署data/service至centos"></a>部署data/service至centos</h2><p>将打包好的iarc-service.war, iarc-data.war复制到 <code>$CATALINA_HOME/webapps</code>目录下，tomcat会自动解压war包。使用postman发起post请求<code>http://192.168.56.103:8080/iarc-service/data_receiver/receive</code>进行验证</p><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul><li><a href="https://www.cnblogs.com/hobinly/p/7703972.html" target="_blank" rel="noopener">centos7安装rabbitmq</a></li><li><a href="https://blog.csdn.net/qq_35246620/article/details/72473098" target="_blank" rel="noopener">rabbitmq集群配置</a></li><li><a href="https://www.jianshu.com/p/e1258c004314" target="_blank" rel="noopener">springboot 使用rabbitmq</a></li><li><a href="https://www.cnblogs.com/xmzJava/p/8036591.html" target="_blank" rel="noopener">springboot rabbitmq整合</a></li><li><a href="https://blog.csdn.net/lilun517735159/article/details/78824828" target="_blank" rel="noopener">mq的选择</a></li></ul>]]></content>
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Architect </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>架构之旅-集群与管理-数据-Mysql_读写分离/主从复制/分库分表</title>
      <link href="/2018/03/02/iarc-232/"/>
      <url>/2018/03/02/iarc-232/</url>
      <content type="html"><![CDATA[<h1 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h1><p>本文中，首先配置mysql主从复制，然后使用mycat进行读写分离，最后使用mycat来做分库分表。<a id="more"></a>在<a href="/2018/02/05/iarc-130">数据库访问层</a>)，仅将mysql连接信息修改为mycat连接信息。</p><h1 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h1><p><a href="https://github.com/icmyfuture/iarc/tree/master/iarc-data" target="_blank" rel="noopener">iarc-data</a></p><h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><p>IDE: IntelliJ IDEA<br>JDK: 1.8.0_u162<br>Framework: spring boot, dubbo<br>Middleware: mycat<br>DB: MySql<br>WebServer: Tomcat (本地端口8088)</p><h1 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h1><h2 id="mysql主从复制"><a href="#mysql主从复制" class="headerlink" title="mysql主从复制"></a>mysql主从复制</h2><p>采用1主1从的结构</p><h3 id="mysql节点信息"><a href="#mysql节点信息" class="headerlink" title="mysql节点信息"></a>mysql节点信息</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">192.168.56.103 master</span><br><span class="line">192.168.56.101 slave</span><br></pre></td></tr></table></figure><h3 id="master配置"><a href="#master配置" class="headerlink" title="master配置"></a>master配置</h3><ol><li><p><code>/etc/my.cnf</code>，添加如下内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">server_id=1         # server_id必须保证主从不一样</span><br><span class="line">log-bin=mysql-bin   # mysql二进制日志</span><br><span class="line">binlog-do-db=ijava  # 指定只对ijava数据库进行二进制日志</span><br></pre></td></tr></table></figure></li><li><p>重启mysql(<code>systemctl restart mysql</code>)</p></li><li><p>登入mysql查看master信息(<code>$ mysql&gt; show master status;</code>)<br>看到如下内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+------------------+----------+--------------+------------------+-------------------+</span><br><span class="line">| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |</span><br><span class="line">+------------------+----------+--------------+------------------+-------------------+</span><br><span class="line">| mysql-bin.000002 |      120 | ijava        |                  |                   |</span><br><span class="line">+------------------+----------+--------------+------------------+-------------------+</span><br></pre></td></tr></table></figure></li><li><p>创建同步用的mysql用户(也可忽略该步骤，直接使用mysql用户root进行登录)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ mysql&gt; CREATE USER &apos;repl&apos;@&apos;%&apos; IDENTIFIED BY &apos;repl422&apos;;</span><br><span class="line">$ mysql&gt; GRANT REPLICATION SLAVE ON *.* TO &apos;repl&apos;@&apos;%&apos;;</span><br></pre></td></tr></table></figure></li></ol><h3 id="slave配置"><a href="#slave配置" class="headerlink" title="slave配置"></a>slave配置</h3><ol><li><p><code>/etc/my.cnf</code>，添加如下内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">server_id=2            # server_id必须保证主从不一样</span><br><span class="line">replicate-do-db=ijava  # 指定只对ijava数据库进行主从复制</span><br></pre></td></tr></table></figure></li><li><p>slave中使用不同的uuid（虚拟机复制时uuid是一样的，主从复制会报错1593）<br>mysql中生成新的唯一uuid</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mysql&gt; select uuid();</span><br></pre></td></tr></table></figure></li></ol><p>然后<code>vim /var/lib/mysql/auto.cnf</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[auto]</span><br><span class="line">server-uuid=***</span><br></pre></td></tr></table></figure></p><ol start="3"><li>重启mysql(<code>systemctl restart mysql</code>)</li><li>指定master，启动并查看slave<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ mysql&gt; CHANGE MASTER TO MASTER_HOST=&apos;192.168.56.103&apos;,MASTER_USER=&apos;repl&apos;,MASTER_PASSWORD=&apos;repl422&apos;,MASTER_LOG_FILE=&apos;mysql-bin.000002&apos;,MASTER_LOG_POS=120;</span><br><span class="line">$ mysql&gt; start slave;</span><br><span class="line">$ mysql&gt; show slave status \G;</span><br></pre></td></tr></table></figure></li></ol><p>关键信息如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">       Slave_IO_State: Waiting for master to send event</span><br><span class="line">          Master_Host: 192.168.56.103</span><br><span class="line">          Master_User: repl</span><br><span class="line">          Master_Port: 3306</span><br><span class="line">        Connect_Retry: 60</span><br><span class="line">      Master_Log_File: mysql-bin.000002</span><br><span class="line">  Read_Master_Log_Pos: 411</span><br><span class="line">       Relay_Log_File: mysqld-relay-bin.000002</span><br><span class="line">        Relay_Log_Pos: 574</span><br><span class="line">Relay_Master_Log_File: mysql-bin.000002</span><br><span class="line">     Slave_IO_Running: Yes</span><br><span class="line">    Slave_SQL_Running: Yes</span><br><span class="line">      Replicate_Do_DB: ijava</span><br></pre></td></tr></table></figure></p><h2 id="mycat读写分离"><a href="#mycat读写分离" class="headerlink" title="mycat读写分离"></a>mycat读写分离</h2><h3 id="mycat安装配置"><a href="#mycat安装配置" class="headerlink" title="mycat安装配置"></a>mycat安装配置</h3><ol><li>前往<a href="http://dl.mycat.io/1.6.5/" target="_blank" rel="noopener">mycat官网</a>下载1.6.5-release版本的tar.gz</li><li><p>解压至<code>/opt/mycat</code>并修改环境变量</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export MYCAT_HOME=/opt/mycat</span><br><span class="line">export PATH=$MYCAT_HOME/bin:$PATH</span><br></pre></td></tr></table></figure></li><li><p>配置(<code>/opt/mycat/conf</code>目录中)<br>server.xml</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE mycat:server SYSTEM &quot;server.dtd&quot;&gt;</span><br><span class="line">&lt;mycat:server xmlns:mycat=&quot;http://io.mycat/&quot;&gt;</span><br><span class="line">    &lt;user name=&quot;root&quot; defaultAccount=&quot;true&quot;&gt;</span><br><span class="line">        &lt;property name=&quot;password&quot;&gt;***&lt;/property&gt;</span><br><span class="line">        &lt;property name=&quot;schemas&quot;&gt;ijava&lt;/property&gt;</span><br><span class="line">    &lt;/user&gt;</span><br><span class="line">&lt;/mycat:server&gt;</span><br></pre></td></tr></table></figure></li></ol><p>schema.xml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE mycat:schema SYSTEM &quot;schema.dtd&quot;&gt;</span><br><span class="line">&lt;mycat:schema xmlns:mycat=&quot;http://io.mycat/&quot;&gt;</span><br><span class="line">    &lt;schema name=&quot;ijava&quot; checkSQLschema=&quot;false&quot; sqlMaxLimit=&quot;100&quot;&gt;</span><br><span class="line">        &lt;table name=&quot;user&quot; dataNode=&quot;dn1&quot; /&gt;</span><br><span class="line">        &lt;table name=&quot;order&quot; dataNode=&quot;dn1&quot; /&gt;</span><br><span class="line">    &lt;/schema&gt;</span><br><span class="line">    &lt;dataNode name=&quot;dn1&quot; dataHost=&quot;localhost1&quot; database=&quot;ijava&quot; /&gt;</span><br><span class="line">    &lt;dataHost name=&quot;localhost1&quot; maxCon=&quot;1000&quot; minCon=&quot;10&quot; balance=&quot;0&quot;</span><br><span class="line">              writeType=&quot;0&quot; dbType=&quot;mysql&quot; dbDriver=&quot;native&quot; switchType=&quot;1&quot; slaveThreshold=&quot;100&quot;&gt;</span><br><span class="line">        &lt;heartbeat&gt;select user()&lt;/heartbeat&gt;</span><br><span class="line">        &lt;writeHost host=&quot;hostM1&quot; url=&quot;192.168.56.103:3306&quot; user=&quot;root&quot; password=&quot;***&quot;&gt;</span><br><span class="line">            &lt;readHost host=&quot;hostS2&quot; url=&quot;192.168.56.101:3306&quot; user=&quot;root&quot; password=&quot;***&quot; /&gt;</span><br><span class="line">        &lt;/writeHost&gt;</span><br><span class="line">    &lt;/dataHost&gt;</span><br><span class="line">&lt;/mycat:schema&gt;</span><br></pre></td></tr></table></figure></p><ol start="4"><li>启动/停止mycat(<code>mycat start/stop</code>)</li><li>使用firewall-cmd开放mycat端口(8066,9066)</li></ol><h3 id="配置mysql使其忽略表大小写"><a href="#配置mysql使其忽略表大小写" class="headerlink" title="配置mysql使其忽略表大小写"></a>配置mysql使其忽略表大小写</h3><p><code>/etc/my.cnf</code>中，添加如下配置节并重启mysql<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lower_case_table_names=1</span><br></pre></td></tr></table></figure></p><h3 id="修改数据访问层"><a href="#修改数据访问层" class="headerlink" title="修改数据访问层"></a>修改<a href="/2018/02/05/iarc-130">数据访问层</a></h3><p>仅需修改连接字符串<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.datasource.druid.ijava.url=jdbc:mysql://192.168.56.103:8066/ijava***</span><br></pre></td></tr></table></figure></p><h2 id="mycat分库分表"><a href="#mycat分库分表" class="headerlink" title="mycat分库分表"></a>mycat分库分表</h2><h3 id="mysql库与表"><a href="#mysql库与表" class="headerlink" title="mysql库与表"></a>mysql库与表</h3><p>新建2个库，并在其中新建表<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">CREATE SCHEMA isharding1;</span><br><span class="line">CREATE TABLE isharding1.user</span><br><span class="line">(</span><br><span class="line">  id   INT         NOT NULL PRIMARY KEY,</span><br><span class="line">  name VARCHAR(50) NOT NULL</span><br><span class="line">) ENGINE = InnoDB;</span><br><span class="line">CREATE TABLE isharding1.inbound</span><br><span class="line">(</span><br><span class="line">  id   INT         NOT NULL AUTO_INCREMENT PRIMARY KEY,</span><br><span class="line">  name VARCHAR(50) NOT NULL</span><br><span class="line">) ENGINE = InnoDB;</span><br><span class="line">CREATE SCHEMA isharding2;</span><br><span class="line">CREATE TABLE isharding2.user</span><br><span class="line">(</span><br><span class="line">  id   INT         NOT NULL PRIMARY KEY,</span><br><span class="line">  name VARCHAR(50) NOT NULL</span><br><span class="line">) ENGINE = InnoDB;</span><br><span class="line">CREATE TABLE isharding2.outbound</span><br><span class="line">(</span><br><span class="line">  id   INT         NOT NULL AUTO_INCREMENT PRIMARY KEY,</span><br><span class="line">  name VARCHAR(50) NOT NULL</span><br><span class="line">) ENGINE = InnoDB;</span><br></pre></td></tr></table></figure></p><h3 id="server-xml"><a href="#server-xml" class="headerlink" title="server.xml"></a>server.xml</h3><p>添加isharding schema<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;mycat:server&gt;</span><br><span class="line">    ...</span><br><span class="line">    &lt;user name=&quot;root&quot; defaultAccount=&quot;true&quot;&gt;</span><br><span class="line">        &lt;property name=&quot;password&quot;&gt;***&lt;/property&gt;</span><br><span class="line">        &lt;property name=&quot;schemas&quot;&gt;ijava,isharding&lt;/property&gt;</span><br><span class="line">    &lt;/user&gt;</span><br><span class="line">&lt;/mycat:server&gt;</span><br></pre></td></tr></table></figure></p><h3 id="schema-xml"><a href="#schema-xml" class="headerlink" title="schema.xml"></a>schema.xml</h3><p>user表用于展示水平切分，而inbound和outbound则用于垂直切分（不同表放在不同切片）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;mycat:schema xmlns:mycat=&quot;http://io.mycat/&quot;&gt;</span><br><span class="line">    ...</span><br><span class="line">    &lt;schema name=&quot;isharding&quot; checkSQLschema=&quot;false&quot; sqlMaxLimit=&quot;100&quot;&gt;</span><br><span class="line">        &lt;table name=&quot;user&quot; dataNode=&quot;dn01,dn02&quot; rule=&quot;mod-long&quot; primaryKey=&quot;id&quot; autoIncrement=&quot;true&quot;/&gt;</span><br><span class="line">        &lt;table name=&quot;inbound&quot; dataNode=&quot;dn01&quot; /&gt;</span><br><span class="line">        &lt;table name=&quot;outbound&quot; dataNode=&quot;dn02&quot; /&gt;</span><br><span class="line">    &lt;/schema&gt;</span><br><span class="line">    ...</span><br><span class="line">    &lt;dataNode name=&quot;dn01&quot; dataHost=&quot;isharding&quot; database=&quot;isharding1&quot; /&gt;</span><br><span class="line">    &lt;dataNode name=&quot;dn02&quot; dataHost=&quot;isharding&quot; database=&quot;isharding2&quot; /&gt;</span><br><span class="line">    ...</span><br><span class="line">    &lt;dataHost name=&quot;isharding&quot; maxCon=&quot;1000&quot; minCon=&quot;10&quot; balance=&quot;0&quot;</span><br><span class="line">              writeType=&quot;0&quot; dbType=&quot;mysql&quot; dbDriver=&quot;native&quot; switchType=&quot;1&quot;  slaveThreshold=&quot;100&quot;&gt;</span><br><span class="line">        &lt;heartbeat&gt;select user()&lt;/heartbeat&gt;</span><br><span class="line">        &lt;writeHost host=&quot;hostM2&quot; url=&quot;192.168.56.103:3306&quot; user=&quot;root&quot; password=&quot;***&quot;&gt;</span><br><span class="line">        &lt;/writeHost&gt;</span><br><span class="line">    &lt;/dataHost&gt;</span><br><span class="line">&lt;/mycat:schema&gt;</span><br></pre></td></tr></table></figure></p><h3 id="rule-xml"><a href="#rule-xml" class="headerlink" title="rule.xml"></a>rule.xml</h3><p>由于仅有2个切片库，所以规则<code>mod-long</code>的<code>count</code>设置为2<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;function name=&quot;mod-long&quot; class=&quot;io.mycat.route.function.PartitionByMod&quot;&gt;</span><br><span class="line">    &lt;!-- how many data nodes --&gt;</span><br><span class="line">    &lt;property name=&quot;count&quot;&gt;2&lt;/property&gt;</span><br><span class="line">&lt;/function&gt;</span><br></pre></td></tr></table></figure></p><h3 id="重启mycat"><a href="#重启mycat" class="headerlink" title="重启mycat"></a>重启mycat</h3><p><code>mycat restart</code></p><h1 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h1><h2 id="读写分离与主从同步"><a href="#读写分离与主从同步" class="headerlink" title="读写分离与主从同步"></a>读写分离与主从同步</h2><ol><li>IntelliJ IDEA中启动数据与服务站点（DataApplication:8002, ServiceApplication:8001）</li><li><p>使用Postman来发起对<code>http://localhost:8001/user/insertUser</code>的请求<br>requestbody(format: json)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;name&quot;: &quot;nothing is true&quot;&#125;</span><br></pre></td></tr></table></figure></li><li><p>使用DataGrip连接mycat端口8066，验证数据是否正确插入，并连接mysql master/slave来检查数据是否已进行主从同步</p></li></ol><h2 id="分库分表"><a href="#分库分表" class="headerlink" title="分库分表"></a>分库分表</h2><h3 id="sql"><a href="#sql" class="headerlink" title="sql"></a>sql</h3><p>user的数据被拆分到2个不同的库中同名的表中，而inbound/outbound的数据则进入了不同库的不同表<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">USE isharding;</span><br><span class="line">INSERT INTO user (id, name) VALUES (1, &apos;ivan&apos;), (2, &apos;du&apos;), (3, &apos;eming&apos;), (4, &apos;he&apos;);</span><br><span class="line">INSERT INTO inbound (name) VALUES (&quot;inbound&quot;);</span><br><span class="line">INSERT INTO outbound (name) VALUES (&quot;outbound&quot;);</span><br></pre></td></tr></table></figure></p><h1 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h1><h2 id="部署到linux下tomcat中"><a href="#部署到linux下tomcat中" class="headerlink" title="部署到linux下tomcat中"></a>部署到linux下tomcat中</h2><p>参考<a href="/2018/02/05/iarc-130">数据访问层</a>中<code>部署</code>部分</p><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul><li><a href="http://blog.csdn.net/envon123/article/details/76615059" target="_blank" rel="noopener">CentOS下mysql主从复制</a></li><li><a href="http://www.mycat.io/" target="_blank" rel="noopener">mycat官网</a></li><li><a href="https://www.jianshu.com/p/2d1a81b2dafc" target="_blank" rel="noopener">mycat简介</a></li><li><a href="http://blog.csdn.net/yingxiake/article/details/51695094" target="_blank" rel="noopener">mycat实践</a></li></ul>]]></content>
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Architect </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>架构之旅-集群与管理-数据-Redis</title>
      <link href="/2018/02/08/iarc-231/"/>
      <url>/2018/02/08/iarc-231/</url>
      <content type="html"><![CDATA[<h1 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h1><p>本文中，将改进数据服务。使用redis集群来提供缓存服务。<a id="more"></a></p><h1 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h1><p><a href="https://github.com/icmyfuture/iarc/tree/master/iarc-data" target="_blank" rel="noopener">iarc-data</a></p><h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><p>IDE: IntelliJ IDEA<br>JDK: 1.8.0_u162<br>Framework: spring boot, dubbo<br>Cache: Redis<br>WebServer: Tomcat (本地端口8088)</p><h1 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h1><h2 id="pom-dependency"><a href="#pom-dependency" class="headerlink" title="pom dependency"></a>pom dependency</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><h2 id="appliation-properties-redis配置"><a href="#appliation-properties-redis配置" class="headerlink" title="appliation.properties redis配置"></a>appliation.properties redis配置</h2><h3 id="通用"><a href="#通用" class="headerlink" title="通用"></a>通用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">spring.redis.database=2</span><br><span class="line">spring.redis.timeout=10000</span><br><span class="line">spring.redis.pool.max-idle=8</span><br><span class="line">spring.redis.pool.min-idle=1</span><br><span class="line">spring.redis.pool.max-active=8</span><br><span class="line">spring.redis.pool.max-wait=-1</span><br></pre></td></tr></table></figure><h3 id="单实例"><a href="#单实例" class="headerlink" title="单实例"></a>单实例</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spring.redis.host=127.0.0.1</span><br><span class="line">spring.redis.port=6379</span><br><span class="line">spring.redis.password=****</span><br></pre></td></tr></table></figure><h3 id="Sentinel集群"><a href="#Sentinel集群" class="headerlink" title="Sentinel集群"></a>Sentinel集群</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">spring.redis.sentinel.master=mymaster</span><br><span class="line">spring.redis.sentinel.nodes=192.168.56.103:29000,192.168.56.103:29001,192.168.56.103:29002</span><br></pre></td></tr></table></figure><h2 id="配置类"><a href="#配置类" class="headerlink" title="配置类"></a>配置类</h2><h3 id="RedisCacheConfig"><a href="#RedisCacheConfig" class="headerlink" title="RedisCacheConfig"></a>RedisCacheConfig</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">package cn.icmyfuture.iarc.data.common;</span><br><span class="line"></span><br><span class="line">import com.fasterxml.jackson.annotation.JsonAutoDetect;</span><br><span class="line">import com.fasterxml.jackson.annotation.PropertyAccessor;</span><br><span class="line">import com.fasterxml.jackson.databind.DeserializationFeature;</span><br><span class="line">import com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line">import org.springframework.cache.CacheManager;</span><br><span class="line">import org.springframework.cache.annotation.CachingConfigurerSupport;</span><br><span class="line">import org.springframework.cache.interceptor.KeyGenerator;</span><br><span class="line">import org.springframework.context.annotation.Bean;</span><br><span class="line">import org.springframework.data.redis.cache.RedisCacheManager;</span><br><span class="line">import org.springframework.data.redis.connection.RedisConnectionFactory;</span><br><span class="line">import org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line">import org.springframework.data.redis.core.StringRedisTemplate;</span><br><span class="line">import org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer;</span><br><span class="line"></span><br><span class="line">import java.lang.reflect.Method;</span><br><span class="line">import java.util.HashMap;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">public class RedisCacheConfig extends CachingConfigurerSupport &#123;</span><br><span class="line">    private static final Map&lt;String, Long&gt; cacheMap = new HashMap&lt;String, Long&gt;();</span><br><span class="line"></span><br><span class="line">    public static void setCacheTime(String key, Long cacheTime)&#123;</span><br><span class="line">        cacheMap.put(key, cacheTime);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    public KeyGenerator keyGenerator() &#123;</span><br><span class="line">        return new KeyGenerator() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public Object generate(Object target, Method method, Object... params) &#123;</span><br><span class="line">                StringBuilder sb = new StringBuilder();</span><br><span class="line">                sb.append(&quot;v2:&quot;);</span><br><span class="line">                sb.append(target.getClass().getName()+&quot;:&quot;);</span><br><span class="line">                sb.append(method.getName()+&quot;:&quot;);</span><br><span class="line">                for (Object obj : params) &#123;</span><br><span class="line">                    sb.append(obj.toString());</span><br><span class="line">                &#125;</span><br><span class="line">                return sb.toString();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @SuppressWarnings(&quot;rawtypes&quot;)</span><br><span class="line">    @Bean</span><br><span class="line">    public CacheManager cacheManager(RedisTemplate redisTemplate) &#123;</span><br><span class="line">        RedisCacheManager cacheManager = new RedisCacheManager(redisTemplate);</span><br><span class="line">        cacheManager.setExpires(cacheMap);</span><br><span class="line">        return cacheManager;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    public RedisTemplate&lt;String, String&gt; redisTemplate(RedisConnectionFactory factory) &#123;</span><br><span class="line">        StringRedisTemplate template = new StringRedisTemplate(factory);</span><br><span class="line">        Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer(Object.class);</span><br><span class="line">        ObjectMapper om = new ObjectMapper();</span><br><span class="line">        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);</span><br><span class="line">        om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);</span><br><span class="line">        om.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);</span><br><span class="line">        jackson2JsonRedisSerializer.setObjectMapper(om);</span><br><span class="line">        template.setValueSerializer(jackson2JsonRedisSerializer);</span><br><span class="line">        template.afterPropertiesSet();</span><br><span class="line">        return template;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="CacheConfig"><a href="#CacheConfig" class="headerlink" title="CacheConfig"></a>CacheConfig</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">package cn.icmyfuture.iarc.data.config;</span><br><span class="line"></span><br><span class="line">import cn.icmyfuture.iarc.data.common.RedisCacheConfig;</span><br><span class="line">import org.springframework.cache.annotation.EnableCaching;</span><br><span class="line">import org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line">@Configuration</span><br><span class="line">@EnableCaching</span><br><span class="line">public class CacheConfig extends RedisCacheConfig &#123;</span><br><span class="line">    public static final String getAllUsers = &quot;getAllUsers&quot;;</span><br><span class="line"></span><br><span class="line">    static &#123;</span><br><span class="line">        setCacheTime(getAllUsers, 180L);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="SpringBoot开启缓存"><a href="#SpringBoot开启缓存" class="headerlink" title="SpringBoot开启缓存"></a>SpringBoot开启缓存</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@EnableCaching</span><br><span class="line">public class DataApplication extends SpringBootServletInitializer</span><br></pre></td></tr></table></figure><h3 id="Service实现中，使用redis缓存"><a href="#Service实现中，使用redis缓存" class="headerlink" title="Service实现中，使用redis缓存"></a>Service实现中，使用redis缓存</h3><p>由于dubbo不支持使用注解@Cacheable，只能选择以下2种解决方式之一(本文使用第一种方式，对key的设置有更大的灵活性)</p><ul><li>使用@Service注解，在代码中获取/设置缓存</li><li>不使用@Service注解，使用dubbo配置的方式来注册服务，同时开启缓存<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">@Service</span><br><span class="line">public class UserServiceImpl implements UserService &#123;</span><br><span class="line">    @Autowired</span><br><span class="line">    UserDao userDao;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private CacheManager cacheManager;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public List&lt;User&gt; getAllUsers() &#123;</span><br><span class="line">        Cache cache = cacheManager.getCache(CacheConfig.getAllUsers);</span><br><span class="line">        String key = String.format(&quot;%s&quot;, CacheConfig.getAllUsers);</span><br><span class="line">        Cache.ValueWrapper wrapper = cache.get(key);</span><br><span class="line">        List&lt;User&gt; users;</span><br><span class="line">        if (wrapper == null) &#123;</span><br><span class="line">            users = userDao.getAllUsers();</span><br><span class="line">            cache.put(key, users);</span><br><span class="line">            return users;</span><br><span class="line">        &#125;</span><br><span class="line">        return (List&lt;User&gt;) wrapper.get();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li></ul><h1 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h1><ul><li>访问<code>http://localhost:8002/user/getAllUsers</code>来验证redis缓存的有效性</li><li>访问<code>http://localhost:8002/druid/index.html</code>来查看<code>SQL监控</code>以验证sql仅被执行了一次</li></ul><h1 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h1><p>centos下配置好redis。maven工程根目录下执行命令<code>mvn clean install</code>，然后将iarc-data与iarc-service部署到tomcat中,访问<code>http://localhost:8080/service/user/getAllUsers</code></p><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul><li><a href="https://www.cnblogs.com/jaign/articles/7920588.html" target="_blank" rel="noopener">windows下redis安装配置</a></li><li><a href="http://blog.csdn.net/qiuyufeng/article/details/70474001" target="_blank" rel="noopener">windows下redis集群配置</a></li><li>Redis Sentinel <a href="http://blog.csdn.net/men_wen/article/details/72724406" target="_blank" rel="noopener">1</a> <a href="https://www.cnblogs.com/keithtt/p/6693030.html" target="_blank" rel="noopener">2</a> <a href="https://www.cnblogs.com/keithtt/p/6719532.html" target="_blank" rel="noopener">3</a> <a href="http://blog.csdn.net/lifetragedy/article/details/50660310" target="_blank" rel="noopener">4</a></li><li><a href="https://www.cnblogs.com/ityouknow/p/5748830.html" target="_blank" rel="noopener">spring boot使用redis</a></li></ul>]]></content>
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Architect </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>架构之旅-多层架构-数据</title>
      <link href="/2018/02/05/iarc-130/"/>
      <url>/2018/02/05/iarc-130/</url>
      <content type="html"><![CDATA[<h1 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h1><p>本文中，将使用<code>MyBatis + Druid</code>来构建数据访问层访问<code>MySQL</code>，使用dubbo+zookeeper来充当service provider,并修改<a href="/2018/02/05/iarc-120">service</a>来使用dubbo(service consumer)。<a id="more"></a></p><h1 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h1><p><a href="https://github.com/icmyfuture/iarc/tree/master/iarc-data" target="_blank" rel="noopener">iarc-data</a></p><h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><p>IDE: IntelliJ IDEA<br>JDK: 1.8.0_u162<br>Framework: MyBatis, Druid, Dubbo<br>App Coordinator: Zookeeper<br>DB: MySQL<br>WebServer: Tomcat (本地端口8088)</p><h1 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h1><h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><ul><li>zookeeper<br>把Zookeeper安装目录中<code>/conf/zoo_simple.cfg</code>重命名为<code>zoo.cfg</code>。然后执行 Zookeeper安装目录<code>/bin/zkServer.cmd</code></li><li>在tomcat中安装<code>dubbo admin</code>来监控服务<a href="/2017/06/16/linux-note">参考</a></li></ul><h2 id="工程结构"><a href="#工程结构" class="headerlink" title="工程结构"></a>工程结构</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">--root(maven pom父工程)</span><br><span class="line">----iarc-entity (实体类 module)</span><br><span class="line">----iarc-service-api (服务接口 module)</span><br><span class="line">----iarc-service (服务站点-spring boot)</span><br><span class="line">----iarc-data (数据服务 module)</span><br></pre></td></tr></table></figure><h2 id="SQL初始化脚本"><a href="#SQL初始化脚本" class="headerlink" title="SQL初始化脚本"></a>SQL初始化脚本</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">CREATE SCHEMA ijava;</span><br><span class="line">use ijava;</span><br><span class="line">CREATE TABLE user</span><br><span class="line">(</span><br><span class="line">  id   INT AUTO_INCREMENT</span><br><span class="line">    PRIMARY KEY,</span><br><span class="line">  name VARCHAR(50) NOT NULL</span><br><span class="line">)</span><br><span class="line">  COMMENT &apos;user table&apos;</span><br><span class="line">  ENGINE = InnoDB;</span><br><span class="line">INSERT INTO ijava.user (name) VALUES (&apos;ivan&apos;), (&apos;du&apos;);</span><br></pre></td></tr></table></figure><h2 id="iarc-data"><a href="#iarc-data" class="headerlink" title="iarc-data"></a>iarc-data</h2><ul><li><p>spring boot configuration</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">server.port=8002</span><br><span class="line">endpoints.jmx.unique-names=true</span><br><span class="line">spring.jmx.default-domain=iarc.data</span><br></pre></td></tr></table></figure></li><li><p>dubbo configuration</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">spring.dubbo.application.name=iarc.data</span><br><span class="line">spring.dubbo.registry.address=zookeeper://127.0.0.1:2181</span><br><span class="line">spring.dubbo.registry.group=dubbo</span><br><span class="line">spring.dubbo.protocol.name=dubbo</span><br><span class="line">spring.dubbo.protocol.port=20882</span><br><span class="line">spring.dubbo.scan=cn.icmyfuture.iarc.data</span><br><span class="line">spring.dubbo.consumer.retries=0</span><br><span class="line">spring.dubbo.consumer.timeout=10000</span><br><span class="line">spring.dubbo.consumer.check=false</span><br></pre></td></tr></table></figure></li><li><p>Custom Dubbo Auto Config class</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">import com.alibaba.dubbo.config.*;</span><br><span class="line">import lombok.Getter;</span><br><span class="line">import lombok.Setter;</span><br><span class="line">import org.slf4j.Logger;</span><br><span class="line">import org.slf4j.LoggerFactory;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line">import org.springframework.boot.context.properties.EnableConfigurationProperties;</span><br><span class="line">import org.springframework.context.annotation.Bean;</span><br><span class="line">import org.springframework.context.annotation.Configuration;</span><br><span class="line">import org.springframework.core.Ordered;</span><br><span class="line">import org.springframework.core.annotation.Order;</span><br><span class="line"></span><br><span class="line">import javax.annotation.PreDestroy;</span><br><span class="line"></span><br><span class="line">@Configuration</span><br><span class="line">@EnableConfigurationProperties(&#123;CustomDubboAutoConfig.CustomDubboProperties.class&#125;)</span><br><span class="line">@Order(Ordered.LOWEST_PRECEDENCE)</span><br><span class="line">public class CustomDubboAutoConfig &#123;</span><br><span class="line">    private static final Logger logger = LoggerFactory.getLogger(CustomDubboAutoConfig.class);</span><br><span class="line"></span><br><span class="line">    @ConfigurationProperties(prefix = &quot;spring.dubbo&quot;)</span><br><span class="line">    @Setter</span><br><span class="line">    @Getter</span><br><span class="line">    class CustomDubboProperties&#123;</span><br><span class="line">        private MonitorConfig monitor;</span><br><span class="line">        private ConsumerConfig consumer;</span><br><span class="line">        private ProviderConfig provider;</span><br><span class="line">        private ModuleConfig module;</span><br><span class="line">        private MethodConfig method;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private CustomDubboProperties dubboProperties;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    public ConsumerConfig consumerConfig() &#123;</span><br><span class="line">        ConsumerConfig consumerConfig = this.dubboProperties.getConsumer();</span><br><span class="line">        if (consumerConfig == null) &#123;</span><br><span class="line">            consumerConfig = new ConsumerConfig();</span><br><span class="line">        &#125;</span><br><span class="line">        return consumerConfig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    public MonitorConfig monitorConfig()&#123;</span><br><span class="line">        MonitorConfig monitorConfig = this.dubboProperties.getMonitor();</span><br><span class="line">        if (monitorConfig == null) &#123;</span><br><span class="line">            monitorConfig = new MonitorConfig();</span><br><span class="line">        &#125;</span><br><span class="line">        return monitorConfig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    public ProviderConfig providerConfig() &#123;</span><br><span class="line">        ProviderConfig providerConfig = this.dubboProperties.getProvider();</span><br><span class="line">        if (providerConfig == null) &#123;</span><br><span class="line">            providerConfig = new ProviderConfig();</span><br><span class="line">        &#125;</span><br><span class="line">        return providerConfig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    public MethodConfig requestMethodConfig() &#123;</span><br><span class="line">        MethodConfig methodConfig = dubboProperties.getMethod();</span><br><span class="line">        if (methodConfig == null) &#123;</span><br><span class="line">            methodConfig = new MethodConfig();</span><br><span class="line">        &#125;</span><br><span class="line">        return methodConfig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @PreDestroy</span><br><span class="line">    public void shutdownDestroy() &#123;</span><br><span class="line">        ProtocolConfig.destroyAll();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>Druid configuration</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">spring.datasource.type=com.alibaba.druid.pool.DruidDataSource</span><br><span class="line">spring.datasource.druid.ijava.url=jdbc:mysql://localhost:3306/ijava?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false&amp;allowMultiQueries=true&amp;autoReconnect=true&amp;failOverReadOnly=false&amp;connectTimeout=10000&amp;serverTimezone=Asia/Shanghai</span><br><span class="line">spring.datasource.druid.ijava.driverClassName=com.mysql.cj.jdbc.Driver</span><br><span class="line">spring.datasource.druid.ijava.username=***</span><br><span class="line">spring.datasource.druid.ijava.password=***</span><br><span class="line">spring.datasource.druid.ijava.initialSize=1</span><br><span class="line">spring.datasource.druid.ijava.minIdle=1</span><br><span class="line">spring.datasource.druid.ijava.maxActive=20</span><br><span class="line">spring.datasource.druid.ijava.maxWait=60000</span><br><span class="line">spring.datasource.druid.ijava.timeBetweenEvictionRunsMillis=60000</span><br><span class="line">spring.datasource.druid.ijava.minEvictableIdleTimeMillis=300000</span><br><span class="line">spring.datasource.druid.ijava.testWhileIdle=true</span><br><span class="line">spring.datasource.druid.ijava.testOnBorrow=false</span><br><span class="line">spring.datasource.druid.ijava.testOnReturn=false</span><br><span class="line">spring.datasource.druid.ijava.validationQuery=SELECT 1</span><br><span class="line">spring.datasource.druid.ijava.poolPreparedStatements=true</span><br><span class="line">spring.datasource.druid.ijava.maxPoolPreparedStatementPerConnectionSize=20</span><br><span class="line">spring.datasource.druid.ijava.filters=stat,slf4j</span><br><span class="line">spring.datasource.druid.ijava.connectionProperties=druid.stat.mergeSql=true;druid.stat.slowSqlMillis=2000</span><br><span class="line">#WebStatFilter，为了进行Druid DB监控</span><br><span class="line">spring.datasource.druid.WebStatFilter.enabled=true</span><br><span class="line">spring.datasource.druid.WebStatFilter.urlPattern=/druid/*</span><br><span class="line">spring.datasource.druid.WebStatFilter.exclusions=false</span><br><span class="line">#StatViewServlet，为了进行Druid DB监控</span><br><span class="line">spring.datasource.druid.StatViewServlet.enabled=true</span><br><span class="line">spring.datasource.druid.StatViewServlet.urlPattern=/druid/*</span><br><span class="line">spring.datasource.druid.StatViewServlet.resetEnable=false</span><br></pre></td></tr></table></figure></li></ul><h2 id="iarc-service"><a href="#iarc-service" class="headerlink" title="iarc-service"></a>iarc-service</h2><ul><li><p>port &amp;&amp; jmx unique configuration</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">server.port=8002</span><br><span class="line">endpoints.jmx.unique-names=true</span><br><span class="line">spring.jmx.default-domain=iarc.data</span><br></pre></td></tr></table></figure></li><li><p>dubbo configuration</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">spring.dubbo.application.name=iarc.service</span><br><span class="line">spring.dubbo.registry.address=zookeeper://127.0.0.1:2181</span><br><span class="line">spring.dubbo.registry.group=dubbo</span><br><span class="line">spring.dubbo.protocol.port=20881</span><br><span class="line">spring.dubbo.scan=cn.icmyfuture.iarc.service</span><br><span class="line">spring.dubbo.consumer.retries=0</span><br><span class="line">spring.dubbo.consumer.timeout=10000</span><br><span class="line">spring.dubbo.consumer.check=false</span><br></pre></td></tr></table></figure></li><li><p>dubbo service reference</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">@RequestMapping(value = &quot;/user&quot;)</span><br><span class="line">public class UserController &#123;</span><br><span class="line">    @Reference</span><br><span class="line">    private UserService userService;</span><br><span class="line"></span><br><span class="line">    @CrossOrigin(origins = &quot;*&quot;)</span><br><span class="line">    @GetMapping(&quot;getUser/&#123;id&#125;&quot;)</span><br><span class="line">    public User getUser(@PathVariable(&quot;id&quot;) int id) &#123;</span><br><span class="line">        return userService.getUser(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>Custom Dubbo Auto Config class<br>与iarc-data节中相同</p></li></ul><h1 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h1><ul><li>IntelliJ IDEA中启动DataApplication以及ServiceApplication两个SpringBoot站点</li><li>打开<a href="http://localhost:8088/dubbo-admin-2.8.4" target="_blank" rel="noopener">本地tomcat dubbo admin站点</a>查看服务提供者/消费者</li><li>DB监控<a href="http://localhost:8002/druid/index.html" target="_blank" rel="noopener">Druid</a> 登录账户admin admin</li><li>输入 <a href="http://localhost:8002/user/getAllUsers来验证" target="_blank" rel="noopener">http://localhost:8002/user/getAllUsers来验证</a></li></ul><h1 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h1><h2 id="maven-编译打包"><a href="#maven-编译打包" class="headerlink" title="maven 编译打包"></a>maven 编译打包</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean install -Dmaven.test.skip=true</span><br></pre></td></tr></table></figure><h2 id="部署data-service至centos"><a href="#部署data-service至centos" class="headerlink" title="部署data/service至centos"></a>部署data/service至centos</h2><p>将打包好的iarc-service.war, iarc-data.war复制到 <code>$CATALINA_HOME/webapps</code>目录下，tomcat会自动解压war包，访问<code>http://localhost:8080/iarc-service/user/getUser/1</code>进行验证</p><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul><li><a href="http://blog.csdn.net/xyang81/article/details/51487939" target="_blank" rel="noopener">Maven</a></li><li><a href="http://blog.csdn.net/vbirdbest/article/details/72821114" target="_blank" rel="noopener">Spring+Mybatis+Druid 整合Demo</a></li><li><a href="https://gitee.com/icmyfuture/ds/tree/master/ibuild/ibuild-web/ibuild-service-data">service-data</a></li><li><a href="https://www.cnblogs.com/520playboy/p/6298289.html" target="_blank" rel="noopener">dubbo admin</a></li></ul>]]></content>
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Architect </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>架构之旅-多层架构-服务</title>
      <link href="/2018/02/05/iarc-120/"/>
      <url>/2018/02/05/iarc-120/</url>
      <content type="html"><![CDATA[<h1 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h1><p>本文中，将使用<code>spring boot</code>来构建服务，使用swagger2来提供api ui。最终部署到linux下tomcat中。<a id="more"></a></p><h1 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h1><p><a href="https://github.com/icmyfuture/iarc/tree/master/iarc-service" target="_blank" rel="noopener">iarc-service</a></p><h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><p>IDE: IntelliJ IDEA<br>JDK: 1.8.0_u162<br>Framework: Spring Boot, Swagger2<br>WebServer: Tomcat(本地端口8088)</p><h1 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h1><h2 id="工程结构"><a href="#工程结构" class="headerlink" title="工程结构"></a>工程结构</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">--root(maven pom父工程)</span><br><span class="line">----iarc-entity (实体类 module)</span><br><span class="line">----iarc-service-api (服务接口 module)</span><br><span class="line">----iarc-service (服务站点-spring boot)</span><br><span class="line">----iarc-data (数据服务 module)</span><br></pre></td></tr></table></figure><h2 id="root"><a href="#root" class="headerlink" title="root"></a>root</h2><p>pom.xml中值得注意的只有packaging节点，类型为<code>pom</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;packaging&gt;pom&lt;/packaging&gt;</span><br></pre></td></tr></table></figure></p><h2 id="iarc-entity"><a href="#iarc-entity" class="headerlink" title="iarc-entity"></a>iarc-entity</h2><p>设置root作为parent，使用<a href="https://www.jianshu.com/p/365ea41b3573" target="_blank" rel="noopener">lombok</a>来简化Java代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;parent&gt;</span><br><span class="line">    &lt;groupId&gt;cn.icmyfuture.iarc&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;root&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;</span><br><span class="line">&lt;/parent&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependencies&gt;</span><br><span class="line">    &lt;!--lombok--&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;lombok&lt;/artifactId&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure></p><h2 id="iarc-service"><a href="#iarc-service" class="headerlink" title="iarc-service"></a>iarc-service</h2><ul><li><p><code>pom.xml</code>中<code>packaging</code>节点类型为<code>war</code>，dependencies/build使用spring boot标准配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;packaging&gt;war&lt;/packaging&gt;</span><br><span class="line">...</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">...</span><br><span class="line">&lt;!-- springfox --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;io.springfox&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;$&#123;swagger2.version&#125;&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;io.springfox&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;$&#123;swagger2.version&#125;&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">...</span><br><span class="line">&lt;build&gt;</span><br><span class="line">    &lt;plugins&gt;</span><br><span class="line">        &lt;plugin&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">        &lt;/plugin&gt;</span><br><span class="line">    &lt;/plugins&gt;</span><br><span class="line">&lt;/build&gt;</span><br></pre></td></tr></table></figure></li><li><p>端口和JMX唯一性配置<br><code>./iarc-service/src/main/resources/application.properties</code>中设置参数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">server.port=8001</span><br><span class="line">endpoints.jmx.unique-names=true</span><br><span class="line">spring.jmx.default-domain=iarc.data</span><br></pre></td></tr></table></figure></li><li><p>swagger2 configuration class</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">package cn.icmyfuture.iarc.service.config;</span><br><span class="line"></span><br><span class="line">import org.springframework.context.annotation.Bean;</span><br><span class="line">import org.springframework.context.annotation.Configuration;</span><br><span class="line">import springfox.documentation.builders.ApiInfoBuilder;</span><br><span class="line">import springfox.documentation.builders.PathSelectors;</span><br><span class="line">import springfox.documentation.builders.RequestHandlerSelectors;</span><br><span class="line">import springfox.documentation.service.ApiInfo;</span><br><span class="line">import springfox.documentation.spi.DocumentationType;</span><br><span class="line">import springfox.documentation.spring.web.plugins.Docket;</span><br><span class="line">import springfox.documentation.swagger2.annotations.EnableSwagger2;</span><br><span class="line"></span><br><span class="line">@Configuration</span><br><span class="line">@EnableSwagger2</span><br><span class="line">public class Swagger2Config &#123;</span><br><span class="line">    @Bean</span><br><span class="line">    public Docket createRestApi() &#123;</span><br><span class="line">        return new Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(apiInfo())</span><br><span class="line">                .select()</span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(&quot;cn.icmyfuture.iarc.service.controller&quot;))</span><br><span class="line">                .paths(PathSelectors.any())</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private ApiInfo apiInfo() &#123;</span><br><span class="line">        return new ApiInfoBuilder()</span><br><span class="line">                .title(&quot;Spring Boot using Swagger2 for RESTful APIs&quot;)</span><br><span class="line">                .description(&quot;ivan&apos;s swagger2&quot;)</span><br><span class="line">                .termsOfServiceUrl(&quot;http://localhost:8001&quot;)</span><br><span class="line">                .contact(&quot;ivan&quot;)</span><br><span class="line">                .version(&quot;1.0&quot;)</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h1 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h1><p>IntelliJ IDEA中<code>Run ServiceApplication</code>，使用spring boot内置的tomcat容器作为宿主，</p><ul><li>输入<code>http://localhost:8001/user/getUser/123</code>来进行验证</li><li>输入<code>http://localhost:8001/swagger-ui.html</code>来查看api ui</li></ul><h1 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h1><h2 id="打包"><a href="#打包" class="headerlink" title="打包"></a>打包</h2><p>打开IntelliJ IDEA中<code>Maven Projects</code>窗口。由于使用了maven父工程，打包时需要先执行root相关操作</p><ul><li><p>root</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Lifecycle - 依次clean compile install</span><br></pre></td></tr></table></figure></li><li><p>iarc-service</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Lifecyle - 依次clean compile package</span><br></pre></td></tr></table></figure></li></ul><h2 id="部署到linux下tomcat中"><a href="#部署到linux下tomcat中" class="headerlink" title="部署到linux下tomcat中"></a>部署到linux下tomcat中</h2><ul><li>linux下jdk以及tomcat的安装/自启动可参考<a href="/2017/06/16/linux-note">这里</a></li><li>将打包好的iarc-service.war复制到 <code>$CATALINA_HOME/webapps</code>目录下，tomcat会自动解压war包，访问<code>http://localhost:8080/iarc-service/user/getUser/123</code>进行验证</li></ul><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul><li><a href="https://www.tianmaying.com/tutorial/spring-boot-overview" target="_blank" rel="noopener">spring boot overview</a></li><li><a href="http://www.infoq.com/cn/articles/microframeworks1-spring-boot" target="_blank" rel="noopener">microframeworks spring boot</a></li><li><a href="http://blog.csdn.net/james_wade63/article/details/51009423" target="_blank" rel="noopener">spring boot tomcat部署</a></li><li><a href="http://blog.csdn.net/Eacter/article/details/55261756" target="_blank" rel="noopener">spring boot + swagger2</a></li></ul>]]></content>
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Architect </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>架构之旅-多层架构-应用</title>
      <link href="/2018/01/29/iarc-110/"/>
      <url>/2018/01/29/iarc-110/</url>
      <content type="html"><![CDATA[<h1 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h1><p>本文中，将使用<code>vuejs + webpack</code>来搭建单页应用。采用sublimetext3充当前端开发的ID E。开发时，使用nodejs作为应用宿主。部署时，则使用nginx充当静态网页宿主。<a id="more"></a></p><h1 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h1><p><a href="https://github.com/icmyfuture/iarc/tree/master/iarc-app" target="_blank" rel="noopener">iarc-app</a></p><h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><p>IDE: <a href="/2017/06/19/st-note">SublimeText3</a><br>WebServer: Nginx</p><h1 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h1><h2 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h2><p>从头开始自己搭建一个vuejs+webpack的单页应用并非明智之选。所以本文将使用github上的<a href="https://github.com/vuejs-templates/webpack" target="_blank" rel="noopener">vuejs-templates webpack</a>。</p><h2 id="端口"><a href="#端口" class="headerlink" title="端口"></a>端口</h2><p><code>./config/index.js</code>中<code>port</code>设置为<code>8008</code></p><h2 id="服务调用"><a href="#服务调用" class="headerlink" title="服务调用"></a>服务调用</h2><ul><li>使用 npm package: <a href="https://www.npmjs.com/package/isomorphic-fetch" target="_blank" rel="noopener">isomorphic-fetch</a></li><li>跨域调用<br>fetch时添加如下设置，但服务端必须设置<code>@CrossOrigin(origins = &quot;*&quot;)</code>(假定使用spring annotation)<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fetch(window.$config.APIHost + url, &#123;</span><br><span class="line">  method: &apos;get&apos;,</span><br><span class="line">  mode: &apos;cors&apos;,</span><br><span class="line">  header: &#123;&apos;Access-Control-Allow-Origin&apos;: &apos;*&apos;&#125;</span><br><span class="line">&#125;).then(function (res) &#123;</span><br></pre></td></tr></table></figure></li></ul><h1 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h1><p>iarc-app根目录下输入<code>cnpm run dev</code>启动本地nodejs服务器，访问<code>localhost:8008</code>进行验证</p><h1 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h1><p>linux下的nginx的配置文件路径是 /etc/nginx，在配置文件中添加如下server节点，并重启nginx服务。具体可参考<a href="/2017/06/16/linux-note">nginx配置</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 7007;</span><br><span class="line">    server_name localhost;</span><br><span class="line">    root /etc/nginx/www/iapp;</span><br><span class="line">    index index.html;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul><li><a href="https://github.com/vuejs-templates/webpack" target="_blank" rel="noopener">vuejs-templates webpack</a></li></ul>]]></content>
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Architect </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>架构之旅</title>
      <link href="/2018/01/29/iarc-000/"/>
      <url>/2018/01/29/iarc-000/</url>
      <content type="html"><![CDATA[<p>本系列描述了从单一的多层架构到分布式架构的<a href="http://www.epubit.com.cn/article/1481?hmsr=toutiao.io&amp;utm_medium=toutiao.io&amp;utm_source=toutiao.io" target="_blank" rel="noopener">进化历程</a><a id="more"></a></p><h1 id="多层架构"><a href="#多层架构" class="headerlink" title="多层架构"></a>多层架构</h1><h2 id="应用-app"><a href="#应用-app" class="headerlink" title="应用(app)"></a><a href="/2018/01/29/iarc-110/">应用(app)</a></h2><pre><code>vuejs + webpack + nginx</code></pre><h2 id="服务-service"><a href="#服务-service" class="headerlink" title="服务(service)"></a><a href="/2018/02/05/iarc-120">服务(service)</a></h2><pre><code>spring boot + tomcat</code></pre><h2 id="数据-data"><a href="#数据-data" class="headerlink" title="数据(data)"></a><a href="/2018/02/05/iarc-130">数据(data)</a></h2><pre><code>mybatis + druid + mysql</code></pre><h1 id="集群与管理-负载均衡"><a href="#集群与管理-负载均衡" class="headerlink" title="集群与管理(负载均衡)"></a>集群与管理(负载均衡)</h1><h2 id="应用-app-1"><a href="#应用-app-1" class="headerlink" title="应用(app)"></a><a href="/2018/08/14/iarc-210">应用(app)</a></h2><pre><code>nginx + docker</code></pre><h2 id="服务-service-1"><a href="#服务-service-1" class="headerlink" title="服务(service)"></a><a href="/2018/08/14/iarc-220">服务(service)</a></h2><pre><code>nginx + docker</code></pre><h2 id="数据-data-1"><a href="#数据-data-1" class="headerlink" title="数据(data)"></a>数据(data)</h2><h3 id="cache-using-redis"><a href="#cache-using-redis" class="headerlink" title="cache using redis"></a><a href="/2018/02/08/iarc-231">cache using redis</a></h3><h3 id="mysql-cluster-r-w-replication-sharding"><a href="#mysql-cluster-r-w-replication-sharding" class="headerlink" title="mysql cluster: r/w, replication, sharding"></a><a href="/2018/03/02/iarc-232">mysql cluster: r/w, replication, sharding</a></h3><h1 id="微服务与管理-业务拆分"><a href="#微服务与管理-业务拆分" class="headerlink" title="微服务与管理(业务拆分)"></a>微服务与管理(业务拆分)</h1><h2 id="服务-service-2"><a href="#服务-service-2" class="headerlink" title="服务(service)"></a>服务(service)</h2><pre><code>docker + spring cloud</code></pre><h1 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h1><h2 id="应用-app-2"><a href="#应用-app-2" class="headerlink" title="应用(app)"></a>应用(app)</h2><pre><code>mobile app</code></pre><h2 id="服务-service-3"><a href="#服务-service-3" class="headerlink" title="服务(service)"></a>服务(service)</h2><ul><li><a href="/2018/04/10/iarc-421">log</a></li><li>monitor</li></ul><h2 id="数据-data-2"><a href="#数据-data-2" class="headerlink" title="数据(data)"></a>数据(data)</h2><h3 id="messaging"><a href="#messaging" class="headerlink" title="messaging"></a>messaging</h3><ul><li><a href="/2018/04/08/iarc-431">mq(rabbitmq)</a></li><li>pub/sub(kafka)</li></ul><h3 id="search-engine"><a href="#search-engine" class="headerlink" title="search engine"></a>search engine</h3><ul><li><a href="/2018/04/25/iarc-441">solr</a></li></ul><h3 id="nosql-mongodb"><a href="#nosql-mongodb" class="headerlink" title="nosql: mongodb"></a>nosql: mongodb</h3><h3 id="file-system-hadoop"><a href="#file-system-hadoop" class="headerlink" title="file system: hadoop"></a>file system: hadoop</h3>]]></content>
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Architect </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>代码片段</title>
      <link href="/2017/06/20/code-snippet/"/>
      <url>/2017/06/20/code-snippet/</url>
      <content type="html"><![CDATA[<h1 id="倒序匹配获取正确区域名称"><a href="#倒序匹配获取正确区域名称" class="headerlink" title="倒序匹配获取正确区域名称"></a>倒序匹配获取正确区域名称</h1><p>问题：有些区域直属于省，但其区域编码按层级又在市级别以下，如何正确获取这些区域的名称<br>方案：递归查找时，标识是否找到，若找到才倒序插入列表<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">        var list = [];</span></span><br><span class="line"><span class="undefined">        var data = [&#123;</span></span><br><span class="line"><span class="undefined">                value: "51",</span></span><br><span class="line"><span class="undefined">                children: [&#123;</span></span><br><span class="line"><span class="undefined">                    value: "5101",</span></span><br><span class="line"><span class="undefined">                    children: [&#123;</span></span><br><span class="line"><span class="undefined">                        value: "510104",</span></span><br><span class="line"><span class="undefined">                        children: []</span></span><br><span class="line"><span class="undefined">                    &#125;]</span></span><br><span class="line"><span class="undefined">                &#125;]</span></span><br><span class="line"><span class="undefined">            &#125;, &#123;</span></span><br><span class="line"><span class="undefined">                value: "61",</span></span><br><span class="line"><span class="undefined">                children: [&#123;</span></span><br><span class="line"><span class="undefined">                    value: "6101",</span></span><br><span class="line"><span class="undefined">                    children: [&#123;</span></span><br><span class="line"><span class="undefined">                        value: "610101",</span></span><br><span class="line"><span class="undefined">                        children: []</span></span><br><span class="line"><span class="undefined">                    &#125;]</span></span><br><span class="line"><span class="undefined">                &#125;, &#123;</span></span><br><span class="line"><span class="undefined">                    value: "610194",</span></span><br><span class="line"><span class="undefined">                    children: [&#123;</span></span><br><span class="line"><span class="undefined">                        value: "61019401",</span></span><br><span class="line"><span class="undefined">                        children: []</span></span><br><span class="line"><span class="undefined">                    &#125;]</span></span><br><span class="line"><span class="undefined">                &#125;]</span></span><br><span class="line"><span class="undefined">            &#125;];</span></span><br><span class="line"><span class="undefined">        var selectedValue = "61019401";</span></span><br><span class="line"><span class="undefined">        var got = false;</span></span><br><span class="line"><span class="undefined">        var find = function (item) &#123;</span></span><br><span class="line"><span class="undefined">            if (selectedValue.startsWith(item.value)) &#123;</span></span><br><span class="line"><span class="undefined">                if(item.children &amp;&amp; item.children.length &gt; 0) &#123;</span></span><br><span class="line"><span class="undefined">                    for (var j = 0; j &lt; item.children.length; j++) &#123;</span></span><br><span class="line"><span class="undefined">                        find(item.children[j])</span></span><br><span class="line"><span class="undefined">                    &#125;</span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">                if (selectedValue == item.value) got = true</span></span><br><span class="line"><span class="undefined">                if (got) &#123;</span></span><br><span class="line"><span class="undefined">                    list.push(item);</span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">        find(data);</span></span><br><span class="line"><span class="undefined">        console.log(list);</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h1 id="由列表构建层级"><a href="#由列表构建层级" class="headerlink" title="由列表构建层级"></a>由列表构建层级</h1><h2 id="区域"><a href="#区域" class="headerlink" title="区域"></a>区域</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">private static List&lt;dynamic&gt; GetAreaList(List&lt;QR_Area&gt; areaList, int type, string code = &quot;86&quot;)</span><br><span class="line">&#123;</span><br><span class="line">    var list = new List&lt;dynamic&gt;();</span><br><span class="line">    var l = areaList.Where(a =&gt; (int)a.RealAreaType == type &amp;&amp; (a.SortCode.StartsWith(code) || code == &quot;86&quot;) &amp;&amp; !string.IsNullOrWhiteSpace(a.Name)).</span><br><span class="line">            Select(a =&gt; new &#123;</span><br><span class="line">                value = a.SortCode,</span><br><span class="line">                label = a.Name,</span><br><span class="line">                children = GetAreaList(areaList, type + 1, a.SortCode)</span><br><span class="line">            &#125;).ToList();</span><br><span class="line"></span><br><span class="line">    if (l.Count &gt; 0)</span><br><span class="line">    &#123;</span><br><span class="line">        if (code == &quot;6101&quot;)</span><br><span class="line">        &#123;</span><br><span class="line">            l = l.Where(a =&gt; !a.value.StartsWith(&quot;610194&quot;)).ToList();</span><br><span class="line">        &#125;</span><br><span class="line">        list.AddRange(l);</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">        list = null;</span><br><span class="line">    &#125;</span><br><span class="line">    return list;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="组织"><a href="#组织" class="headerlink" title="组织"></a>组织</h2><p>构建组织<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">private static dynamic ConstructContractor(List&lt;SimpleContractor&gt; list)</span><br><span class="line">&#123;</span><br><span class="line">    if (list == null || list.Count == 0) return null;</span><br><span class="line">    var l = list;</span><br><span class="line">    var top = l[0];</span><br><span class="line">    if (l.Count &gt; 1)</span><br><span class="line">    &#123;</span><br><span class="line">        l.RemoveAt(0);</span><br><span class="line">        var groups = l.GroupBy(c =&gt; c.C.Substring(0, top.C.Length + 4));</span><br><span class="line">        return new &#123; Code = top.C, Name = top.N, Children = groups.Select(g =&gt; &#123;</span><br><span class="line">            var sub = g.ToList().OrderBy(c =&gt; c.C.Length).OrderBy(c =&gt; c.C).ToList();</span><br><span class="line">            if (sub[0].C.Length &gt; top.C.Length + 4) return null;</span><br><span class="line">            return ConstructContractor(sub);</span><br><span class="line">        &#125;).Where(x =&gt; x != null).ToList() &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    return new &#123; Code = top.C, Name = top.N &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>获取组织<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">private static dynamic GetContractor(dynamic contractor, string code)</span><br><span class="line">&#123;</span><br><span class="line">    if (contractor.Code.Equals(code)) return contractor;</span><br><span class="line"></span><br><span class="line">    if (code.StartsWith(contractor.Code))</span><br><span class="line">    &#123;</span><br><span class="line">        if (contractor.Children != null &amp;&amp; contractor.Children.Count &gt; 0)</span><br><span class="line">        &#123;</span><br><span class="line">            for (var i = 0; i &lt; contractor.Children.Count; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                var result = GetContractor(contractor.Children[i], code);</span><br><span class="line">                if (result != null) return result;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return null;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="找出字符串的最大深度"><a href="#找出字符串的最大深度" class="headerlink" title="找出字符串的最大深度"></a>找出字符串的最大深度</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">findDepth</span><span class="params">(s <span class="keyword">string</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> current <span class="keyword">int</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">var</span> max <span class="keyword">int</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    b := []<span class="keyword">byte</span>(s)</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(b); i++ &#123;</span><br><span class="line">        x := b[i]</span><br><span class="line">        <span class="keyword">if</span> x == <span class="string">'('</span> &#123;</span><br><span class="line">            current += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> current &gt; max &#123;</span><br><span class="line">                max = current</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> x == <span class="string">')'</span> &amp;&amp; current &gt; <span class="number">0</span> &#123;</span><br><span class="line">            current -= <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> max - current</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">input:  (1+2+(1*2)(1+2))</span><br><span class="line">output: 3</span><br></pre></td></tr></table></figure><h2 id="找出序列中第K大的数"><a href="#找出序列中第K大的数" class="headerlink" title="找出序列中第K大的数"></a>找出序列中第K大的数</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getKMax</span><span class="params">(s []<span class="keyword">int</span>, k <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> k &lt; <span class="number">1</span> || <span class="built_in">len</span>(s) &lt; k &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将前k个数构建最小堆</span></span><br><span class="line">    constructMinHeap(s, k)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将k以后的数与s[0]进行比较</span></span><br><span class="line">    <span class="comment">//若比s[0]大, 则与s[0]交换, 并自顶向下重构最小堆</span></span><br><span class="line">    <span class="keyword">for</span> i := k; i &lt; <span class="built_in">len</span>(s); i++ &#123;</span><br><span class="line">        <span class="keyword">if</span> s[i] &lt;= s[<span class="number">0</span>] &#123;</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        s[<span class="number">0</span>], s[i] = s[i], s[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        x := <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> x &lt; k &#123;</span><br><span class="line">            x = reConstructMinHeap(s, k, x)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> s[<span class="number">0</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">reConstructMinHeap</span><span class="params">(s []<span class="keyword">int</span>, k <span class="keyword">int</span>, current <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    <span class="comment">//将current与 left=2*current+1 right=2*current+2 中最小的进行比较, 若current较大，则进行交换</span></span><br><span class="line">    left := <span class="number">2</span>*current + <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> left &lt; k &#123;</span><br><span class="line">        minIndex := left</span><br><span class="line">        right := <span class="number">2</span>*current + <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> right &lt; k &amp;&amp; s[right] &lt; s[left] &#123;</span><br><span class="line">            minIndex = right</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> s[minIndex] &lt; s[current] &#123;</span><br><span class="line">            s[current], s[minIndex] = s[minIndex], s[current]</span><br><span class="line">            <span class="keyword">return</span> minIndex</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> k</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">constructMinHeap</span><span class="params">(s []<span class="keyword">int</span>, k <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> i := k - <span class="number">1</span>; i &gt; <span class="number">0</span>; i = i - <span class="number">2</span> &#123;</span><br><span class="line">        parent := (i - <span class="number">1</span>) / <span class="number">2</span></span><br><span class="line">        left := <span class="number">2</span>*parent + <span class="number">1</span></span><br><span class="line">        right := <span class="number">2</span>*parent + <span class="number">2</span></span><br><span class="line">        minIndex := left</span><br><span class="line">        <span class="keyword">if</span> right &lt; k &amp;&amp; s[right] &lt; s[left] &#123;</span><br><span class="line">            minIndex = right</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> s[parent] &gt; s[minIndex] &#123;</span><br><span class="line">            s[parent], s[minIndex] = s[minIndex], s[parent]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">input:  [10,9,8,7,6,5,4,3,2,1], 3</span><br><span class="line">output: 8</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Editor </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Visual Studio Code 杂记</title>
      <link href="/2017/06/20/vsc-note/"/>
      <url>/2017/06/20/vsc-note/</url>
      <content type="html"><![CDATA[<h1 id="官网"><a href="#官网" class="headerlink" title="官网"></a><a href="https://code.visualstudio.com" target="_blank" rel="noopener">官网</a></h1><h1 id="推荐插件"><a href="#推荐插件" class="headerlink" title="推荐插件"></a>推荐插件</h1><blockquote><p>Settings Sync<br>One Monokai Theme/Monokai Operator/Monokai Pro<br>GitLens<br>GitHub Copilot<br>C/C++<br>Codeium<br>Go<br>Jupyter<br>Python<br>Extension Pack for Java<br>Tabnine<br>String Manipulation<br>Bracket Pair Colorizer/Rainbow Brackets<br>Todo Tree<br>Vim</p></blockquote><h1 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h1><blockquote><p>insertCursorAtEndOfEachLineSelected：选中多行，添加光标至行末<br>Select All Occurrences of Find Match：选中文本，光标选中所有匹配文本<br>showActiveFileInExplorer：在explorer中定位当前文件</p></blockquote>]]></content>
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Editor </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>JetBrains IDE 杂记</title>
      <link href="/2017/06/20/jetbrains-note/"/>
      <url>/2017/06/20/jetbrains-note/</url>
      <content type="html"><![CDATA[<h1 id="IDEA"><a href="#IDEA" class="headerlink" title="IDEA"></a>IDEA</h1><h2 id="官网"><a href="#官网" class="headerlink" title="官网"></a><a href="https://www.jetbrains.com/idea/" target="_blank" rel="noopener">官网</a></h2><h2 id="官方教程"><a href="#官方教程" class="headerlink" title="官方教程"></a><a href="http://tengj.top/2017/02/22/idea1-1/?hmsr=toutiao.io&amp;utm_medium=toutiao.io&amp;utm_source=toutiao.io" target="_blank" rel="noopener">官方教程</a></h2><h2 id="推荐插件"><a href="#推荐插件" class="headerlink" title="推荐插件"></a>推荐插件</h2><blockquote><p>Alibaba Cloud AI Coding Assistant<br>Alibaba Java Coding Guidelines/CheckStyle/SonarLint<br>Codeium/CodeGeex/通意灵码<br>DubboTest<br>Lombok<br>MybatisX<br>Maven Helper<br>Monokai Pro Theme/Material Theme UI<br>PlantUML integration<br>Rainbow Brackets<br>RestfulTool<br>Save Actions<br>String Manipulation<br>Tabnine</p></blockquote><h2 id="外部推荐列表"><a href="#外部推荐列表" class="headerlink" title="外部推荐列表"></a>外部推荐列表</h2><blockquote><p><a href="https://mp.weixin.qq.com/s/zyIKY0Bc7DXic7kQN-zuRA" target="_blank" rel="noopener">插件01</a><br><a href="https://mp.weixin.qq.com/s/nyn9gDfRmSb_WVOv7atEHA" target="_blank" rel="noopener">插件02</a><br><a href="https://www.jianshu.com/p/d7282aec7665" target="_blank" rel="noopener">插件03</a><br><a href="https://mp.weixin.qq.com/s/xMwGAL_7sGkmnFvWZroVPw" target="_blank" rel="noopener">插件04</a><br><a href="https://mp.weixin.qq.com/s/sDdMHgVPPaoRsnzp3ZFqEA" target="_blank" rel="noopener">插件05</a></p></blockquote><h2 id="技巧拾遗"><a href="#技巧拾遗" class="headerlink" title="技巧拾遗"></a>技巧拾遗</h2><p><a href="https://blog.csdn.net/linsongbin1/article/details/80560332?hmsr=toutiao.io&amp;utm_medium=toutiao.io&amp;utm_source=toutiao.io" target="_blank" rel="noopener">推荐01</a></p><h2 id="Eval-Reset过期无法启动IDE"><a href="#Eval-Reset过期无法启动IDE" class="headerlink" title="Eval Reset过期无法启动IDE"></a>Eval Reset过期无法启动IDE</h2><p>删除<code>C:\Users\****\AppData\Roaming\JetBrains\GoLand2021.2\eval</code>中文件即可<br>对于mac, 其地址是<code>~/Library/Application Support/JetBrains/GoLand2021.2/eval</code></p><h2 id="licence"><a href="#licence" class="headerlink" title="licence"></a><a href="https://jetbra.in/s" target="_blank" rel="noopener">licence</a></h2><h2 id="关闭参数提示"><a href="#关闭参数提示" class="headerlink" title="关闭参数提示"></a><a href="https://zhuanlan.zhihu.com/p/53931299" target="_blank" rel="noopener">关闭参数提示</a></h2><p><a href="https://www.cnblogs.com/wangyinlon/p/14472415.html" target="_blank" rel="noopener">Rider</a></p>]]></content>
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Editor </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Sublime Text 杂记</title>
      <link href="/2017/06/19/st-note/"/>
      <url>/2017/06/19/st-note/</url>
      <content type="html"><![CDATA[<h1 id="官网"><a href="#官网" class="headerlink" title="官网"></a><a href="https://www.sublimetext.com/" target="_blank" rel="noopener">官网</a></h1><h1 id="Install-Package-Controll"><a href="#Install-Package-Controll" class="headerlink" title="Install Package Controll"></a><a href="https://packagecontrol.io/installation" target="_blank" rel="noopener">Install Package Controll</a></h1><p>Ctrl + ` 然后输入<a id="more"></a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import urllib.request,os,hashlib; h = pf2297e1a458f27d836c04bb0cbaf282&apos; + &apos;d0e7a3098092775ccb37ca9d6b2e4b7d&apos;; pf = &apos;Package Control.sublime-package&apos;; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); by = urllib.request.urlopen( &apos;http://packagecontrol.io/&apos; + pf.replace(&apos; &apos;, &apos;%20&apos;)).read(); dh = hashlib.sha256(by).hexdigest(); print(&apos;Error validating download (got %s instead of %s), please try manual install&apos; % (dh, h)) if dh != h else open(os.path.join( ipp, pf), &apos;wb&apos; ).write(by)</span><br></pre></td></tr></table></figure></p><h1 id="Package-List"><a href="#Package-List" class="headerlink" title="Package List"></a><a href="https://blog.csdn.net/qq_29819449/article/details/80130327" target="_blank" rel="noopener">Package List</a></h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;bootstrapped&quot;: true,</span><br><span class="line">    &quot;in_process_packages&quot;:</span><br><span class="line">    [</span><br><span class="line">    ],</span><br><span class="line">    &quot;installed_packages&quot;:</span><br><span class="line">    [</span><br><span class="line">        &quot;A File Icon&quot;,</span><br><span class="line">        &quot;Alignment&quot;,</span><br><span class="line">        &quot;All Autocomplete&quot;,</span><br><span class="line">        &quot;Anaconda&quot;,</span><br><span class="line">        &quot;AutoFileName&quot;,</span><br><span class="line">        &quot;Boxy Theme&quot;,</span><br><span class="line">        &quot;C Improved&quot;,</span><br><span class="line">        &quot;CodeFormatter&quot;,</span><br><span class="line">        &quot;ConvertToUTF8&quot;,</span><br><span class="line">        &quot;DocBlockr&quot;,</span><br><span class="line">        &quot;Emmet&quot;,</span><br><span class="line">        &quot;Git&quot;,</span><br><span class="line">        &quot;HTML-CSS-JS Prettify&quot;,</span><br><span class="line">        &quot;JavaScript Completions&quot;,</span><br><span class="line">        &quot;JavaScript Refactor&quot;,</span><br><span class="line">        &quot;JavaScriptNext - ES6 Syntax&quot;,</span><br><span class="line">        &quot;Markdown Extended&quot;,</span><br><span class="line">        &quot;Markdown Preview&quot;,</span><br><span class="line">        &quot;Monokai Extended&quot;,</span><br><span class="line">        &quot;Monokai Pro&quot;,</span><br><span class="line">        &quot;Package Control&quot;,</span><br><span class="line">        &quot;PackageResourceViewer&quot;,</span><br><span class="line">        &quot;SideBarEnhancements&quot;,</span><br><span class="line">        &quot;SublimeAStyleFormatter&quot;,</span><br><span class="line">        &quot;SublimeCodeIntel&quot;,</span><br><span class="line">        &quot;SublimeGDB&quot;,</span><br><span class="line">        &quot;SublimeLinter&quot;,</span><br><span class="line">        &quot;SublimeLinter-eslint&quot;,</span><br><span class="line">        &quot;SublimeLinter-gcc&quot;,</span><br><span class="line">        &quot;SublimeLinter-pylint&quot;,</span><br><span class="line">        &quot;Sync Settings&quot;,</span><br><span class="line">        &quot;Terminal&quot;,</span><br><span class="line">        &quot;Vuejs Complete Package&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Settings"><a href="#Settings" class="headerlink" title="Settings"></a><a href="https://scotch.io/bar-talk/best-sublime-text-3-themes-of-2015-and-2016" target="_blank" rel="noopener">Settings</a></h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;caret_extra_top&quot; : 1,</span><br><span class="line">    &quot;caret_extra_bottom&quot; : 1 ,</span><br><span class="line">    &quot;caret_extra_width&quot; : 1,</span><br><span class="line">    &quot;highlight_line&quot;: true,</span><br><span class="line">    &quot;color_scheme&quot;: &quot;Packages/Boxy Theme/schemes/Boxy Monokai.tmTheme&quot;,</span><br><span class="line">    &quot;folder_exclude_patterns&quot;:</span><br><span class="line">    [</span><br><span class="line">        &quot;node_modules&quot;,</span><br><span class="line">        &quot;.git&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;font_face&quot;: &quot;Source Code Pro&quot;,</span><br><span class="line">    &quot;font_size&quot;: 11,</span><br><span class="line">    &quot;ignored_packages&quot;:</span><br><span class="line">    [</span><br><span class="line">        &quot;Vintage&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;tab_size&quot;: 4,</span><br><span class="line">    &quot;theme&quot;: &quot;Boxy Monokai.sublime-theme&quot;,</span><br><span class="line">    &quot;theme_sidebar_close_always_visible&quot;: true,</span><br><span class="line">    &quot;theme_sidebar_folder_mono&quot;: true,</span><br><span class="line">    &quot;theme_sidebar_font_md&quot;: true,</span><br><span class="line">    &quot;theme_sidebar_indent_md&quot;: true,</span><br><span class="line">    &quot;theme_sidebar_size_xs&quot;: true,</span><br><span class="line">    &quot;translate_tabs_to_spaces&quot;: true,</span><br><span class="line">    &quot;trim_automatic_white_space&quot;: true,</span><br><span class="line">    &quot;trim_trailing_white_space_on_save&quot;: true,</span><br><span class="line">    &quot;word_wrap&quot;: true,</span><br><span class="line"></span><br><span class="line">    &quot;always_show_minimap_viewport&quot;: true,</span><br><span class="line">    &quot;bold_folder_labels&quot;: true,</span><br><span class="line">    &quot;caret_extra_bottom&quot;: 1,</span><br><span class="line">    &quot;caret_extra_top&quot;: 1,</span><br><span class="line">    &quot;caret_extra_width&quot;: 1,</span><br><span class="line">    &quot;caret_style&quot;: &quot;blink&quot;,</span><br><span class="line">    &quot;fade_fold_buttons&quot;: false,</span><br><span class="line">    &quot;indent_guide_options&quot;: [&quot;draw_normal&quot;, &quot;draw_active&quot;],</span><br><span class="line">    &quot;line_padding_bottom&quot;: 2,</span><br><span class="line">    &quot;line_padding_top&quot;: 2,</span><br><span class="line">    &quot;overlay_scroll_bars&quot;: &quot;enabled&quot;,</span><br><span class="line">    &quot;show_encoding&quot;: true,</span><br><span class="line">    &quot;show_line_endings&quot;: true,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Key-bindings"><a href="#Key-bindings" class="headerlink" title="Key bindings"></a>Key bindings</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">[&#123;</span><br><span class="line">    &quot;keys&quot;: [&quot;alt+shift+l&quot;],</span><br><span class="line">    &quot;command&quot;: &quot;reveal_in_side_bar&quot;</span><br><span class="line">&#125;, &#123;</span><br><span class="line">    &quot;keys&quot;: [&quot;ctrl+up&quot;],</span><br><span class="line">    &quot;command&quot;: &quot;scroll_lines&quot;,</span><br><span class="line">    &quot;args&quot;: &#123;</span><br><span class="line">        &quot;amount&quot;: 1.0</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, &#123;</span><br><span class="line">    &quot;keys&quot;: [&quot;ctrl+down&quot;],</span><br><span class="line">    &quot;command&quot;: &quot;scroll_lines&quot;,</span><br><span class="line">    &quot;args&quot;: &#123;</span><br><span class="line">        &quot;amount&quot;: -1.0</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, &#123;</span><br><span class="line">    &quot;keys&quot;: [&quot;ctrl+shift+r&quot;],</span><br><span class="line">    &quot;command&quot;: &quot;goto_symbol_in_project&quot;</span><br><span class="line">&#125;, &#123;</span><br><span class="line">    &quot;keys&quot;: [&quot;f12&quot;],</span><br><span class="line">    &quot;command&quot;: &quot;goto_definition&quot;</span><br><span class="line">&#125;, &#123;</span><br><span class="line">    &quot;keys&quot;: [&quot;ctrl+shift+b&quot;],</span><br><span class="line">    &quot;command&quot;: &quot;exec&quot;,</span><br><span class="line">    &quot;args&quot;: &#123;</span><br><span class="line">        &quot;kill&quot;: true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, &#123;</span><br><span class="line">    &quot;keys&quot;: [&quot;ctrl+shift+p&quot;],</span><br><span class="line">    &quot;command&quot;: &quot;show_overlay&quot;,</span><br><span class="line">    &quot;args&quot;: &#123;</span><br><span class="line">        &quot;overlay&quot;: &quot;command_palette&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, &#123;</span><br><span class="line">    &quot;keys&quot;: [&quot;ctrl+alt+a&quot;],</span><br><span class="line">    &quot;command&quot;: &quot;alignment&quot;</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure><h1 id="Syncing"><a href="#Syncing" class="headerlink" title="Syncing"></a><a href="https://packagecontrol.io/docs/syncing" target="_blank" rel="noopener">Syncing</a></h1><p><a href="https://github.com/mfuentesg/SyncSettings" target="_blank" rel="noopener">SyncSettings</a><br>sublimetext-setting-sync: 4aa2924362f38fedc957925a8b9fc4ab34e06546<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;access_token&quot;: &quot;4aa2924362f38fedc957925a8b9fc4ab34e06546&quot;,</span><br><span class="line">    &quot;auto_upgrade&quot;: false,</span><br><span class="line">    &quot;excluded_files&quot;:</span><br><span class="line">    [</span><br><span class="line">        &quot;.dmg&quot;,</span><br><span class="line">        &quot;.DS_Store&quot;,</span><br><span class="line">        &quot;.DS_Store?&quot;,</span><br><span class="line">        &quot;.exe&quot;,</span><br><span class="line">        &quot;.Spotlight-V100&quot;,</span><br><span class="line">        &quot;.Trashes&quot;,</span><br><span class="line">        &quot;ehthumbs.db&quot;,</span><br><span class="line">        &quot;oscrypto-ca-bundle.crt&quot;,</span><br><span class="line">        &quot;SyncSettings.sublime-settings&quot;,</span><br><span class="line">        &quot;Package Control.cache&quot;,</span><br><span class="line">        &quot;Package Control.last-run&quot;,</span><br><span class="line">        &quot;Package Control.merged-ca-bundle&quot;,</span><br><span class="line">        &quot;Package Control.system-ca-bundle&quot;,</span><br><span class="line">        &quot;Package Control.user-ca-bundle&quot;,</span><br><span class="line">        &quot;Thumbs.db&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;gist_id&quot;: &quot;1da91ad492c51f0665622587c05cb0fa&quot;,</span><br><span class="line">    &quot;included_files&quot;:</span><br><span class="line">    [</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="Compile-amp-Debug-C-C"><a href="#Compile-amp-Debug-C-C" class="headerlink" title="Compile &amp; Debug C/C++"></a><a href="http://www.yalewoo.com/sublimegdb.html" target="_blank" rel="noopener">Compile &amp; Debug C/C++</a></h1><h2 id="安装cygwin64"><a href="#安装cygwin64" class="headerlink" title="安装cygwin64"></a>安装cygwin64</h2><p>新建Build System<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;shell_cmd&quot;: &quot;gcc -g *.c -std=c11 -g -Wall -o $&#123;file_base_name&#125;.sh&quot;</span><br><span class="line">    // &quot;shell_cmd&quot;: &quot;gcc -g *.c -std=c11 -g -Wall -o $&#123;file_base_name&#125;.sh &amp;&amp; start cmd /c \&quot;$&#123;file_path&#125;/$&#123;file_base_name&#125;.sh &amp; pause\&quot;&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="安装SublimeGDB"><a href="#安装SublimeGDB" class="headerlink" title="安装SublimeGDB"></a>安装SublimeGDB</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;workingdir&quot;: &quot;$&#123;folder:$&#123;file&#125;&#125;&quot;,</span><br><span class="line">    &quot;commandline&quot;: &quot;gdb --interpreter=mi ./$&#123;file_base_name&#125;.sh&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="License-4126"><a href="#License-4126" class="headerlink" title="License 4126"></a><a href="https://my.oschina.net/caijj/blog/5504770" target="_blank" rel="noopener">License 4126</a></h1><p>#00#<em>00</em><br><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">—– BEGIN LICENSE —–</span><br><span class="line">Mifeng User</span><br><span class="line">Single User License</span><br><span class="line">EA7E-1184812</span><br><span class="line">C0DAA9CD 6BE825B5 FF935692 1750523A</span><br><span class="line">EDF59D3F A3BD6C96 F8D33866 3F1CCCEA</span><br><span class="line">1C25BE4D 25B1C4CC 5110C20E 5246CC42</span><br><span class="line">D232C83B C99CCC42 0E32890C B6CBF018</span><br><span class="line">B1D4C178 2F9DDB16 ABAA74E5 95304BEF</span><br><span class="line">9D0CCFA9 8AF8F8E2 1E0A955E 4771A576</span><br><span class="line">50737C65 325B6C32 817DCB83 A7394DFA</span><br><span class="line">27B7E747 736A1198 B3865734 0B434AA5</span><br><span class="line">—— END LICENSE ——</span><br></pre></td></tr></table></figure></p>]]></content>
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Editor </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Win10笔记</title>
      <link href="/2017/06/16/win-note/"/>
      <url>/2017/06/16/win-note/</url>
      <content type="html"><![CDATA[<h1 id="Win10环境"><a href="#Win10环境" class="headerlink" title="Win10环境"></a>Win10环境</h1><h2 id="Win10-自定义样式"><a href="#Win10-自定义样式" class="headerlink" title="Win10 自定义样式"></a>Win10 自定义样式</h2><ul><li><a href="http://jingyan.baidu.com/article/47a29f24548575c01523996c.html" target="_blank" rel="noopener">修改Win10字体大小</a></li><li>修改Console字体<br><a href="http://www.it165.net/os/html/201505/12820.html" target="_blank" rel="noopener">http://www.it165.net/os/html/201505/12820.html</a><br><a href="http://www.cnblogs.com/nick357/p/3619327.html" target="_blank" rel="noopener">http://www.cnblogs.com/nick357/p/3619327.html</a><a id="more"></a></li></ul><h2 id="Windows类Mac应用"><a href="#Windows类Mac应用" class="headerlink" title="Windows类Mac应用"></a><a href="http://palmerye.online/%E5%A6%82%E4%BD%95%E5%9C%A8Windows%E4%B8%8B%E5%83%8FMac%E4%B8%80%E6%A0%B7%E4%BC%98%E9%9B%85%E5%BC%80%E5%8F%91/?hmsr=toutiao.io&amp;utm_medium=toutiao.io&amp;utm_source=toutiao.io" target="_blank" rel="noopener">Windows类Mac应用</a></h2><ul><li>MacType：更改Windows字体</li><li>Listary：类似于mac下的 Spotlight 进行搜索增强</li><li>Cmder：命令行增强</li><li>QTTabBar：文件浏览器增强</li></ul><h2 id="gpedit编辑组策略"><a href="#gpedit编辑组策略" class="headerlink" title="gpedit编辑组策略"></a>gpedit编辑组策略</h2><p>计算机配置 -&gt; 管理模块 -&gt; Windows组件 -&gt; Windows更新/Windows Defender防病毒程序</p><h2 id="UAC设置"><a href="#UAC设置" class="headerlink" title="UAC设置"></a>UAC设置</h2><p>msconfig -&gt; 工具 -&gt; 更改UAC设置</p><h2 id="更改git存储的密码"><a href="#更改git存储的密码" class="headerlink" title="更改git存储的密码"></a>更改git存储的密码</h2><p>控制面板 -&gt; 用户账户 -&gt; 凭证管理器 -&gt; Windows凭证 -&gt; 修改git相关的</p><h2 id="创建符号链接"><a href="#创建符号链接" class="headerlink" title="创建符号链接"></a>创建符号链接</h2><p><code>mklink /d linkpath targetpath</code></p><h2 id="去掉输入法图标"><a href="#去掉输入法图标" class="headerlink" title="去掉输入法图标"></a>去掉输入法图标</h2><p><a href="https://zhidao.baidu.com/question/2270388044762677588.html" target="_blank" rel="noopener">任务栏</a><br><a href="https://zhidao.baidu.com/question/756157282447550964.html?qbl=relate_question_0" target="_blank" rel="noopener">状态栏</a></p><h1 id="Win10软件"><a href="#Win10软件" class="headerlink" title="Win10软件"></a>Win10软件</h1><h2 id="Git-Bash替代CMD"><a href="#Git-Bash替代CMD" class="headerlink" title="Git Bash替代CMD"></a>Git Bash替代CMD</h2><p>设置GIT保存用户名密码，设置commit时候的编辑器<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global credential.helper winstore或者store</span><br><span class="line">$ git config --global core.editor notepad2或者vim</span><br></pre></td></tr></table></figure></p><p><a href="ttp://www.v2ex.com/t/154202" target="_blank" rel="noopener">打造完美GIT命令行环境</a><br>alias：在C:\Program Files\Git\etc\bash.bashrc中配置，使用的是linux风格的命令<br>vim: 在C:\Program Files\Git\etc\vimrc中配置<br><a href="https://www.cnblogs.com/xishuai/p/cmder-git-bash.html" target="_blank" rel="noopener">Cmder with GitBash</a></p><h2 id="Listary"><a href="#Listary" class="headerlink" title="Listary"></a>Listary</h2><p>ALT+L 启动Listary</p><h2 id="uTools"><a href="#uTools" class="headerlink" title="uTools"></a>uTools</h2><h2 id="WiseHotKey"><a href="#WiseHotKey" class="headerlink" title="WiseHotKey"></a>WiseHotKey</h2><p>ALT+<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">`: Typora/CLion</span><br><span class="line">1:</span><br><span class="line">2:</span><br><span class="line">3:</span><br><span class="line">4:</span><br><span class="line">5: </span><br><span class="line">Q: Zeal/Velocity/DevDocs</span><br><span class="line">W: GoLand/Android Studio</span><br><span class="line">E: Intellij IDEA/Eclipse</span><br><span class="line">R: PyCharm</span><br><span class="line">T: Console Emulator(cmder\vendor\conemu-maximus5\ConEmu64.exe)</span><br><span class="line">A: DingDing/Tim</span><br><span class="line">S: Sublime Text</span><br><span class="line">D: DataGrip</span><br><span class="line">F: Rider/Explorer/ConEmu64</span><br><span class="line">G: Xshell/Xftp</span><br><span class="line">Z: Pencil/VMware Workstation Pro</span><br><span class="line">X: WPS</span><br><span class="line">C: Chrome</span><br><span class="line">V: Visual Studio Code</span><br><span class="line">B: SumatraPDF/Acrobat Reader DC</span><br><span class="line">Y:</span><br><span class="line">U:</span><br><span class="line">I: Internet Download Manager</span><br><span class="line">O:</span><br><span class="line">P:</span><br><span class="line">H:</span><br><span class="line">J:</span><br><span class="line">K:</span><br><span class="line">N:</span><br><span class="line">M:</span><br></pre></td></tr></table></figure></p><p>Win+<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1: Explorer</span><br><span class="line">2: </span><br><span class="line">3: </span><br><span class="line">4: Remote Desktop Connection Manager(RDCman)</span><br><span class="line">5:</span><br></pre></td></tr></table></figure></p><h2 id="JetBrains"><a href="#JetBrains" class="headerlink" title="JetBrains"></a>JetBrains</h2><p><a href="https://www.cnblogs.com/Candies/p/10050831.html" target="_blank" rel="noopener">Crack Method</a></p><h2 id="安装MongoDB"><a href="#安装MongoDB" class="headerlink" title="安装MongoDB"></a><a href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-windows/" target="_blank" rel="noopener">安装MongoDB</a></h2><h2 id="安装Sublime-Text-3"><a href="#安装Sublime-Text-3" class="headerlink" title="安装Sublime Text 3"></a>安装Sublime Text 3</h2><p><a href="http://www.zhihu.com/question/40942248" target="_blank" rel="noopener">修改ST3侧边栏和Tab字体大小</a><br>Terminal Setting<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;terminal&quot;: &quot;C:\\cygwin64\\bin\\mintty.exe&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="Nginx-Windows-配置"><a href="#Nginx-Windows-配置" class="headerlink" title="Nginx Windows 配置"></a><a href="http://blog.csdn.net/huangxiangec/article/details/41597481" target="_blank" rel="noopener">Nginx Windows 配置</a></h2><p>nginx默认80端口，可在conf/nginx.conf中配置，如果80端口被占用（比如IIS），则会启动失败</p><h2 id="Global-NodeJS-Modules-Path"><a href="#Global-NodeJS-Modules-Path" class="headerlink" title="Global NodeJS Modules Path"></a>Global NodeJS Modules Path</h2><p>C:\Users\admin\AppData\Roaming\npm\node_modules</p><h2 id="IDM"><a href="#IDM" class="headerlink" title="IDM"></a><a href="https://greasyfork.org/zh-CN/scripts/418182-%E7%99%BE%E5%BA%A6%E7%BD%91%E7%9B%98%E7%AE%80%E6%98%93%E4%B8%8B%E8%BD%BD%E5%8A%A9%E6%89%8B-%E7%9B%B4%E9%93%BE%E4%B8%8B%E8%BD%BD%E5%A4%8D%E6%B4%BB%E7%89%88" target="_blank" rel="noopener">IDM</a></h2><p>default UA<br><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Mozilla/5.0 (Windows NT 6.1; Trident/7.0; rv:11.0) like Gecko</span><br></pre></td></tr></table></figure></p><h2 id="Hexo搭建博客"><a href="#Hexo搭建博客" class="headerlink" title="Hexo搭建博客"></a><a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo搭建博客</a></h2><p><a href="https://www.jianshu.com/p/13c0b3ca7c71" target="_blank" rel="noopener">安装nvm</a><br><a href="https://www.jianshu.com/p/68177749d33f" target="_blank" rel="noopener">部署问题</a><br>nodejs版本使用v12.14.0<br><a href="https://www.jianshu.com/p/09441e35a59f" target="_blank" rel="noopener">gitee博客</a><br><a href="https://icmyfuture.github.io/" target="_blank" rel="noopener">blog地址</a><br>文本仓库: <a href="https://gitee.com/icmyfuture/blog">https://gitee.com/icmyfuture/blog</a><br>博客仓库:<br>    <a href="https://gitee.com/icmyfuture/icmyfuture/pages">https://gitee.com/icmyfuture/icmyfuture/pages</a><br>    <a href="https://github.com/icmyfuture/icmyfuture.github.io" target="_blank" rel="noopener">https://github.com/icmyfuture/icmyfuture.github.io</a><br>github token: ghp_0ST55WR#3#jecPFk5aa8#MHL6TQ88q11gnTq 其中 <em>00</em>#00#<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git remote add github https://TOKEN@github.com/icmyfuture/icmyfuture.github.io.git</span><br><span class="line">$ git push -f github</span><br></pre></td></tr></table></figure></p><h2 id="允许其他机器ping"><a href="#允许其他机器ping" class="headerlink" title="允许其他机器ping"></a><a href="http://www.jb51.net/os/win10/300048.html" target="_blank" rel="noopener">允许其他机器ping</a></h2><h2 id="PHP-in-Win10"><a href="#PHP-in-Win10" class="headerlink" title="PHP in Win10"></a><a href="http://blog.csdn.net/fightvictory/article/details/51895828" target="_blank" rel="noopener">PHP in Win10</a></h2><h2 id="Windows-CLion-Cygwin"><a href="#Windows-CLion-Cygwin" class="headerlink" title="Windows CLion+Cygwin"></a><a href="http://blog.csdn.net/shouwangzhelv/article/details/54919235" target="_blank" rel="noopener">Windows CLion+Cygwin</a></h2><p>当遇到git commit 出现 input is not from a terminal错误时，需要从cygwin安装程序中为cygwin环境安装git，而不是使用windows环境的git<br><a href="http://blog.csdn.net/taanng/article/details/42216993" target="_blank" rel="noopener">apt-cyg安装其他包</a><br>使用地址 <a href="https://raw.githubusercontent.com/transcode-open/apt-cyg/master/apt-cyg" target="_blank" rel="noopener">https://raw.githubusercontent.com/transcode-open/apt-cyg/master/apt-cyg</a><br><a href="http://unitstep.net/blog/2009/05/16/open-cygwin-bash-shell-here/" target="_blank" rel="noopener">Cygwin here</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chere -i -t mintty</span><br></pre></td></tr></table></figure></p><h2 id="OpenVPN多连接"><a href="#OpenVPN多连接" class="headerlink" title="OpenVPN多连接"></a><a href="https://blog.rj-bai.com/post/79.html" target="_blank" rel="noopener">OpenVPN多连接</a></h2><p>将配置文件目录拷贝至 <code>C:\Program Files\OpenVPN\config\</code>，注意多个目录中得ovpn文件不能同名</p><h2 id="VS-2015-KEY"><a href="#VS-2015-KEY" class="headerlink" title="VS 2015 KEY"></a>VS 2015 KEY</h2><p>Visual Studio Professional 2015简体中文版（专业版）<br>KEY：HMGNV-WCYXV-X7G9W-YCX63-B98R2<br>Visual Studio Enterprise 2015简体中文版（企业版）<br>KEY：HM6NR-QXX7C-DFW2Y-8B82K-WTYJV</p><h2 id="VS-2019-KEY"><a href="#VS-2019-KEY" class="headerlink" title="VS 2019 KEY"></a>VS 2019 KEY</h2><p>Enterprise: BF8Y8-GN2QH-T84XB-QVY3B-RC4DF</p><h2 id="VS-Key-Required-问题"><a href="#VS-Key-Required-问题" class="headerlink" title="VS Key Required 问题"></a>VS Key Required 问题</h2><p>由 Visual Assist 插件引起，在VS快捷方式后加上 /safemode，启动VS后卸载或禁用VA插件</p><h2 id="VS2019-ASP-NET-MVC-4-App-Error"><a href="#VS2019-ASP-NET-MVC-4-App-Error" class="headerlink" title="VS2019 ASP.NET MVC 4 App Error"></a>VS2019 ASP.NET MVC 4 App Error</h2><p>CS0012: 类型“System.Object”在未被引用的程序集中定义。必须添加对程序集“netstandard, Version=2.0.0.0, Culture=neutral, PublicKeyToken=cc7b13ffcd2ddd51”的引用<br>Copied “C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework.NETFramework\v4.7.2\Facades\netstandard.dll” to your application bin directory</p><h2 id="VSCode-Settings-Sync"><a href="#VSCode-Settings-Sync" class="headerlink" title="VSCode Settings Sync"></a>VSCode Settings Sync</h2><p>安装vscode插件: Settings Sync<br>vscode-setting-sync: 460b55de988723f98b9e188b7285e0c4929d1866</p><h2 id="VSCode-Java-C-Bulid-amp-Debug-Setting"><a href="#VSCode-Java-C-Bulid-amp-Debug-Setting" class="headerlink" title="VSCode Java/C Bulid&amp;Debug Setting"></a>VSCode Java/C Bulid&amp;Debug Setting</h2><p>tasks.json<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;version&quot;: &quot;2.0.0&quot;,</span><br><span class="line">    &quot;tasks&quot;:</span><br><span class="line">    [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;label&quot;: &quot;Build Java&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;shell&quot;,</span><br><span class="line">            &quot;command&quot;: &quot;javac&quot;,</span><br><span class="line">            &quot;args&quot;: [</span><br><span class="line">                &quot;-g&quot;,</span><br><span class="line">                &quot;$pwd/jivan/src/*.java&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;label&quot;: &quot;Build C&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;shell&quot;,</span><br><span class="line">            &quot;command&quot;: &quot;gcc&quot;,</span><br><span class="line">            &quot;args&quot;: [</span><br><span class="line">                &quot;-g&quot;,</span><br><span class="line">                &quot;$pwd/civan/*.c&quot;,</span><br><span class="line">                &quot;-o&quot;,</span><br><span class="line">                &quot;$pwd/civan/main.sh&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;&#125;</span><br></pre></td></tr></table></figure></p><p>launch.json<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    // 使用 IntelliSense 了解相关属性。</span><br><span class="line">    // 悬停以查看现有属性的描述。</span><br><span class="line">    // 欲了解更多信息，请访问: https://go.microsoft.com/fwlink/?linkid=830388</span><br><span class="line">    &quot;version&quot;: &quot;0.2.0&quot;,</span><br><span class="line">    &quot;configurations&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot;: &quot;java (Launch)&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;java&quot;,</span><br><span class="line">            &quot;request&quot;: &quot;launch&quot;,</span><br><span class="line">            &quot;cwd&quot;: &quot;$&#123;workspaceFolder&#125;&quot;,</span><br><span class="line">            &quot;console&quot;: &quot;internalConsole&quot;,</span><br><span class="line">            &quot;stopOnEntry&quot;: false,</span><br><span class="line">            &quot;mainClass&quot;: &quot;Main&quot;,</span><br><span class="line">            &quot;classPaths&quot;: [</span><br><span class="line">                &quot;C:\\src\\git\\jivan\\src&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;sourcePaths&quot;: [&quot;$&#123;workspaceFolder&#125;/jivan/src&quot;],</span><br><span class="line">            &quot;args&quot;: &quot;&quot;,</span><br><span class="line">            &quot;preLaunchTask&quot;: &quot;Build Java&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot;: &quot;c (Launch)&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;cppdbg&quot;,</span><br><span class="line">            &quot;request&quot;: &quot;launch&quot;,</span><br><span class="line">            &quot;program&quot;: &quot;$&#123;workspaceFolder&#125;/CIvan/main.sh&quot;,</span><br><span class="line">            &quot;args&quot;: [],</span><br><span class="line">            &quot;stopAtEntry&quot;: false,</span><br><span class="line">            &quot;cwd&quot;: &quot;$&#123;workspaceFolder&#125;&quot;,</span><br><span class="line">            &quot;environment&quot;: [],</span><br><span class="line">            &quot;externalConsole&quot;: true,</span><br><span class="line">            &quot;MIMode&quot;: &quot;gdb&quot;,</span><br><span class="line">            &quot;miDebuggerPath&quot;: &quot;C:/cygwin64/bin/gdb.exe&quot;,</span><br><span class="line">            &quot;setupCommands&quot;: [</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;description&quot;: &quot;Enable pretty-printing for gdb&quot;,</span><br><span class="line">                    &quot;text&quot;: &quot;-enable-pretty-printing&quot;,</span><br><span class="line">                    &quot;ignoreFailures&quot;: true</span><br><span class="line">                &#125;</span><br><span class="line">            ],</span><br><span class="line">            &quot;preLaunchTask&quot;: &quot;Build C&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="MarkDown编辑器Yu-Writer"><a href="#MarkDown编辑器Yu-Writer" class="headerlink" title="MarkDown编辑器Yu Writer"></a>MarkDown编辑器<a href="https://ivarptr.github.io/yu-writer.site/" target="_blank" rel="noopener">Yu Writer</a></h2><h2 id="etcd"><a href="#etcd" class="headerlink" title="etcd"></a><a href="https://www.codenong.com/cs106193128/" target="_blank" rel="noopener">etcd</a></h2><h2 id="Quarkus"><a href="#Quarkus" class="headerlink" title="Quarkus"></a><a href="https://quarkus.io/get-started/" target="_blank" rel="noopener">Quarkus</a></h2><h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><p>windows 10</p><h4 id="jdk"><a href="#jdk" class="headerlink" title="jdk"></a>jdk</h4><p><a href="https://adoptopenjdk.net/" target="_blank" rel="noopener">openjdk11</a><br><a href="https://www.graalvm.org/" target="_blank" rel="noopener">graalvm</a><br><a href="https://blog.csdn.net/weixin_45813747/article/details/115310800" target="_blank" rel="noopener">jdk8_jk811_switch</a><br>GitBash 设置jdk快速切换<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ vim ~/.bashrc</span><br><span class="line"><span class="built_in">alias</span> j8=<span class="string">'export PATH="/c/Program Files/Java/jdk1.8.0_212/bin:$PATH"'</span></span><br><span class="line"><span class="built_in">alias</span> j11=<span class="string">'export PATH="/c/Program Files/AdoptOpenJDK/jdk-11.0.11.9-hotspot/bin:$PATH"'</span></span><br><span class="line"><span class="built_in">alias</span> j11g=</span><br><span class="line">:wq</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">source</span> ~/.bashrc</span><br><span class="line"></span><br><span class="line">$ j8</span><br><span class="line">$ java -version</span><br><span class="line"></span><br><span class="line">$ j11</span><br><span class="line">$ java -version</span><br></pre></td></tr></table></figure></p><h4 id="maven"><a href="#maven" class="headerlink" title="maven"></a>maven</h4><p><a href="https://maven.apache.org/download.cgi" target="_blank" rel="noopener">Maven</a><br><a href="https://www.cnblogs.com/wkrbky/p/6350334.html" target="_blank" rel="noopener">HowToInstall</a></p><h4 id="IDE"><a href="#IDE" class="headerlink" title="IDE"></a>IDE</h4><h5 id="vscode"><a href="#vscode" class="headerlink" title="vscode"></a>vscode</h5><p>install <code>quarkus</code> extension in <code>View &gt; Extensions</code></p><h5 id="IDEA"><a href="#IDEA" class="headerlink" title="IDEA"></a>IDEA</h5><p>install <code>quarkus tools</code> plugin in <code>Files &gt; Settings &gt; Plugins</code></p><h3 id="scaffold"><a href="#scaffold" class="headerlink" title="scaffold"></a>scaffold</h3><p><a href="https://code.quarkus.io/?g=cn.icmyfuture" target="_blank" rel="noopener">https://code.quarkus.io/?g=cn.icmyfuture</a></p><h3 id="debug"><a href="#debug" class="headerlink" title="debug"></a>debug</h3><p>IDEA debug by following <a href="http://www.kailing.pub/article/index/arcid/286.html" target="_blank" rel="noopener">this</a> or <a href="https://www.jetbrains.com/help/idea/quarkus.html#new-project" target="_blank" rel="noopener">this</a></p><h2 id="Docker-for-Windows"><a href="#Docker-for-Windows" class="headerlink" title="Docker for Windows"></a><a href="https://www.docker.com/products/docker-desktop" target="_blank" rel="noopener">Docker for Windows</a></h2><p><a href="https://blog.csdn.net/weixin_43792738/article/details/113845702" target="_blank" rel="noopener">参考</a><br><a href="https://blog.csdn.net/u010840685/article/details/117028793" target="_blank" rel="noopener">参考</a><br><a href="https://github.com/AliyunContainerService/k8s-for-docker-desktop" target="_blank" rel="noopener">k8s for docker desktop</a></p>]]></content>
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Windows </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Mac笔记</title>
      <link href="/2017/06/16/mac-note/"/>
      <url>/2017/06/16/mac-note/</url>
      <content type="html"><![CDATA[<h1 id="Mac环境"><a href="#Mac环境" class="headerlink" title="Mac环境"></a>Mac环境</h1><h2 id="设置root密码"><a href="#设置root密码" class="headerlink" title="设置root密码"></a>设置root密码</h2><p><code>sudo passwd root</code><br>当安装出现permission denied时候使用<code>sudo *</code>来执行<a id="more"></a></p><h2 id="安装brew"><a href="#安装brew" class="headerlink" title="安装brew"></a><a href="https://www.cnblogs.com/51fx/p/7004429.html" target="_blank" rel="noopener">安装brew</a></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</span><br></pre></td></tr></table></figure><p><a href="https://thief.one/2017/08/24/1/" target="_blank" rel="noopener">更换为国内源</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ brew install redis/zookeeper</span><br><span class="line">$ brew services start redis/zookeeper</span><br><span class="line">$ brew services list</span><br><span class="line">$ brew info redis</span><br></pre></td></tr></table></figure></p><p>安装gsed代替mac的sed<code>brew install gnu-sed</code></p><h2 id="设置alias"><a href="#设置alias" class="headerlink" title="设置alias"></a>设置alias</h2><p>vim ~/.bashrc （如果没有就创建）<br><code>alias gpull=&#39;git pull origin $1&#39;</code><br>vim ~/.bash_profile （如果没有就创建）<br>加入 <code>source ~/.bashrc</code></p><h2 id="安装iTerm2-Alfred-3-Onxy"><a href="#安装iTerm2-Alfred-3-Onxy" class="headerlink" title="安装iTerm2, Alfred 3, Onxy"></a>安装iTerm2, Alfred 3, Onxy</h2><ul><li><a href="https://www.jianshu.com/p/d4000cb0e324" target="_blank" rel="noopener">远程ssh连接(iterm2+sshpass+rz+sz)</a><br>远程机器上需要安装lrzsz(<code>yum install -y lrzsz</code>)，同时需要在连接远程ssh的profile上添加iterm trigger</li></ul><h2 id="VIM"><a href="#VIM" class="headerlink" title="VIM"></a><a href="http://macshuo.com/?tag=vim" target="_blank" rel="noopener">VIM</a></h2><ul><li>Mac下默认VIM的位置是/usr/share/vim</li><li><a href="http://www.vim.org/sources.php" target="_blank" rel="noopener">安装7.4</a></li></ul><h2 id="oh-my-zsh"><a href="#oh-my-zsh" class="headerlink" title="oh my zsh"></a>oh my zsh</h2><ul><li>查看macos已有的zsh版本：<code>$ zsh --version</code></li><li>安装<br><code>curl -L https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh | sh</code><br>安装后使用zsh需要手工执行 zsh，如果需要设置为默认的shell，还需要用个命令chsh -s $(which zsh)</li><li><a href="http://stackoverflow.com/questions/453236/how-to-set-my-default-shell-on-mac" target="_blank" rel="noopener">Set default shell on Mac</a></li><li><a href="http://yijiebuyi.com/blog/b9b5e1ebb719f22475c38c4819ab8151.html" target="_blank" rel="noopener">配置zsh</a></li><li><p>zsh插件：<a href="https://github.com/wting/autojump" target="_blank" rel="noopener">autojump</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ brew install autojump</span><br><span class="line">$ brew info autojump # 查看配置方法</span><br></pre></td></tr></table></figure></li><li><p><a href="http://blog.richardweitech.cn/2018/07/01/use-zsh/?hmsr=toutiao.io&amp;utm_medium=toutiao.io&amp;utm_source=toutiao.io" target="_blank" rel="noopener">zsh概述+插件</a></p></li><li>自动更新<br>$ upgrade_oh_my_zsh</li></ul><h2 id="拷贝音乐至iPod"><a href="#拷贝音乐至iPod" class="headerlink" title="拷贝音乐至iPod"></a>拷贝音乐至iPod</h2><ul><li>itunes中，文件-添加到资料库…，然后添加文件夹/文件到资料库</li><li>音乐播放列表中，新建播放列表</li><li>在资料库-最近添加中，选中需要添加到播放列表的音乐，右键-添加到播放列表</li><li>连接iPod至Mac，拖动播放列表到 设备-iPod名称 即可将整个播放列表拷贝至iPod</li></ul><h2 id="钥匙串访问"><a href="#钥匙串访问" class="headerlink" title="钥匙串访问"></a>钥匙串访问</h2><p>在<code>密码</code>中可更改git等相关密码</p><h1 id="iPad软件"><a href="#iPad软件" class="headerlink" title="iPad软件"></a>iPad软件</h1><h2 id="App列表"><a href="#App列表" class="headerlink" title="App列表"></a>App列表</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">爱思助手</span><br><span class="line">APlayer</span><br><span class="line">MarginNote2</span><br><span class="line">围棋cnvcs</span><br></pre></td></tr></table></figure><h1 id="Mac软件"><a href="#Mac软件" class="headerlink" title="Mac软件"></a>Mac软件</h1><h2 id="App列表-1"><a href="#App列表-1" class="headerlink" title="App列表"></a>App列表</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">百度网盘</span><br><span class="line">钉钉</span><br><span class="line">搜狗输入法</span><br><span class="line">腾讯QQ/微信/TIM</span><br><span class="line">网易云音乐</span><br><span class="line">网易有道词典</span><br><span class="line">全能解压</span><br><span class="line">Alfred3/uTools/Raycast</span><br><span class="line">Android Studio</span><br><span class="line">Aria2GUI+BaiduExplorer.crx</span><br><span class="line">Arthas</span><br><span class="line">Beyond Compare</span><br><span class="line">Charles</span><br><span class="line">ClashX</span><br><span class="line">CleanMyMac X</span><br><span class="line">CodeRunner2</span><br><span class="line">Cursor</span><br><span class="line">Dash</span><br><span class="line">DataGrip</span><br><span class="line">Dr.Cleaner Pro</span><br><span class="line">Due</span><br><span class="line">FileZilla</span><br><span class="line">Git</span><br><span class="line">Google Chrome</span><br><span class="line">He3</span><br><span class="line">IntelliJ IDEA</span><br><span class="line">iTerm2</span><br><span class="line">MAT</span><br><span class="line">MindNode</span><br><span class="line">MWeb</span><br><span class="line">Navicat Premium Lite</span><br><span class="line">Neat Download Manager</span><br><span class="line">New File Menu</span><br><span class="line">Noizio</span><br><span class="line">Office 2016</span><br><span class="line">Omni Group(Focus/Graffle/Plan/Presence/Outliner)</span><br><span class="line">OpenEmu</span><br><span class="line">Parallels Desktop</span><br><span class="line">Paste</span><br><span class="line">Paw</span><br><span class="line">Pencil</span><br><span class="line">PDF Professional</span><br><span class="line">PyCharm</span><br><span class="line">RDM(Redis Desktop Manager)/Medis</span><br><span class="line">Remote Desktop Manager</span><br><span class="line">Robo 3T</span><br><span class="line">SafeConnect</span><br><span class="line">Shortcat</span><br><span class="line">SizeUp</span><br><span class="line">Sketch</span><br><span class="line">Thor Launcher/Snap/Monico</span><br><span class="line">Transmit</span><br><span class="line">SourceTree</span><br><span class="line">Sublime Text</span><br><span class="line">Tunnelblick</span><br><span class="line">Typora</span><br><span class="line">uPic</span><br><span class="line">V2rayU</span><br><span class="line">Visual Studio Code</span><br><span class="line">WinRAR</span><br><span class="line">Wireshark</span><br><span class="line">WPS Office</span><br><span class="line">XMind</span><br><span class="line">YesPlayMusic</span><br></pre></td></tr></table></figure><ul><li>mac 中提示应用“已损坏，打不开” 是因为在系统“通用”中没有选择“任何来源”<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo spctl --master-disable/master-enable 显示/隐藏&apos;任何来源&apos;选项</span><br></pre></td></tr></table></figure></li></ul><h2 id="Snap-ThorLauncher-Manual"><a href="#Snap-ThorLauncher-Manual" class="headerlink" title="Snap/ThorLauncher Manual"></a>Snap/ThorLauncher Manual</h2><p>ALT+<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">`: Launchpad/TIM</span><br><span class="line">1: Typora/YesPlayMusic/Win-Explorer</span><br><span class="line">2: Paw/Win-GitBash</span><br><span class="line">3: Rider/Win-VS2019</span><br><span class="line">4: Another Redis Desktop Manager/RDM/Win-RDCman</span><br><span class="line">5: Wechat</span><br><span class="line">6: </span><br><span class="line">7: </span><br><span class="line">8: </span><br><span class="line">9: </span><br><span class="line">0: </span><br><span class="line">Q: He3/Dash</span><br><span class="line">W: GoLand/Android Studio</span><br><span class="line">E: Intellij IDEA/Eclipse</span><br><span class="line">R: PyCharm</span><br><span class="line">T: iTerm2</span><br><span class="line">A: DingDing</span><br><span class="line">S: Sublime Text</span><br><span class="line">D: DBeaver/DataGrip/Navicat</span><br><span class="line">F: Finder</span><br><span class="line">G: Transmit/FileZilla</span><br><span class="line">Z: Pencil/Sketch</span><br><span class="line">X: WPS Office/Visual Studio/Safari/Parallels Desktop</span><br><span class="line">C: Chrome</span><br><span class="line">V: Visual Studio Code</span><br><span class="line">B: MarginNote 3/PDF Professional</span><br><span class="line">Y: </span><br><span class="line">U: </span><br><span class="line">I:</span><br><span class="line">O:</span><br><span class="line">P:</span><br><span class="line">H: </span><br><span class="line">J: </span><br><span class="line">K:</span><br><span class="line">L:</span><br><span class="line">N:</span><br><span class="line">M:</span><br></pre></td></tr></table></figure></p><h2 id="Charles-http-https-手机抓包设置"><a href="#Charles-http-https-手机抓包设置" class="headerlink" title="Charles http/https 手机抓包设置"></a>Charles http/https 手机抓包设置</h2><p>Proxy -&gt; Proxy Setting…<br>    Enable transparent HTTP proxying, Port:8888<br>    Enbale macOS proxy, Use HTTP Proxy<br>Help -&gt; SSL Proxying<br>    Install Charles Root Certificate 若证书为红色，则打开证书后选择‘始终信任’<br>    Install Charles Root Certificate on a Mobile…<br>Proxy -&gt; SSL Proxy Settings -&gt; Add <code>Host:*, Port:443</code></p><h2 id="网易云音乐日志文件"><a href="#网易云音乐日志文件" class="headerlink" title="网易云音乐日志文件"></a>网易云音乐日志文件</h2><p>/Users/yzw/library/Containers/com.netease.163music/Data/Documents/storage/logs/music.163.log</p><h2 id="Office-2016"><a href="#Office-2016" class="headerlink" title="Office 2016"></a><a href="http://www.xixisoft.cn/forum.php?mod=viewthread&amp;tid=19859&amp;extra=page%3D1&amp;page=1" target="_blank" rel="noopener">Office 2016</a></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vip1702@office2016.red D**m***4**</span><br></pre></td></tr></table></figure><h2 id="Dr-Cleaner"><a href="#Dr-Cleaner" class="headerlink" title="Dr.Cleaner"></a>Dr.Cleaner</h2><h2 id="Xcode"><a href="#Xcode" class="headerlink" title="Xcode"></a>Xcode</h2><h2 id="Parallel-Desktop"><a href="#Parallel-Desktop" class="headerlink" title="Parallel Desktop"></a>Parallel Desktop</h2><p>推荐使用共享网络，但如果虚拟机之间需要根据旧有IP互相访问(例如从VirtualBox迁移过来)，则可以自行配置一个HostOnly网络。例如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">起始地址：192.168.56.101</span><br><span class="line">结束地址：192.168.56.254</span><br><span class="line">子网掩码：255.255.255.0</span><br></pre></td></tr></table></figure></p><h2 id="SublimeText-3"><a href="#SublimeText-3" class="headerlink" title="SublimeText 3"></a>SublimeText 3</h2><ul><li><a href="http://www.cnblogs.com/zuike/p/4402022.html" target="_blank" rel="noopener">进入VIM模式</a></li><li>安装插件<br>Old<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">* Package Control/SidebarEnhancement/GIT</span><br><span class="line">* Terminal</span><br><span class="line">&#123;</span><br><span class="line">    &quot;teminal&quot;: &quot;iTerm2-v3.sh&quot;,</span><br><span class="line">    &quot;parameters&quot;: [&quot;--open-in-tab&quot;]</span><br><span class="line">&#125;</span><br><span class="line">* Theme SoDaReloaded/Inspired Github Color Schema</span><br><span class="line">* CodeFormatter</span><br><span class="line">* HTML5/CSS3</span><br><span class="line">* JavascriptNext/Node Completions/Javascript Completions/Vuejs Complete Packages</span><br><span class="line">* SublimeCodeIntel/Emmet（已删除Emmet）</span><br><span class="line">[pyv8无法loading的解决方法](http://uedethan.com/resolve-mac-sublime-text3-because-pyv8-unable-to-load-cause-emmet-unavailable-problems/)</span><br><span class="line">* SublimeLinter/SublimeLinter-contrib-eslint</span><br><span class="line">必须先安装eslint：`sudo npm install -g eslint`</span><br><span class="line">eslint-plugin-html: `sudo npm install -g eslint-plugin-html`</span><br><span class="line">* C Improved</span><br></pre></td></tr></table></figure></li></ul><p>New<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* A File Icon</span><br><span class="line">* Anaconda</span><br><span class="line">* Boxy Theme</span><br><span class="line">* CodeFormatter</span><br><span class="line">* Fix Mac Path</span><br><span class="line">* Package Control</span><br><span class="line">* Scheme</span><br><span class="line">* SublimeREPL</span><br><span class="line">* Terminal</span><br></pre></td></tr></table></figure></p><ul><li><a href="https://blog.csdn.net/afanyusong/article/details/51085258" target="_blank" rel="noopener">SublimeText3 Python开发环境设置</a><br>其中Anaconda的设置如下<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;python_interpreter&quot;: &quot;/usr/local/bin/python3&quot;,</span><br><span class="line">    &quot;suppress_word_completions&quot;: true,</span><br><span class="line">    &quot;suppress_explicit_completions&quot;: true,</span><br><span class="line">    &quot;complete_parameters&quot;: true,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>Python3的BuildSystem设置如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;cmd&quot;: [&quot;/usr/local/bin/python3&quot;,&quot;-u&quot;,&quot;$file&quot;],</span><br><span class="line">    &quot;file_regex&quot;: &quot;^[ ]*File \&quot;(...*?)\&quot;, line ([0-9]*)&quot;,</span><br><span class="line">    &quot;selector&quot;: &quot;source.python&quot;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>SublimeREPL的python默认是python2，所以需要新建一个python3的目录<br>位置是：Browse Package…-&gt;SublimeREPL<br>拷贝Python目录为Python3，修改Main.sublime-menu的内容，将顶层caption改为Python3，同时注意将所有<code>id</code>,<code>external_id</code>以及<code>cmd</code>的python更改为python3即可。</p><p><a href="https://stackoverflow.com/questions/38939557/how-to-open-the-iterm-in-the-sublime-text-3/43647381" target="_blank" rel="noopener">Terminal配置iTerm2</a></p><h2 id="安装node并设置使用淘宝镜像"><a href="#安装node并设置使用淘宝镜像" class="headerlink" title="安装node并设置使用淘宝镜像"></a>安装node并设置使用淘宝镜像</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm config set registry https://registry.npm.taobao.org</span><br><span class="line">$ npm info underscore （如果上面配置正确这个命令会有字符串response）</span><br></pre></td></tr></table></figure><h2 id="NET-Core（安装后需要重启MacOS）"><a href="#NET-Core（安装后需要重启MacOS）" class="headerlink" title=".NET Core（安装后需要重启MacOS）"></a><a href="https://www.microsoft.com/net/core#macos" target="_blank" rel="noopener">.NET Core</a>（安装后需要重启MacOS）</h2><ul><li><p>DotNetCore 发布<br>发布之前，必须确保 gulp 与 bower已被正确安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo npm install -g bower</span><br><span class="line">$ sudo npm install -g gulp</span><br><span class="line">$ dotnet publish</span><br></pre></td></tr></table></figure></li><li><p><a href="http://www.liuchungui.com/blog/2016/05/10/mac10-dot-11sheng-ji-an-zhuang-openssl/" target="_blank" rel="noopener">更新mac的openssl</a> （推荐使用软连接的方式，需要重启）</p></li><li>建立软连接<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ln -s /usr/local/Cellar/openssl/1.0.2h_1/lib/libcrypto.1.0.0.dylib /usr/local/lib/libcrypto.1.0.0.dylib</span><br><span class="line">$ ln -s /usr/local/Cellar/openssl/1.0.2h_1/lib/libssl.1.0.0.dylib /usr/local/lib/libssl.1.0.0.dylibk1</span><br></pre></td></tr></table></figure></li></ul><h2 id="Dash"><a href="#Dash" class="headerlink" title="Dash"></a>Dash</h2><h2 id="Java开发环境搭建"><a href="#Java开发环境搭建" class="headerlink" title="Java开发环境搭建"></a>Java开发环境搭建</h2><h3 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h3><ul><li><a href="http://www.oracle.com/technetwork/java/javase/downloads/java-archive-downloads-javase7-521261.html" target="_blank" rel="noopener">JDK 1.7</a></li><li><a href="http://www.cnblogs.com/iOS-mt/p/5726380.html" target="_blank" rel="noopener">环境变量</a></li><li>mac下查看java信息：<code>/usr/libexec/java_home -V</code></li></ul><h3 id="Eclipse"><a href="#Eclipse" class="headerlink" title="Eclipse"></a><a href="https://www.eclipse.org/downloads/packages/eclipse-ide-java-ee-developers/mars2" target="_blank" rel="noopener">Eclipse</a></h3><h3 id="Maven"><a href="#Maven" class="headerlink" title="Maven"></a><a href="http://www.jianshu.com/p/c25fe3c53506" target="_blank" rel="noopener">Maven</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ brew install maven</span><br><span class="line"># 查看maven安装位置</span><br><span class="line">$ brew info maven</span><br></pre></td></tr></table></figure><p>修改为阿里云镜像库<br>位置：/usr/local/Cellar/maven/3.5.3/libexec/conf/settings.xml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;mirrors&gt;</span><br><span class="line">  &lt;mirror&gt;</span><br><span class="line">    &lt;id&gt;alimaven&lt;/id&gt;</span><br><span class="line">    &lt;name&gt;aliyun maven&lt;/name&gt;</span><br><span class="line">    &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;/url&gt;</span><br><span class="line">    &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;</span><br><span class="line">  &lt;/mirror&gt;</span><br><span class="line">&lt;/mirrors&gt;</span><br></pre></td></tr></table></figure></p><h2 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a><a href="https://dev.mysql.com/downloads/mysql/" target="_blank" rel="noopener">MySQL</a></h2><ul><li><a href="http://blog.csdn.net/jia611/article/details/51553067" target="_blank" rel="noopener">重置mysql root密码</a></li><li><a href="http://blog.csdn.net/chszs/article/details/50651264" target="_blank" rel="noopener">密码过期策略</a></li></ul><h2 id="Tomcat"><a href="#Tomcat" class="headerlink" title="Tomcat"></a><a href="http://www.imooc.com/article/6453" target="_blank" rel="noopener">Tomcat</a></h2><h2 id="Navicat"><a href="#Navicat" class="headerlink" title="Navicat"></a><a href="http://blog.csdn.net/yf814359680/article/details/51276546" target="_blank" rel="noopener">Navicat</a></h2><h2 id="SmartSvn"><a href="#SmartSvn" class="headerlink" title="SmartSvn"></a><a href="https://blog.csdn.net/liuayng/article/details/70311844" target="_blank" rel="noopener">SmartSvn</a></h2><h2 id="Axure-8"><a href="#Axure-8" class="headerlink" title="Axure 8"></a><a href="https://www.cnblogs.com/exmyth/p/8560056.html" target="_blank" rel="noopener">Axure 8</a></h2><p>授权人: Koshy<br>密码:wTADPqxn3KChzJxLmUr5jTTitCgsfRkftQQ1yIG9HmK83MYSm7GPxLREGn+Ii6xY</p><h2 id="百度网盘不限速下载"><a href="#百度网盘不限速下载" class="headerlink" title="百度网盘不限速下载"></a><a href="https://bbs.feng.com/forum.php?mod=viewthread&amp;tid=11754059&amp;extra=&amp;page=1" target="_blank" rel="noopener">百度网盘不限速下载</a></h2><h2 id="Mac-iOS开发"><a href="#Mac-iOS开发" class="headerlink" title="Mac iOS开发"></a><a href="http://www.cnblogs.com/kenshincui/category/594479.html" target="_blank" rel="noopener">Mac iOS开发</a></h2><h2 id="hexo时无法访问github"><a href="#hexo时无法访问github" class="headerlink" title="hexo时无法访问github"></a><a href="https://blog.csdn.net/lord_y/article/details/98967139/" target="_blank" rel="noopener">hexo时无法访问github</a></h2><h2 id="Consul"><a href="#Consul" class="headerlink" title="Consul"></a><a href="https://www.cnblogs.com/niceyoo/p/14223158.html" target="_blank" rel="noopener">Consul</a></h2><h2 id="Quarkus"><a href="#Quarkus" class="headerlink" title="Quarkus"></a><a href="https://quarkus.io/get-started/" target="_blank" rel="noopener">Quarkus</a></h2><h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><h4 id="jdk"><a href="#jdk" class="headerlink" title="jdk"></a>jdk</h4><p><a href="https://adoptopenjdk.net/" target="_blank" rel="noopener">openjdk11</a><br><a href="https://www.graalvm.org/" target="_blank" rel="noopener">graalvm</a><br>安装native-image<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ j11g</span><br><span class="line">$ <span class="built_in">cd</span> <span class="variable">$JAVA_HOME</span>\bin</span><br><span class="line">$ ./gu install native-image</span><br></pre></td></tr></table></figure></p><p><a href="https://blog.csdn.net/renmengmeng520/article/details/112659017" target="_blank" rel="noopener">jdk8_jk811_switch</a><br>~/.zshrc中，设置环境变量与jdk切换别名<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.8.0_172.jdk/Contents/Home</span><br><span class="line"><span class="built_in">export</span> JAVA_8_HOME=/Library/Java/JavaVirtualMachines/jdk1.8.0_172.jdk/Contents/Home</span><br><span class="line"><span class="built_in">export</span> JAVA_11_HOME=/Library/Java/JavaVirtualMachines/jdk-11.0.2.jdk/Contents/Home</span><br><span class="line"><span class="built_in">export</span> GRAALVM_HOME=/Library/Java/JavaVirtualMachines/graalvm-ce-java11-21.1.0/Contents/Home</span><br><span class="line"></span><br><span class="line"><span class="built_in">alias</span> j8=<span class="string">'export JAVA_HOME=$JAVA_8_HOME'</span></span><br><span class="line"><span class="built_in">alias</span> j11=<span class="string">'export JAVA_HOME=$JAVA_11_HOME'</span></span><br><span class="line"><span class="built_in">alias</span> j11g=<span class="string">'export JAVA_HOME=$GRAALVM_HOME'</span></span><br></pre></td></tr></table></figure></p><h4 id="maven"><a href="#maven" class="headerlink" title="maven"></a>maven</h4><p><a href="https://maven.apache.org/download.cgi" target="_blank" rel="noopener">Maven</a><br><a href="https://www.cnblogs.com/Flat-White/p/14737549.html" target="_blank" rel="noopener">HowToInstall</a></p><h4 id="IDE"><a href="#IDE" class="headerlink" title="IDE"></a>IDE</h4><h5 id="vscode"><a href="#vscode" class="headerlink" title="vscode"></a>vscode</h5><p>install <code>quarkus</code> extension in <code>View &gt; Extensions</code></p><h5 id="IDEA"><a href="#IDEA" class="headerlink" title="IDEA"></a>IDEA</h5><p>install <code>quarkus tools</code> plugin in <code>Files &gt; Settings &gt; Plugins</code></p><h3 id="scaffold"><a href="#scaffold" class="headerlink" title="scaffold"></a>scaffold</h3><p><a href="https://code.quarkus.io/?g=cn.icmyfuture" target="_blank" rel="noopener">https://code.quarkus.io/?g=cn.icmyfuture</a></p><h3 id="debug"><a href="#debug" class="headerlink" title="debug"></a>debug</h3><p>IDEA debug by following <a href="http://www.kailing.pub/article/index/arcid/286.html" target="_blank" rel="noopener">this</a> or <a href="https://www.jetbrains.com/help/idea/quarkus.html#new-project" target="_blank" rel="noopener">this</a></p><h2 id="Docker-Desktop-for-Mac"><a href="#Docker-Desktop-for-Mac" class="headerlink" title="Docker Desktop for Mac"></a><a href="https://www.docker.com/products/docker-desktop" target="_blank" rel="noopener">Docker Desktop for Mac</a></h2><p><a href="https://blog.csdn.net/qq_29830577/article/details/115168648" target="_blank" rel="noopener">手动安装k8s</a></p><p>K8s<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ touch docker-images-k8s.sh</span><br><span class="line">$ vim docker-images-k8s.sh</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">set -e</span><br><span class="line">KUBE_VERSION=v1.19.7</span><br><span class="line">KUBE_PAUSE_VERSION=3.2</span><br><span class="line">ETCD_VERSION=3.4.13-0</span><br><span class="line">COREDNS_VERSION=1.7.0</span><br><span class="line">GCR_URL=k8s.gcr.io</span><br><span class="line">ALIYUN_URL=registry.cn-hangzhou.aliyuncs.com/google_containers</span><br><span class="line"></span><br><span class="line"># get images</span><br><span class="line">images=(kube-proxy:$&#123;KUBE_VERSION&#125;</span><br><span class="line">    kube-scheduler:$&#123;KUBE_VERSION&#125;</span><br><span class="line">    kube-controller-manager:$&#123;KUBE_VERSION&#125;</span><br><span class="line">    kube-apiserver:$&#123;KUBE_VERSION&#125;</span><br><span class="line">    pause:$&#123;KUBE_PAUSE_VERSION&#125;</span><br><span class="line">    etcd:$&#123;ETCD_VERSION&#125;</span><br><span class="line">    coredns:$&#123;COREDNS_VERSION&#125;)</span><br><span class="line"></span><br><span class="line">for imageName in $&#123;images[@]&#125; ; do</span><br><span class="line">    docker pull $ALIYUN_URL/$imageName</span><br><span class="line">    docker tag $ALIYUN_URL/$imageName $GCR_URL/$imageName</span><br><span class="line">    docker rmi $ALIYUN_URL/$imageName</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line"># show images</span><br><span class="line">docker images</span><br></pre></td></tr></table></figure><p>执行命令<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ chmod +x docker-images-k8s.sh</span><br><span class="line">$ ./docker-images-k8s.sh</span><br></pre></td></tr></table></figure></p><p>Dashboard<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ touch docker-images-dashboard.sh</span><br><span class="line">$ vim docker-images-dashboard.sh</span><br></pre></td></tr></table></figure></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> -e</span><br><span class="line">KUBE_DASHBOARD_VERSION=v2.0.3</span><br><span class="line">METRICS_SCRAPER=v1.0.4</span><br><span class="line">KUBENETESUI_URL=kubernetesui</span><br><span class="line">ALIYUN_KUBENETESUI_URL=registry.cn-hangzhou.aliyuncs.com/kubernetes_ns</span><br><span class="line"></span><br><span class="line"><span class="comment"># get images (ui)</span></span><br><span class="line">imagesui=(dashboard:<span class="variable">$&#123;KUBE_DASHBOARD_VERSION&#125;</span></span><br><span class="line">    metrics-scraper:<span class="variable">$&#123;METRICS_SCRAPER&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> imageName <span class="keyword">in</span> <span class="variable">$&#123;imagesui[@]&#125;</span> ; <span class="keyword">do</span></span><br><span class="line">    docker pull <span class="variable">$ALIYUN_KUBENETESUI_URL</span>/<span class="variable">$imageName</span></span><br><span class="line">    docker tag <span class="variable">$ALIYUN_KUBENETESUI_URL</span>/<span class="variable">$imageName</span> <span class="variable">$KUBENETESUI_URL</span>/<span class="variable">$imageName</span></span><br><span class="line">    docker rmi <span class="variable">$ALIYUN_KUBENETESUI_URL</span>/<span class="variable">$imageName</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># show images</span></span><br><span class="line">docker images</span><br></pre></td></tr></table></figure><p>执行命令<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ chmod +x docker-images-dashboard.sh</span><br><span class="line">$ ./docker-images-dashboard.sh</span><br></pre></td></tr></table></figure></p><p><a href="https://www.cnblogs.com/xinrong2019/p/14005905.html" target="_blank" rel="noopener">部署dashboard</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.0/aio/deploy/recommended.yaml</span><br><span class="line">$ kubectl proxy</span><br></pre></td></tr></table></figure></p><p><a href="http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy" target="_blank" rel="noopener">dashboard本地网址</a><br>添加k8s sa<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt;EOF | kubectl apply -f -</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: ServiceAccount</span><br><span class="line">metadata:</span><br><span class="line">  name: icmyfuture</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure></p><p>生成token<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl -n kubernetes-dashboard describe secret $(kubectl -n kubernetes-dashboard get secret | grep icmyfuture | awk <span class="string">'&#123;print $1&#125;'</span>)</span><br></pre></td></tr></table></figure></p><p>填写token至dashboard网页输入框<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJSUzI1NiIsImtpZCI6Img3QWpUeHBhWURYbi1CZWU5UkdFZmxWa0VPQ1JTa3Z5NUZiOFhRSkJzYVkifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlcm5ldGVzLWRhc2hib2FyZCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJpY215ZnV0dXJlLXRva2VuLXNyaDd2Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImljbXlmdXR1cmUiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiIwMzkyMzEzNy0xOTJkLTQ2MjAtODRlMC1lN2M2ZTU4NDI2YTUiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZXJuZXRlcy1kYXNoYm9hcmQ6aWNteWZ1dHVyZSJ9.RgT2iT4B7MGbJLX2B5SAtOcblDeqnrIbzAbQI1fo5dE7w5xPtRI3Z6viNSZzrRcz6cURTIIyPRb0IGxArIiHwBNCYNxr7JsaczBq2dHE_YiiFHU_E6Mi4IUYEpztQl_sfg8k01MNNBrMovyxABEDdWu0F8uLezlyiAdENlttJuMbVjrVeEZAyiKbtlQ92C770F6qQWWZk3ddKtfWdcHCG816dCdFNPF2xXR6wnbKnTU6C0_EWKvid-vPBuxQsh7fO8hvCAcW6OVTemNgerM0BmZzXRkjFWfBtbXmUfu8cHRhnePXKR7BbqXMP_Bx8cs4hgz_Y6LQqMIvFf2-_URHgg</span><br></pre></td></tr></table></figure></p><h2 id="Consul-1"><a href="#Consul-1" class="headerlink" title="Consul"></a><a href="https://www.consul.io/" target="_blank" rel="noopener">Consul</a></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ docker pull consul:latest</span><br><span class="line">$ docker run --name consul -d -p 8500:8500 consul</span><br></pre></td></tr></table></figure><p><a href="https://www.cnblogs.com/baby123/p/12710473.html" target="_blank" rel="noopener">参考</a></p><h2 id="Jaeger"><a href="#Jaeger" class="headerlink" title="Jaeger"></a><a href="https://www.jaegertracing.io/" target="_blank" rel="noopener">Jaeger</a></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ docker pull jaegertracing/all-in-one:latest</span><br><span class="line">$ docker run -d --name jaeger -e COLLECTOR_ZIPKIN_HTTP_PORT=9411 -p 5775:5775/udp -p 6831:6831/udp -p 6832:6832/udp -p 5778:5778 -p 16686:16686 -p 14268:14268 -p 9411:9411 jaegertracing/all-in-one:latest</span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/csdn_xpw/article/details/105543488" target="_blank" rel="noopener">参考</a></p><h2 id="macpro2021-m1"><a href="#macpro2021-m1" class="headerlink" title="macpro2021 m1"></a>macpro2021 m1</h2><p>关闭系统更新/appstroe更新提示<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">defaults write com.apple.systempreferences AttentionPrefBundleIDs 0</span><br><span class="line">Killall Dock</span><br><span class="line">defaults write com.apple.appstored BadgeCount 0</span><br><span class="line">Killall Dock</span><br></pre></td></tr></table></figure></p><p><a href="https://www.jetbrains.com/lp/mono/" target="_blank" rel="noopener">jetbrains mono</a><br><a href="http://www.neatdownloadmanager.com/index.php/en/" target="_blank" rel="noopener">neatdownloadmanager</a><br><a href="https://blog.csdn.net/junle_carpediem/article/details/125926375" target="_blank" rel="noopener">brew</a><br><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export PATH=/opt/homebrew/bin:$PATH </span><br><span class="line">export PATH=/opt/homebrew/sbin:$PATH</span><br></pre></td></tr></table></figure></p><p><a href="https://blog.csdn.net/qq_25404477/article/details/126102189" target="_blank" rel="noopener">brew install报错</a><br><a href="https://zhuanlan.zhihu.com/p/435518571" target="_blank" rel="noopener">iterm2+ohmyzsh</a><br><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install iterm2</span><br></pre></td></tr></table></figure></p><p><a href="https://www.jianshu.com/p/0244fc60b921" target="_blank" rel="noopener">cloc</a><br><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install cloc</span><br></pre></td></tr></table></figure></p><p><a href="http://t.zoukankan.com/laoxia-p-12611478.html" target="_blank" rel="noopener">gitlab ssh</a><br><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name "due"</span><br><span class="line">git config --global user.email "ivan.e.du@yzw.cn"</span><br></pre></td></tr></table></figure></p><p><a href="https://zhuanlan.zhihu.com/p/487793949" target="_blank" rel="noopener">.net sdk</a><br><a href="https://dotnet.microsoft.com/zh-cn/download/dotnet/5.0" target="_blank" rel="noopener">.net 5</a><br><a href="https://blog.csdn.net/qq_43175355/article/details/126001700" target="_blank" rel="noopener">m1 .net 5</a><br><a href="http://t.zoukankan.com/dm521-p-7223066.html" target="_blank" rel="noopener">卸载.net</a><br>[jetbrains rider]<br>[jetbrains idea]<br><a href="https://www.azul.com/downloads/?package=jdk" target="_blank" rel="noopener">jdk8</a><br><a href="https://archive.apache.org/dist/maven/maven-3/3.8.1/binaries/" target="_blank" rel="noopener">maven 3.8.1</a><br><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">JAVA_HOME=/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home</span><br><span class="line">CLASSPATH=.:$JAVA<span class="emphasis">_HOME/lib/dt.jar:$JAVA_</span>HOME/lib/tools.jar</span><br><span class="line">export JAVA_HOME</span><br><span class="line">export CLASSPATH</span><br><span class="line">export M2_HOME=/Users/shenbowen/Downloads/apache-maven-3.6.3</span><br><span class="line">PATH=$&#123;PATH&#125;:$&#123;JAVA<span class="emphasis">_HOME&#125;/bin:$&#123;M2_</span>HOME&#125;/bin:/usr/local/share/dotnet/x64</span><br></pre></td></tr></table></figure></p><p><a href="https://developer.aliyun.com/article/1043958" target="_blank" rel="noopener">mat</a><br><a href="更改appid:i****@1**8密码为d**U">从appstore安装snap 无用 寻找到替代应用thor laucher</a><br>[alfred]<br>[叮叮]<br>[sublimetext]<br>[wps office]<br><a href="http://pencil.evolus.vn/" target="_blank" rel="noopener">pencil</a><br><a href="https://github.com/qier222/YesPlayMusic" target="_blank" rel="noopener">yesplaymusic</a><br>[百度网盘]<br>[微信]<br>[remotedesktop]<br>[vscode]<br>[dash]<br>[transmit]<br>[progressive downloader]<br>[go]<br>[goland]<br>[python]<br>[pycharm]<br>[docker]<br><a href="https://hexo.io/zh-cn/docs/configuration" target="_blank" rel="noopener">hexo</a><br><a href="http://home.ustc.edu.cn/~liujunyan/blog/hexo-next-theme-config/#hexo-%E9%85%8D%E7%BD%AE" target="_blank" rel="noopener">hexo主题</a><br><a href="https://studio3t.com/" target="_blank" rel="noopener">studio3t</a><br><a href="https://www.macwk.com/soft/redis-desktop-manager" target="_blank" rel="noopener">rdm</a><br>[classx]<br><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">配置-托管配置-管理-添加：https://vpn.dovd.ml/private/vpn-collect.yaml</span><br><span class="line">Chrom插件-SwitchyOmega</span><br><span class="line"><span class="code">    情景模式-新建情景模式</span></span><br><span class="line"><span class="code">        代理服务器 - proxy- HTTP 127.0.0.1 7890</span></span><br><span class="line"><span class="code">        自动切换模式 - auto- AutoProxy https://raw.iqiq.io/gfwlist/gfwlist/master/gfwlist.txt 立刻更新情景模式</span></span><br><span class="line"><span class="code">            默认情景模式 选 直接连接</span></span><br><span class="line"><span class="code">            规则列表规则 选 proxy</span></span><br><span class="line"><span class="code">        应用选项</span></span><br><span class="line"><span class="code">    选择auto</span></span><br></pre></td></tr></table></figure></p>]]></content>
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mac </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Linux笔记</title>
      <link href="/2017/06/16/linux-note/"/>
      <url>/2017/06/16/linux-note/</url>
      <content type="html"><![CDATA[<h1 id="安装CentOS"><a href="#安装CentOS" class="headerlink" title="安装CentOS"></a>安装CentOS</h1><h2 id="安装VirtualBox-CentOS"><a href="#安装VirtualBox-CentOS" class="headerlink" title="安装VirtualBox+CentOS"></a><a href="http://www.linuxdown.net/install/setup/2015/0122/3798.html" target="_blank" rel="noopener">安装VirtualBox</a>+<a href="http://www.linuxdown.net/CentOS/2016/0110/4330.html" target="_blank" rel="noopener">CentOS</a></h2><ul><li>设备-&gt;安装增强功能<br>打开目录run/media/root/VBoxAddons…，<br>终端运行<code>sh VBoxLinuxAdditions.run</code>，<br>重启后就可以在”应用程序-系统工具-设置-显示”里面设置分辨率了<a id="more"></a></li><li><p>VitualBox 扩容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cmd</span><br><span class="line">cd c:\program files\oracle\vitualbox\</span><br><span class="line">VboxManage.exe modifyhd &quot;name.vdi&quot; --resize NUM_IN_MB (20480 means 20G)</span><br></pre></td></tr></table></figure></li><li><p>网络配置<br>Host-Only 链接到本机 VirtualBox Host-Only Ethernet Adapter（192.168.56.1）<br>NAT 本地网络转换到虚拟机内，使得虚拟机与本机具有相同的网络访问能力<br>桥接网卡 连接到本地路由网络并分配地址，使得本地路由下的机器虚拟机能够互相访问</p></li><li><p>CentOS 7.5.1804 host-only无法正常动态分配地址<br><code>cd /etc/sysconfig/network-scripts/</code><br><code>vi ifcfg-enp0s3</code><br>修改其内容如下，然后<code>systemctl restart network.service</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">TYPE=&quot;Ethernet&quot;</span><br><span class="line">BOOTPROTO=&quot;dhcp&quot;</span><br><span class="line">DEFROUTE=&quot;yes&quot;</span><br><span class="line">PEERDNS=&quot;yes&quot;</span><br><span class="line">PEERROUTES=&quot;yes&quot;</span><br><span class="line">IPV4_FAILURE_FATAL=&quot;no&quot;</span><br><span class="line">IPV6INIT=&quot;yes&quot;</span><br><span class="line">IPV6_AUTOCONF=&quot;yes&quot;</span><br><span class="line">IPV6_DEFROUTE=&quot;yes&quot;</span><br><span class="line">IPV6_PEERDNS=&quot;yes&quot;</span><br><span class="line">IPV6_PEERROUTES=&quot;yes&quot;</span><br><span class="line">IPV6_FAILURE_FATAL=&quot;no&quot;</span><br><span class="line">NAME=&quot;enp0s3&quot;</span><br><span class="line">UUID=&quot;a57d4898-6803-49dc-8cd9-01035897cc69&quot;</span><br><span class="line">DEVICE=&quot;enp0s3&quot;</span><br><span class="line">ONBOOT=&quot;yes&quot;</span><br></pre></td></tr></table></figure></li></ul><h1 id="Linux常用命令"><a href="#Linux常用命令" class="headerlink" title="Linux常用命令"></a><a href="https://www.centoschina.cn/command/help/2493.html" target="_blank" rel="noopener">Linux常用命令</a></h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ du -h #查看本目录下文件夹大小(--max-depth=? 可指定目录层级，默认1)</span><br><span class="line">$ du -hs #查看本目录大小</span><br><span class="line">$ ls -lah #查看本目录下文件大小</span><br><span class="line">$ rename .uc .mp3 *.uc #将目录下所有uc文件更改为mp3</span><br><span class="line">$ ln -s /opt/solr-5.5.3 /opt/solr #创建软链接</span><br><span class="line">$ crontab -e 与 chkconfig --list</span><br><span class="line">$ find . -iname &quot;*.java&quot; -type f -exec gsed -i &apos;1s/^/123\n/&apos; &#123;&#125; \; # 在本目录下所有java文件开头插入新行，内容为123</span><br></pre></td></tr></table></figure><h1 id="CentOS环境"><a href="#CentOS环境" class="headerlink" title="CentOS环境"></a>CentOS环境</h1><h2 id="缺少wget以及net-tools-无法使用command-ifconfig"><a href="#缺少wget以及net-tools-无法使用command-ifconfig" class="headerlink" title="缺少wget以及net-tools(无法使用command:ifconfig)"></a>缺少wget以及net-tools(无法使用command:ifconfig)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ yum -y install net-tools</span><br><span class="line">$ yum -y install wget</span><br></pre></td></tr></table></figure><h2 id="修改yum源"><a href="#修改yum源" class="headerlink" title="修改yum源"></a>修改yum源</h2><p>centos7<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ cd /etc/yum.repos.d</span><br><span class="line">$ mv CentOS-Base.repo CentOS-Base.repo.bak</span><br><span class="line">$ wget -O CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo #下载阿里源的文件</span><br><span class="line"># 或者</span><br><span class="line">$ wget -O CentOS-Base.repo http://mirrors.163.com/.help/CentOS7-Base-163.repo #下载163源的文件</span><br><span class="line">$ yum clean all  #清理缓存</span><br><span class="line">$ yum makecache #重新生成缓存</span><br><span class="line"># 使用阿里repel源：https://www.cnblogs.com/renpingsheng/p/7845096.html</span><br></pre></td></tr></table></figure></p><p>centos8<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ mv /etc/yum.repos.d /etc/yum.repos.d.backup</span><br><span class="line">$ mkdir /etc/yum.repos.d</span><br><span class="line">$ wget -O /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-8.repo</span><br><span class="line">$ yum clean all</span><br><span class="line">$ yum makecache</span><br><span class="line">$ yum update -y</span><br><span class="line">$ yum install -y vim</span><br></pre></td></tr></table></figure></p><h2 id="使用xshell-xftp"><a href="#使用xshell-xftp" class="headerlink" title="使用xshell+xftp"></a>使用xshell+xftp</h2><ul><li>SN：101210-450789-147200</li><li>xftp实现文件互传</li><li>xshell用于终端连接</li></ul><h2 id="VIM配置"><a href="#VIM配置" class="headerlink" title="VIM配置"></a><a href="http://macshuo.com/?tag=vim" target="_blank" rel="noopener">VIM配置</a></h2><p><code>$ yum install -y vim</code><br><a href="http://blog.csdn.net/genglei1022/article/details/6331616" target="_blank" rel="noopener">http://blog.csdn.net/genglei1022/article/details/6331616</a><br><a href="http://www.cnblogs.com/tzhangofseu/archive/2011/12/17/2290955.html" target="_blank" rel="noopener">http://www.cnblogs.com/tzhangofseu/archive/2011/12/17/2290955.html</a><br>设置tab为4个空格<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set ts=4</span><br><span class="line">set expandtab</span><br></pre></td></tr></table></figure></p><h2 id="安装zsh"><a href="#安装zsh" class="headerlink" title="安装zsh"></a>安装zsh</h2><ul><li><code>yum -y install zsh</code></li><li>安装oh my zsh: <code>$ sh -c &quot;$(wget https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh -O -)&quot;</code></li><li>配置zsh: vim ~/.zshrc</li></ul><h2 id="iterm2-配色"><a href="#iterm2-配色" class="headerlink" title="iterm2 配色"></a><a href="http://yijiebuyi.com/blog/9c6419897949a7935d0fdec74cb7c61b.html" target="_blank" rel="noopener">iterm2 配色</a></h2><h2 id="firewalld"><a href="#firewalld" class="headerlink" title="firewalld"></a><a href="https://havee.me/linux/2015-01/using-firewalls-on-centos-7.html" target="_blank" rel="noopener">firewalld</a></h2><ul><li><p>安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum install firewalld</span><br><span class="line">$ systemctl unmask firewalld</span><br><span class="line">$ systemctl enable firewalld</span><br><span class="line">$ systemctl start firewalld</span><br></pre></td></tr></table></figure></li><li><p>查询开启端口</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ firewall-cmd --query-port=80/tcp</span><br><span class="line">$ firewall-cmd --zone=public --add-port=80/tcp --permanent</span><br><span class="line">$ firewall-cmd --add-port=80/tcp</span><br><span class="line">$ firewall-cmd --reload</span><br><span class="line">$ firewall-cmd --zone=public --list-ports</span><br></pre></td></tr></table></figure></li></ul><h2 id="Telnet-TelnetServer"><a href="#Telnet-TelnetServer" class="headerlink" title="Telnet/TelnetServer"></a><a href="http://www.cnblogs.com/xlmeng1988/archive/2012/04/24/telnet-server.html" target="_blank" rel="noopener">Telnet/TelnetServer</a></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ yum -y install telnet</span><br><span class="line">$ yum -y install telnet-server</span><br></pre></td></tr></table></figure><h2 id="更新locate数据库"><a href="#更新locate数据库" class="headerlink" title="更新locate数据库"></a>更新locate数据库</h2><p>如果未安装则执行 <code>yum -y install mlocate</code>, 然后使用<code>updatedb</code>进行更新，使用<code>locate</code>进行查找</p><h2 id="设置bash-alias"><a href="#设置bash-alias" class="headerlink" title="设置bash alias"></a>设置bash alias</h2><p>系统级：/etc/bash.bashrc<br>用户级：~/.bashrc<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ cd ~</span><br><span class="line">$ vim .bashrc</span><br><span class="line">$ source .bashrc</span><br></pre></td></tr></table></figure></p><h2 id="设置环境变量"><a href="#设置环境变量" class="headerlink" title="设置环境变量"></a><a href="http://blog.csdn.net/cscmaker/article/details/7261921" target="_blank" rel="noopener">设置环境变量</a></h2><p>系统级：/etc/profile<br>用户级：~/.profile<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ cd ~</span><br><span class="line">$ vim .profile</span><br><span class="line">$ source .profile</span><br></pre></td></tr></table></figure></p><h2 id="swap空间"><a href="#swap空间" class="headerlink" title="swap空间"></a><a href="https://www.cnblogs.com/marixh/p/10601497.html" target="_blank" rel="noopener">swap空间</a></h2><h2 id="网络参数调优"><a href="#网络参数调优" class="headerlink" title="网络参数调优"></a>网络参数调优</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sysctl -a|grep tcp #查看tcp相关参数</span><br><span class="line">$ vim /etc/sysctl.conf #修改</span><br><span class="line">$ sysctl -p #修改后重新加载</span><br></pre></td></tr></table></figure><p>参数<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># socket缓冲</span></span><br><span class="line">net.core.rmem_max=16777216</span><br><span class="line">net.core.wmem_max=16777216</span><br><span class="line"><span class="comment"># 接收缓冲自动调整</span></span><br><span class="line">net.ipv4.tcp_moderate_rcvbuf=1</span><br><span class="line"><span class="comment"># tcp读写缓冲</span></span><br><span class="line">net.ipv4.tcp_rmem=4096 87380 16777216</span><br><span class="line">net.ipv4.tcp_wmem=4096 65536 16777216</span><br><span class="line"><span class="comment"># syn积压队列</span></span><br><span class="line">net.ipv4.tcp_max_syn_backlog=4096</span><br><span class="line"><span class="comment"># 监听积压队列</span></span><br><span class="line">net.core.somaxconn=1024</span><br><span class="line"><span class="comment"># 设备积压队列</span></span><br><span class="line">net.core.netdev_max_backlog=10000</span><br><span class="line"><span class="comment"># TCP拥塞控制</span></span><br><span class="line">net.ipv4.tcp_congestion_control=cubic</span><br><span class="line"><span class="comment"># TCP选项</span></span><br><span class="line">net.ipv4.tcp_sack=1</span><br><span class="line">net.ipv4.tcp_fack=1</span><br><span class="line">net.ipv4.tcp_tw_reuse=1</span><br><span class="line">net.ipv4.tcp_tw_recycle=0</span><br><span class="line"><span class="comment"># 网络接口</span></span><br><span class="line">ipconfig eth0 txqueuelen 10000</span><br></pre></td></tr></table></figure></p><h1 id="CentOS软件"><a href="#CentOS软件" class="headerlink" title="CentOS软件"></a>CentOS软件</h1><h2 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h2><p><code>yum -y install git</code><br>本地新建文件夹，推送到远端<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ cd &lt;localdir&gt;</span><br><span class="line">$ git init</span><br><span class="line">$ git add .</span><br><span class="line">$ git commit -m &apos;message&apos;</span><br><span class="line">$ git remote add origin &lt;url&gt;</span><br><span class="line">$ git push -u origin master</span><br></pre></td></tr></table></figure></p><h2 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a><a href="http://www.centoscn.com/image-text/install/2015/1222/6560.html" target="_blank" rel="noopener">PHP</a></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ yum install php (安装php同时会安装apache httpd)</span><br><span class="line">$ systemctl enable httpd.service （配置开机启动httpd）</span><br></pre></td></tr></table></figure><h2 id="C-C-开发套件"><a href="#C-C-开发套件" class="headerlink" title="C/C++开发套件"></a>C/C++开发套件</h2><p><code>$ yum groupinstall &quot;Development Tools&quot;</code></p><h2 id="MySql"><a href="#MySql" class="headerlink" title="MySql"></a><a href="http://blog.csdn.net/czmchen/article/details/46645763" target="_blank" rel="noopener">MySql</a></h2><ul><li><a href="http://blog.csdn.net/inslow/article/details/54291182" target="_blank" rel="noopener">修改默认密码</a></li><li><a href="http://wilr.iteye.com/blog/2168659" target="_blank" rel="noopener">集群配置</a></li><li><a href="http://www.cr173.com/soft/126913.html" target="_blank" rel="noopener">安装Windows下客户端SQLyog</a></li></ul><h2 id="MemCached"><a href="#MemCached" class="headerlink" title="MemCached"></a><a href="http://www.cnblogs.com/zgx/archive/2011/08/10/2134097.html" target="_blank" rel="noopener">MemCached</a></h2><h2 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a><a href="http://www.cnblogs.com/_popc/p/3684835.html" target="_blank" rel="noopener">Redis</a></h2><p><a href="https://www.cnblogs.com/skyessay/p/6433349.html" target="_blank" rel="noopener">开机自启动redis服务(yum install方式无需设置)</a><br><a href="http://www.redis.net.cn/" target="_blank" rel="noopener">redis cn</a></p><ul><li><p>安装/服务启动</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ yum install -y redis</span><br><span class="line">$ systemctl enable redis</span><br><span class="line">$ systemctl start redis</span><br></pre></td></tr></table></figure></li><li><p>它机访问</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># bind 127.0.0.1</span><br><span class="line">protected-mode no</span><br></pre></td></tr></table></figure></li><li><p>firewall-cmd开启端口</p></li><li>设置密码: /etc/redis.conf<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">requirepass ****</span><br></pre></td></tr></table></figure></li></ul><h2 id="NodeJS"><a href="#NodeJS" class="headerlink" title="NodeJS"></a><a href="http://lovebeyond.iteye.com/blog/1770598" target="_blank" rel="noopener">NodeJS</a></h2><p><code>$ yum install nodejs npm</code></p><h2 id="MongoDB"><a href="#MongoDB" class="headerlink" title="MongoDB"></a><a href="http://zhangge.net/4493.html" target="_blank" rel="noopener">MongoDB</a></h2><p><a href="http://blog.csdn.net/huwei2003/article/details/40507611" target="_blank" rel="noopener">MongoDB开机自启动</a></p><h2 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a><a href="http://jingyan.baidu.com/article/aa6a2c14dc36640d4d19c47e.html" target="_blank" rel="noopener">Nginx</a></h2><ul><li>CentOS中nginx默认配置的位置是:/etc/nginx/conf.d/default.conf</li><li><a href="http://www.cnblogs.com/savorboard/p/dotnet-core-publish-nginx.html" target="_blank" rel="noopener">ASP.NET Core 部署到CentOS，使用Nginx反向代理</a></li><li><a href="http://www.cnblogs.com/jacktang/p/3669115.html" target="_blank" rel="noopener">nginx反代及负载</a></li><li><a href="https://www.cnblogs.com/piscesLoveCc/p/5867900.html" target="_blank" rel="noopener">nginx开机自启动</a></li><li><p><a href="https://stackoverflow.com/questions/18480201/ubuntu-nginx-emerg-bind-to-0-0-0-080-failed-13-permission-denied" target="_blank" rel="noopener">端口开机自启动无法绑定</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo semanage port -l | grep http_port_t</span><br><span class="line">$ sudo semanage port -a -t http_port_t  -p tcp 8024</span><br></pre></td></tr></table></figure></li><li><p>反向代理错误: failed (13: Permission denied) while connecting to upstream</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ setsebool httpd_can_network_connect on -P</span><br></pre></td></tr></table></figure></li><li><p><a href="https://zhih.me/nginx-http2-https/" target="_blank" rel="noopener">https支持</a></p></li><li><a href="https://blog.csdn.net/yzhou86/article/details/41247387" target="_blank" rel="noopener">子站点映射</a></li></ul><h2 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a><a href="https://www.docker.com/" target="_blank" rel="noopener">Docker</a></h2><ul><li><a href="https://hub.docker.com/" target="_blank" rel="noopener">Hub</a></li><li>使用阿里云镜像<br><a href="https://blog.csdn.net/qq_30259339/article/details/52400673" target="_blank" rel="noopener">https://blog.csdn.net/qq_30259339/article/details/52400673</a><br><a href="https://hpc.aliyun.com/doc/docker" target="_blank" rel="noopener">https://hpc.aliyun.com/doc/docker</a><br><a href="https://aotu.io/notes/2016/02/27/docker/" target="_blank" rel="noopener">https://aotu.io/notes/2016/02/27/docker/</a></li><li><a href="https://cr.console.aliyun.com/?spm=5176.1971733.0.2.hFB1YK#/docker/image/list" target="_blank" rel="noopener">个人阿里云docker-centos仓库地址</a></li><li><p>配置nginx负载均衡：使用2个docker container</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -d -p 6001:5000 --restart=always -t hello:1.0</span><br><span class="line">$ docker run -d -p 6002:5000 --restart=always -t hello:1.0</span><br></pre></td></tr></table></figure></li><li><p>Running .Net Core on Docker<br><a href="https://medium.com/trafi-tech-beat/running-net-core-on-docker-c438889eb5a#.7ootzhuze" target="_blank" rel="noopener">https://medium.com/trafi-tech-beat/running-net-core-on-docker-c438889eb5a#.7ootzhuze</a><br><a href="http://dockone.io/article/1369" target="_blank" rel="noopener">http://dockone.io/article/1369</a><br><a href="https://stormpath.com/blog/tutorial-deploy-asp-net-core-on-linux-with-docker" target="_blank" rel="noopener">https://stormpath.com/blog/tutorial-deploy-asp-net-core-on-linux-with-docker</a></p></li><li><p>出现错误：docker-runc not installed on system</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ vim /etc/systemd/system/docker.service</span><br><span class="line"># 添加以下三行到ExecStart的参数中</span><br><span class="line"># --add-runtime docker-runc=/usr/libexec/docker/docker-runc-current \</span><br><span class="line"># --default-runtime=docker-runc \</span><br><span class="line"># --userland-proxy-path=/usr/libexec/docker/docker-proxy-current \</span><br><span class="line">$ systemctl daemon-reload</span><br><span class="line">$ systemctl restart docker</span><br></pre></td></tr></table></figure></li><li><p><a href="https://blog.csdn.net/Tomcat_Lu/article/details/112414518" target="_blank" rel="noopener">升级docker</a></p></li><li><a href="https://www.cnblogs.com/-wenli/p/14055021.html" target="_blank" rel="noopener">清理docker空间</a></li></ul><h2 id="JDK-amp-amp-Tomcat-安装"><a href="#JDK-amp-amp-Tomcat-安装" class="headerlink" title="JDK &amp;&amp; Tomcat 安装"></a><a href="http://www.linuxidc.com/Linux/2015-01/111485.htm" target="_blank" rel="noopener">JDK &amp;&amp; Tomcat 安装</a></h2><p>开机自启动配置参考<a href="https://www.cnblogs.com/ieinstein/p/7096650.html" target="_blank" rel="noopener">自启动</a></p><h2 id="Tomcat"><a href="#Tomcat" class="headerlink" title="Tomcat"></a><a href="https://www.jianshu.com/p/9b18293cc796" target="_blank" rel="noopener">Tomcat</a></h2><ul><li>多个springboot项目部署在同一tomcat上，出现jmx错误<br>application.properties中添加如下配置<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">endpoints.jmx.unique-names=true</span><br><span class="line">spring.jmx.default-domain=唯一的名字</span><br></pre></td></tr></table></figure></li></ul><h2 id="Maven"><a href="#Maven" class="headerlink" title="Maven"></a><a href="http://blog.csdn.net/xyang81/article/details/51487939" target="_blank" rel="noopener">Maven</a></h2><p><a href="http://blog.csdn.net/oDeviloo/article/details/52050277" target="_blank" rel="noopener">POM配置节详解</a></p><h2 id="Zookeeper"><a href="#Zookeeper" class="headerlink" title="Zookeeper"></a><a href="http://www.linuxidc.com/Linux/2016-09/135052.htm" target="_blank" rel="noopener">Zookeeper</a></h2><p><a href="http://blog.csdn.net/u012453843/article/details/70162796" target="_blank" rel="noopener">自启动设置1</a><br><a href="http://www.bubuko.com/infodetail-2047052.html" target="_blank" rel="noopener">自启动设置2</a></p><h2 id="Dubbo-Admin"><a href="#Dubbo-Admin" class="headerlink" title="Dubbo Admin"></a><a href="https://www.cnblogs.com/520playboy/p/6298289.html" target="_blank" rel="noopener">Dubbo Admin</a></h2><h2 id="Supervisor"><a href="#Supervisor" class="headerlink" title="Supervisor"></a><a href="http://blog.51cto.com/huwei555/1977695" target="_blank" rel="noopener">Supervisor</a></h2><p><a href="https://blog.csdn.net/xyang81/article/details/51555473" target="_blank" rel="noopener">参考</a></p><p><code>/etc/init.d/supervisord</code>内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">#</span><br><span class="line"># /etc/rc.d/init.d/supervisord</span><br><span class="line">#</span><br><span class="line"># Supervisor is a client/server system that</span><br><span class="line"># allows its users to monitor and control a</span><br><span class="line"># number of processes on UNIX-like operating</span><br><span class="line"># systems.</span><br><span class="line">#</span><br><span class="line"># chkconfig: - 64 36</span><br><span class="line"># description: Supervisor Server</span><br><span class="line"># processname: supervisord</span><br><span class="line"></span><br><span class="line"># Source init functions</span><br><span class="line">. /etc/init.d/functions</span><br><span class="line"></span><br><span class="line">RETVAL=0</span><br><span class="line">prog=&quot;supervisord&quot;</span><br><span class="line">pidfile=&quot;/tmp/supervisord.pid&quot;</span><br><span class="line">lockfile=&quot;/var/lock/subsys/supervisord&quot;</span><br><span class="line"></span><br><span class="line">start()</span><br><span class="line">&#123;</span><br><span class="line">        echo -n $&quot;Starting $prog: &quot;</span><br><span class="line">        daemon --pidfile $pidfile supervisord -c /etc/supervisor/supervisord.conf</span><br><span class="line">        RETVAL=$?</span><br><span class="line">        echo</span><br><span class="line">        [ $RETVAL -eq 0 ] &amp;&amp; touch $&#123;lockfile&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">stop()</span><br><span class="line">&#123;</span><br><span class="line">        echo -n $&quot;Shutting down $prog: &quot;</span><br><span class="line">        killproc -p $&#123;pidfile&#125; /usr/bin/supervisord</span><br><span class="line">        RETVAL=$?</span><br><span class="line">        echo</span><br><span class="line">        if [ $RETVAL -eq 0 ] ; then</span><br><span class="line">                rm -f $&#123;lockfile&#125; $&#123;pidfile&#125;</span><br><span class="line">        fi</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">case &quot;$1&quot; in</span><br><span class="line"></span><br><span class="line">  start)</span><br><span class="line">    start</span><br><span class="line">  ;;</span><br><span class="line"></span><br><span class="line">  stop)</span><br><span class="line">    stop</span><br><span class="line">  ;;</span><br><span class="line"></span><br><span class="line">  status)</span><br><span class="line">        status $prog</span><br><span class="line">  ;;</span><br><span class="line"></span><br><span class="line">  restart)</span><br><span class="line">    stop</span><br><span class="line">    start</span><br><span class="line">  ;;</span><br><span class="line"></span><br><span class="line">  *)</span><br><span class="line">    echo &quot;Usage: $0 &#123;start|stop|restart|status&#125;&quot;</span><br><span class="line">  ;;</span><br><span class="line"></span><br><span class="line">esac</span><br></pre></td></tr></table></figure></p><p>install_supervisor.sh<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#/bin/bash</span><br><span class="line"></span><br><span class="line"># meld</span><br><span class="line">cd /opt</span><br><span class="line">wget https://pypi.python.org/packages/0f/5e/3a57c223d8faba2c3c2d69699f7e6cfdd1e5cc31e79cdd0dd48d44580b50/meld3-1.0.1.tar.gz#md5=2f045abe0ae108e3c8343172cffbe21d</span><br><span class="line">tar -zxvf meld3-1.0.1.tar.gz</span><br><span class="line">cd meld3-1.0.1</span><br><span class="line">python setup.py install</span><br><span class="line"></span><br><span class="line"># supervisor</span><br><span class="line">cd /opt</span><br><span class="line">wget https://pypi.python.org/packages/12/50/cd330d1a0daffbbe54803cb0c4c1ada892b5d66db08befac385122858eee/supervisor-3.1.4.tar.gz#md5=cb64f92409ebabf17aa0884fc407fec6</span><br><span class="line">tar -zxvf supervisor-3.1.4.tar.gz</span><br><span class="line">cd supervisor-3.1.4</span><br><span class="line">python setup.py install</span><br><span class="line"></span><br><span class="line"># config</span><br><span class="line">mkdir /etc/supervisor</span><br><span class="line">mkdir /etc/supervisor/conf.d</span><br><span class="line">echo_supervisord_conf &gt; /etc/supervisor/supervisord.conf</span><br><span class="line">chmod +x /etc/init.d/supervisord</span><br><span class="line"></span><br><span class="line"># auto-start after bootup</span><br><span class="line">chkconfig supervisord on</span><br><span class="line">service supervisord start</span><br></pre></td></tr></table></figure></p><h2 id="centos7自启动系列"><a href="#centos7自启动系列" class="headerlink" title="centos7自启动系列"></a><a href="https://blog.csdn.net/qq_30171043/article/details/70610713" target="_blank" rel="noopener">centos7自启动系列</a></h2><h2 id="搬瓦工与ShadowSocks"><a href="#搬瓦工与ShadowSocks" class="headerlink" title="搬瓦工与ShadowSocks"></a>搬瓦工与ShadowSocks</h2><ul><li><p><a href="https://www.bwh1.net/" target="_blank" rel="noopener">搬瓦工</a><br>搭建ss的过程可参考<a href="http://blog.sina.com.cn/s/blog_17639fae00102xat4.html" target="_blank" rel="noopener">这里</a>,优惠码为 BWH1ZBPVK 可节省6%<br>如果没有ss配置则可以看<a href="http://blog.sina.com.cn/s/blog_17639fae00102xat4.html" target="_blank" rel="noopener">这里</a><br>若使用ss-server(shadowsocks-libev)，其配置文件位于/etc/shadowsocks-libev<br><a href="https://github.com/acmesh-official/acme.sh" target="_blank" rel="noopener">acme</a></p></li><li><p><a href="https://github.com/shadowsocks" target="_blank" rel="noopener">ShadowSocks</a><br><a href="https://www.flyzy2005.com/fan-qiang/shadowsocks/ss-clients-download/" target="_blank" rel="noopener">各版本shadowsocks客户端下载地址</a><br><a href="https://www.codetd.com/article/868035" target="_blank" rel="noopener">shadowsocks manager</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ yum update -y</span><br><span class="line">$ yum install -y vim git wget screen</span><br><span class="line">$ curl -sL https://rpm.nodesource.com/setup_8.x | bash -</span><br><span class="line">$ yum install -y nodejs # 安装8.*版本的nodejs</span><br><span class="line">$ npm i -g shadowsocks-manager # npm安装shadowsocks-manager</span><br><span class="line">$ kill -9 ** # **为默认ss-server的pid</span><br><span class="line">$ ss-manager -m aes-256-cfb -u --manager-address 127.0.0.1:4004 &amp;</span><br><span class="line">$ ssmgr -c ~/.ssmgr/default.yml &amp;</span><br><span class="line">$ ssmgr -c ~/.ssmgr/webgui.yml &amp;</span><br></pre></td></tr></table></figure></li></ul><p>default.yml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">type: s</span><br><span class="line"></span><br><span class="line">shadowsocks:</span><br><span class="line">  address: 127.0.0.1:4004</span><br><span class="line"></span><br><span class="line">manager:</span><br><span class="line">  address: 0.0.0.0:7007</span><br><span class="line">  password: &apos;123456789&apos;</span><br><span class="line"></span><br><span class="line">db: &apos;default.sqlite&apos;</span><br></pre></td></tr></table></figure></p><p>webgui.yml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">type: m</span><br><span class="line"></span><br><span class="line">manager:</span><br><span class="line">  address: 0.0.0.0:7007</span><br><span class="line">  password: &apos;123456789&apos;</span><br><span class="line"></span><br><span class="line">plugins:</span><br><span class="line">  flowSaver:</span><br><span class="line">    use: true</span><br><span class="line">  user:</span><br><span class="line">    use: true</span><br><span class="line">  account:</span><br><span class="line">    use: true</span><br><span class="line">  macAccount:</span><br><span class="line">    use: true</span><br><span class="line">  email:</span><br><span class="line">    use: true</span><br><span class="line">    type: &apos;smtp&apos; # 配置 smtp</span><br><span class="line">    username: &apos;xxx&apos;</span><br><span class="line">    password: &apos;xxx&apos;</span><br><span class="line">    host: &apos;smtp.xxx.com&apos;</span><br><span class="line">  webgui:</span><br><span class="line">    use: true</span><br><span class="line">    host: &apos;0.0.0.0&apos;</span><br><span class="line">    port: &apos;80&apos; # 监听端口</span><br><span class="line">    site: &apos;http://ss.52xckl.cn&apos; # 将这里改成自己的 ip 或者域名</span><br><span class="line"></span><br><span class="line">db: &apos;webgui.sqlite&apos;</span><br></pre></td></tr></table></figure></p><h2 id="V2Ray-TLS解决ss无法使用的问题"><a href="#V2Ray-TLS解决ss无法使用的问题" class="headerlink" title="V2Ray+TLS解决ss无法使用的问题"></a>V2Ray+TLS解决ss无法使用的问题</h2><ol><li>申请域名并支持HTTPS（使用freenom+阿里云https）<br>freenom免费域名有效期仅有1年，1年后需重新申请新的域名<br>步骤：申请域名-&gt;配置域名解析（WWW+空解析）<br>阿里云SSL免费版有效期1年，1年后需重新申请免费SSL证书<br>步骤：<br> 购买免费SSL-&gt;<br> 申请域名（手动验证）-&gt;<br> 下载txt到网站根目录（/usr/local/src/icmyfuture.github.io/.well-known/pki-validation）-&gt;<br> 下载ssl证书至nginx目录（/etc/nginx/ssl）<br> 修改nginx配置-使用新ssl证书，重启nginx</li><li>安装v2ray(选TCP即可),可参考<a href="https://github.com/233boy/v2ray/wiki/V2Ray%E6%90%AD%E5%BB%BA%E8%AF%A6%E7%BB%86%E5%9B%BE%E6%96%87%E6%95%99%E7%A8%8B" target="_blank" rel="noopener">安装</a></li><li>配置nginx以支持ssl，并<a href="https://www.wervps.com/we/2541.html" target="_blank" rel="noopener">配置转发至v2ray</a><br>参考：原生搭建 部分的配置</li><li>下载客户端<br>各种系统V2ray下载：<br><a href="https://github.com/v2ray/v2ray-core/releases" target="_blank" rel="noopener">下载v2ray-core</a><br><a href="https://github.com/2dust/v2rayN/releases" target="_blank" rel="noopener">下载v2rayN</a><br>对v2ray-windows-64.zip进行解压，然后将下载的V2RayN.exe复制到解压后的目录，即两个下载好的文件需要在同一目录<br>注意以管理员身份运行，可选择全局模式</li></ol><h1 id="安装Ubuntu"><a href="#安装Ubuntu" class="headerlink" title="安装Ubuntu"></a><a href="https://www.jianshu.com/p/417c1001a559" target="_blank" rel="noopener">安装Ubuntu</a></h1><ul><li>从<a href="https://www.ubuntu.com/download/desktop" target="_blank" rel="noopener">官网</a>下载ubuntu iso<br>放入一个盘符的根目录，并解压到当前文件夹（如：放在D盘，且解压后所有文件在D盘根目录）</li><li>下载 <a href="http://neosmart.net/EasyBCD/" target="_blank" rel="noopener">EasyBCD</a>, 安装</li><li>Win10中，准备好一个未分配的盘符</li><li>添加Ubuntu-iso引导项<br>打开EasyBCD，添加新条目-&gt;便携式/外接存储介质-&gt;ISO，名称：Ubuntu-iso，路径：选择iso所在的位置，模式：从硬盘运行 -&gt;添加条目，编辑引导菜单-&gt;保存设置</li><li>重启电脑，引导界面选择Ubuntu-iso</li><li>安装Ubuntu，分区配置如下<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">16778MB     主分区         空间起始位置  Ext3日志文件系统  /</span><br><span class="line">16778MB     逻辑分区        空间起始位置 交换空间</span><br><span class="line">263MB       逻辑分区        空间起始位置 Ext3日志文件系统 /boot</span><br><span class="line">默认         逻辑分区       空间起始位置 Ext3日志文件系统 /home</span><br></pre></td></tr></table></figure></li></ul><p>安装启动引导器的设备：选择/boot所在分区</p><ul><li>添加ubuntu引导项<br>进入Win10，打开EasyBCD，删除引导项Ubuntu-iso，添加新条目-&gt;操作系统-&gt;Linux/BSD，名称：Ubuntu，驱动器：选择/boot所在的分区，-&gt;添加条目，编辑引导菜单-&gt;保存设置</li><li>重启系统，选择启动项Ubuntu进入Ubuntu系统</li></ul><h1 id="ubuntu环境"><a href="#ubuntu环境" class="headerlink" title="ubuntu环境"></a>ubuntu环境</h1><h2 id="shadowsocks"><a href="#shadowsocks" class="headerlink" title="shadowsocks"></a><a href="https://www.cnblogs.com/Dumblidor/p/5450248.html" target="_blank" rel="noopener">shadowsocks</a></h2><p>需要在/etc/shadowsocks/config.json里面进行配置<br>使用以下别名，以守护进程模式启动/停止ss<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alias sson=&apos;sudo sslocal -c /etc/shadowsocks/config.json -d start&apos;</span><br><span class="line">alias ssoff=&apos;sudo sslocal -c /etc/shadowsocks/config.json -d stop&apos;</span><br></pre></td></tr></table></figure></p><p>在Firefox中则使用FoxyProxy来设置Socks5代理</p><h2 id="无法进入ubuntu桌面"><a href="#无法进入ubuntu桌面" class="headerlink" title="无法进入ubuntu桌面"></a>无法进入ubuntu桌面</h2><p>在升级重启后，有时候会出现输入密码，但始终无法进入桌面的情况。使用<code>ctrl+alt+f2</code>进入命令行模式，登录后，使用<code>sudo apt-get install ubuntu-desktop</code>来重新安装桌面。</p>]]></content>
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>技术列表</title>
      <link href="/2017/06/16/tech-list/"/>
      <url>/2017/06/16/tech-list/</url>
      <content type="html"><![CDATA[<h1 id="OS"><a href="#OS" class="headerlink" title="OS"></a>OS</h1><p><a href="https://www.linux.com/" target="_blank" rel="noopener">Linux</a></p><h1 id="VM-Container"><a href="#VM-Container" class="headerlink" title="VM/Container"></a>VM/Container</h1><p><a href="https://www.docker.com/" target="_blank" rel="noopener">Docker</a><a id="more"></a></p><h1 id="Distributed-Cache"><a href="#Distributed-Cache" class="headerlink" title="Distributed/Cache"></a>Distributed/Cache</h1><p><a href="http://nginx.org/" target="_blank" rel="noopener">Nginx</a><br><a href="http://www.redis.cn/" target="_blank" rel="noopener">Redis</a><br><a href="https://memcached.org/" target="_blank" rel="noopener">Memcached</a></p><h1 id="Cross-Platform-Dev-Suite"><a href="#Cross-Platform-Dev-Suite" class="headerlink" title="Cross-Platform Dev Suite"></a>Cross-Platform Dev Suite</h1><p>LAMP<br>J2EE<br>DotNETCore</p><ul><li><a href="http://www.cnblogs.com/artech/p/inside-asp-net-core-1.html" target="_blank" rel="noopener">inside-asp-net-core</a></li><li><a href="http://www.cnblogs.com/savorboard/p/dotnetcore-docker.html" target="_blank" rel="noopener">dotnetcore-docker</a></li></ul><h1 id="App"><a href="#App" class="headerlink" title="App"></a>App</h1><p><a href="http://www.cnblogs.com/kenshincui/category/594479.html" target="_blank" rel="noopener">iOS</a><br><a href="https://www.android.com/" target="_blank" rel="noopener">Android</a><br><a href="https://facebook.github.io/react/" target="_blank" rel="noopener">React</a> Native</p><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><ul><li><a href="http://mean.io/" target="_blank" rel="noopener">MEAN</a>/<a href="http://mern.io/" target="_blank" rel="noopener">MERN</a></li><li><a href="http://getbootstrap.com/" target="_blank" rel="noopener">Bootstrap</a></li><li><a href="http://cn.vuejs.org/" target="_blank" rel="noopener">Vue</a></li><li><a href="https://github.com/webpack/webpack" target="_blank" rel="noopener">WebPack</a>+<a href="https://babeljs.io/" target="_blank" rel="noopener">babel</a></li><li><a href="http://gulpjs.com/" target="_blank" rel="noopener">Gulp</a></li></ul><h1 id="Mashup-AI"><a href="#Mashup-AI" class="headerlink" title="Mashup/AI"></a>Mashup/AI</h1><ul><li><a href="https://www.perl.org/" target="_blank" rel="noopener">Perl</a></li><li><a href="https://www.python.org/" target="_blank" rel="noopener">Python</a></li></ul><h1 id="Database"><a href="#Database" class="headerlink" title="Database"></a>Database</h1><ul><li><a href="https://www.mysql.com/" target="_blank" rel="noopener">RMDB</a></li><li><a href="https://www.mongodb.com/" target="_blank" rel="noopener">NoSQL</a></li></ul>]]></content>
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> List </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>阅读列表</title>
      <link href="/2017/06/16/book-list/"/>
      <url>/2017/06/16/book-list/</url>
      <content type="html"><![CDATA[<h1 id="History"><a href="#History" class="headerlink" title="History"></a><em>History</em></h1><h2 id="2016"><a href="#2016" class="headerlink" title="2016"></a>2016</h2><blockquote><p>VBird Linux Basic 4th<br>ES6 In Depth<br><a href="https://www.w3cschool.cn/php/" target="_blank" rel="noopener">PHP</a><a id="more"></a></p></blockquote><h2 id="2017"><a href="#2017" class="headerlink" title="2017"></a>2017</h2><blockquote><p><a href="http://www.liaoxuefeng.com" target="_blank" rel="noopener">Python 3</a><br>富爸爸穷爸爸<br>Linux Bibel 9th<br>彼得·林奇的成功投资<br>富爸爸财务自由之路<br>程序员修炼之道：从小工到专家<br>百家讲坛_说话的艺术<br>C和指针<br>企业应用架构模式<br>UML精粹<br>Object Oriented Software Construction 2nd(Till C)<br>思考，快与慢<br>一本书读懂说话的艺术<br>Linux_UNIX系统编程手册(上/下) 4C<br>国富论/图解国富论<br>文明史纲<br>暗时间<br>乌合之众<br>梦的解析/第一本心理学漫画书-梦的解析<br>UNIX环境高级编程 2nd<br>UNIX编程艺术<br>程序设计实践<br>微服务_从设计到部署</p></blockquote><h2 id="2018"><a href="#2018" class="headerlink" title="2018"></a>2018</h2><blockquote><p>架构之美<br>程序员的思维修炼<br>高效程序员的45个习惯<br>程序员的数学<br>影响力<br>Agile Java<br>Thinking in Java 2nd<br>比特币与区块链<br>代码大全(第二版)<br>深入理解Java虚拟机2nd<br>byte-of-python<br>深入理解计算机系统第三版<br>Java 8 in action<br>软技能：代码之外的生存指南<br>大型网站技术架构：核心原理与案例分析<br>人性的弱点<br>IT Manager’s cookbook<br>Company_Mgt<br>SICPinpy<br>The Design Of Everyday Things<br>SpringCloud in Action<br>Java Concurrency in Practice<br>实战Java高并发程序设计<br>怎样解题<br>Java Network Programming 4th<br>Netty in Action<br>Data Structures and Algorithm Analysis in Java Third Edition<br>JGuide</p></blockquote><h2 id="2019"><a href="#2019" class="headerlink" title="2019"></a>2019</h2><blockquote><p>人类简史<br>大秦帝国<br>菜根谭<br>未来简史<br>漫话中国思想<br>Algorithm 4th<br>今日简史<br>xL_CraftOfSelfTeaching<br>xL_TimeAsAFriend<br>xL_Reborn<br>xL_WealthTheRoadToFreedom<br>Python for Data Analysis 2nd<br>围城<br>动物庄园<br>kH_P&amp;S<br>超越感觉<br>大规模分布式存储系统<br>码出高效：Java开发手册<br>Java开发手册<br>fy<br>JWeb<br>Deep Into JWeb<br>Concrete Mathematics 2nd(Overview)<br>aDiscipline<br>性能之巅<br>分布式服务框架原理与实践<br>分布式服务架构原理、设计与实战<br>平凡的世界<br>人生<br>在困难的日子里</p></blockquote><h2 id="2020"><a href="#2020" class="headerlink" title="2020"></a>2020</h2><blockquote><p>非暴力沟通<br>白夜行<br>恶意<br>嫌疑犯X的献身<br>Redis设计与实现2nd<br>人生的智慧<br>GoDoc<br>GoPL<br>原则<br>Advanced Go Programming<br>Concurrency in Go<br>PyT<br>解忧杂货店<br>GoInAction<br>穷查理宝典<br>黑客与画家<br>活着<br>左耳听风<br>Arc4th<br>文明的冲突与世界秩序的重建<br>重来<br>追风筝的人<br>月亮与六便士<br>清醒思考的艺术<br>简单逻辑学<br>H_JL/AB<br>重构<br>人性的枷锁<br>千面英雄<br>寻欢作乐<br>刀锋<br>面纱<br>基因之河<br>历史的教训<br>物种起源<br>沉思录<br>人类的起源<br>性的进化<br>八百万种死法<br>Arc_32<br>消失的13级台阶<br>自私的基因<br>数据密集型应用系统设计<br>枪炮、病菌与钢铁</p></blockquote><h2 id="2021"><a href="#2021" class="headerlink" title="2021"></a>2021</h2><blockquote><p>On Java 8<br>Algorithm Diagram<br>CrackingCI6th<br>哲学的故事<br>软件架构<br>宇宙的最后三分钟<br>边城<br>Effective Java 3rd<br>代码的未来<br>Go_Micro_In_Action<br>东野圭吾作品集(六部)<br>Go进阶<br>Kubernetes in Action<br>Life 3.0<br>巨人的陨落<br>Arc0<br>一只特立独行的猪<br>QR<br>Quarkus In Action<br>GoCore<br>随机漫步的傻瓜<br>微服务架构设计模式<br>羊皮卷<br>异类<br>Mastering Go<br>谈美书简<br>Go核心<br>Go并发之道<br>了不起的盖茨比<br>Go基础库<br>Go笔记<br>Go深入解析<br>写给大家看的设计书<br>红与黑<br>都嘟 I/II<br>罪与罚<br>生命之书</p></blockquote><h2 id="2022"><a href="#2022" class="headerlink" title="2022"></a>2022</h2><blockquote><p>GoDS<br>钢铁<br>老人与海<br>凤凰架构<br>gCore<br>FunMath4Programmer<br>全球通史<br>goHighPerf<br>Go101<br>OnJ8<br>pdai_Spring<br>SpringBoot_in_Action<br>横向领导力<br>wxb_01_沉默的大多数<br>wxb_02_我的精神家园<br>wxb_03_万寿寺<br>wxb_04_红拂夜奔<br>wxb_05_寻找无双/东宫西宫<br>wxb_06_黄金时代<br>wxb_07_白银时代<br>wxb_08_似水柔情<br>wxb_09_爱你就像爱生命<br>wxb_10_黑铁时代<br>SpringCore<br>Spring4<br>EJ3<br>音乐史<br>刻意练习<br>TaoOfStudy<br>CodeJ<br>ArcPhoenix<br>三体<br>企业应用架构模式<br>LaoZ<br>沟通的力量<br>txt_FR</p></blockquote><h2 id="2023"><a href="#2023" class="headerlink" title="2023"></a>2023</h2><blockquote><p>纳瓦尔<br>西方美学<br>白鹿原<br>凤凰项目<br>编程珠玑<br>沧浪之水<br>长安的荔枝<br>正面管教<br>韩信<br>Java并发78<br>懂<br>Java业务100<br>生活蒙太奇<br>xL_PublicSpeaking<br>Jvm核心32<br>Java性能21<br>我叫刘跃进<br>Java性能44<br>皮德漫画<br>一句顶一万句<br>奇怪的生物图鉴<br>是我把你弄哭了吗<br>中年之路:人格的第二次成型<br>Java核面39<br>漫画KP:冷知识<br>花小烙漫画:KP<br>父与子<br>无名之城<br>分布式45<br>人间一趟,尽兴而已<br>不白吃漫画：世界美食<br>不白吃漫画：中华美食<br>不白吃漫画：食物简史<br>我会永远抱紧你<br>置身事内：中国政府与经济发展<br>高并发22<br>柳林风声<br>蛤蟆先生去看心理医生<br>编程珠玑：续<br>先知<br>世界喧嚣我很好<br>猫咪会吃掉<strong>**</strong><br>人生玩家<br>Java性能权威指南（第二版）<br>子恺漫画全集<br>明天又要上班了<br>小王子<br>谁能拒绝一只快乐小狗呢<br>狗狗心事绘本<br>书单狗：聪明与笨蛋<br>在路上<br>白希那治愈X想象力·经典绘本系列<br>txt_幽MX途<br>厚HX<br>时间是良药<br>智慧的疆界<br>围炉夜话<br>小窗幽记</p></blockquote><h2 id="2024"><a href="#2024" class="headerlink" title="2024"></a>2024</h2><blockquote><p>Programmer_Math_Base<br>认知觉醒<br>久远DoT<br>被讨厌的勇气<br>Arc_许式伟<br>人间值得<br>活得通透<br>时间从来不语<br>半小时漫画(16)<br>金PM<br>C_Pointer<br>故乡、死亡<br>HY_X秦J<br>OnJ_Base<br>OnJ_Pro<br>家人闲坐灯火可亲<br>逍遥游<br>杀死一只知更鸟<br>哲学家们到底在干什么<br>罗素论幸福<br>人生第一次<br>杨绛传<br>乔布斯传<br>差一点就FC了<br>羊脂球<br>HTR_A_Book<br>BC的人_但这并不容易<br>看你一眼就会笑<br>太白金星有点烦<br>草原动物园<br>度量<br>漫长岁月，没有一天是适合上班的<br>胖虎下山<br>发现的乐趣<br>你好，我是费曼<br>WMS_JDA_Overview<br>架构整洁之道<br>筚路维艰<br>无用之美<br>孙子<br>白石老人自述<br>乡土中国</p></blockquote><h1 id="Mistery"><a href="#Mistery" class="headerlink" title="Mistery"></a><em>Mistery</em></h1><h2 id="Philosophy-amp-Math"><a href="#Philosophy-amp-Math" class="headerlink" title="Philosophy &amp; Math"></a>Philosophy &amp; Math</h2><blockquote><p>数学之美</p></blockquote><h2 id="Computer-Science"><a href="#Computer-Science" class="headerlink" title="Computer Science"></a>Computer Science</h2><blockquote><p>代码之美/算法导论3rd<br>代码整洁之道/程序员的职业素养/敏捷整洁之道<br>Go原本/Go设计与实现</p></blockquote><h2 id="Literature-amp-Art"><a href="#Literature-amp-Art" class="headerlink" title="Literature &amp; Art"></a>Literature &amp; Art</h2><h2 id="Natural-amp-Social-Science"><a href="#Natural-amp-Social-Science" class="headerlink" title="Natural &amp; Social Science"></a>Natural &amp; Social Science</h2><h1 id="Present"><a href="#Present" class="headerlink" title="Present"></a><em>Present</em></h1>]]></content>
      
      <categories>
          
          <category> Book </category>
          
      </categories>
      
      
        <tags>
            
            <tag> List </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>游戏列表</title>
      <link href="/2017/06/16/game-list/"/>
      <url>/2017/06/16/game-list/</url>
      <content type="html"><![CDATA[<h1 id="History"><a href="#History" class="headerlink" title="History"></a><em>History</em></h1><blockquote><p>GB Tetris<br>FC<a id="more"></a><br>红警 2/3<br>实况足球 2000(PS)/2017<br>反恐精英 1.5/GO<br>暗黑破坏神 II/III/II:重置/III(NS)/不朽/IV<br>德军总部 重返/新秩序(T)/旧血脉(T)/2:新巨人<br>拳皇 97/13<br>波斯王子 1/2(T)/3(T)/4<br>刺客信条系列<br>恶魔城 月下/白夜/晓月/宿命镜面HD<br>刀剑封魔录<br>地牢围攻 1/2/3<br>魔兽 3<br>热血江湖<br>街头篮球<br>鬼泣 3/DMC/5<br>尾行 3<br>DOTA 1/2<br>孤岛危机 1/2/3<br>无主之地 1/2/前传/传说/3<br>暗黑血统 1/3<br>极品飞车 9/12/16/17/18/19/20/21/22<br>时空幻境(Braid)<br>闪客 1/2<br>魔兽世界<br>小小忍者<br>泰坦之旅<br>X战警前传:金刚狼<br>阿凡达<br>火炬之光 1/2<br>星际 1/2（剧情）<br>军团要塞 2<br>炉石传说<br>风暴英雄<br>古墓 9/10/11<br>劳拉 光之守护者/奥西里斯神庙<br>看门狗 1/2(T)<br>火箭联盟<br>侠盗猎车手 5<br>马克思佩恩 3<br>奥日 1/2<br>流放之路(Path of Exile)<br>守望先锋<br>孤岛惊魂 3/4/原始杀戮<br>辐射 4<br>DOOM 4/ETERNAL<br>战地 1-重启/5<br>热血无赖<br>猎天使魔女<br>星际战甲(Warframe)<br>死亡细胞(DeadCell)<br>尼尔 机械纪元<br>迸发(The Surge)<br>巫师 1(T)/2/昆特牌/3<br>Limbo/Inside(V)<br>神奇小子:龙之陷阱(V)<br>掠食(Prey)(T)<br>Alien Swarm:Reactive Drop<br>尘埃 4/拉力赛<br>Argo<br>维克多弗兰<br>量子破碎<br>子弹风暴 重制版<br>FIFA 17/20<br>Paladins<br>使命召唤 现代战争重制版/10/11/12/13/14<br>质量效应 1/2/3/仙女座(V&amp;T)<br>伊森卡特的消失(V)<br>谋杀:灵魂疑犯(V)<br>艾迪芬奇的记忆(V)<br>勇敢的心:世界大战(V)<br>战神:夜袭(T)<br>消逝的光芒(T)<br>神界原罪 1/2(T)<br>小小噩梦 1/2(V)<br>猎人<br>赛车计划<br>雷电V导演剪辑版<br>黑暗之魂 1/2/3<br>仁王 1/2<br>影子战术将军之刃<br>狼刃<br>大神绝景版<br>绝地求生大逃杀<br>战争机器 4<br>二之国 2<br>索尼克-力量<br>罗马之子<br>真三国无双 8<br>迪托之剑<br>冰汽时代<br>电脑装机模拟<br>影武者 2<br>狙击精英 4<br>幽灵行动:荒野<br>欧卡 2<br>Steep<br>堕落之主2014<br>传说法师<br>底特律:变人<br>MotoGP 18<br>Deiland<br>恐怖黎明<br>Aragami<br>ICEY<br>Hob<br>太吾绘卷<br>CrossCode<br>波西亚时光<br>命运 2<br>怪物猎人:世界<br>血源诅咒(V)<br>Vampyr(V)<br>地平线:黎明时分(V)<br>只狼<br>逃出生天(V)<br>中土世界 暗影魔多/战争之影(T)<br>奇异人生(V)<br>狂怒 2<br>Dota Underlord<br>地铁:2033(T)/最后的曙光(T)/离去(T)<br>心灵杀手(T)<br>蝙蝠侠阿卡姆系列(T)<br>羞辱(T)<br>S.T.A.L.K.E.R(T)<br>兄弟双子故事(V)<br>上古卷轴1-5(T)<br>疯狂的麦克斯(T)<br>极限竞速:地平线 3/4<br>黑道圣徒 2/3/4(T)<br>荣耀战魂<br>血污:夜之仪式<br>文明 5/6<br>盐和避难所(T)<br>半条命 1/2(V)<br>求生之路 1/2(V)<br>三位一体 1/2/3(V)<br>生化奇兵 1(T)/2(T)/无限<br>空洞骑士(T)<br>雷曼 起源/传奇<br>茶杯头<br>Bastion<br>Transistor<br>传送门<br>战争机器5<br>荒野大镖客2<br>Unravel 1/2<br>绝地-陨落的武士团<br>星战:前线 1/2<br>Titanfall 2<br>Wolcen<br>raksasi<br>Katana ZERO<br>龙珠Z:卡卡罗特<br>命运石之门<br>Hades<br>Terraria<br>塞尔达传说:旷野之息<br>GBA_Super Mario Bros.<br>GBA_Super Mario Bros.2<br>GBA_Super Mario Advance.<br>NDS_New Super Mario Bros.<br>钢铁收割<br>天穗之咲稻姬<br>恶魔之魂(V)<br>Cyberpunk2077<br>微软模拟飞行<br>原神<br>Mobile_王者<br>Mobile_泰坦之旅<br>Subverse<br>往日不再<br>原型 1/2<br>战神4<br>SIFU<br>吸血鬼幸存者<br>Elden.Ring<br>Kena<br>Haven<br>ToTheMoon<br>Chorus<br>海之号角<br>刺客信条:英灵殿<br>忍者神龟:施莱德的复仇<br>ENDER.LILIES.Quietus.of.the.Knights<br>Switch_Mario3D<br>NDS_恶魔城苍月/刻印/肖像<br>NDS_洛克人ZXAdvent<br>NDS_合金弹头7<br>NDS_冒险岛<br>火炬之光:无限<br>MagicRampage<br>Ella’s Dimension<br>纪念碑谷 1/2<br>死亡回归<br>洛克人 11<br>光环:无限/All(V)<br>原子之心<br>博德之门 1/2(V)<br>看火人(V)<br>最后纪元<br>博德之门 3<br>机战佣兵™VI 境界天火™<br>龙腾世纪:审判<br>星空<br>永劫无间<br>堕落之主<br>Lies of P<br>极品飞车不羁<br>龙之信条2<br>TownScaper<br>COCOON<br>恶意不息(EA)<br>波斯王子:失落的王冠<br>ABZU<br>Arise: A Simple Story<br>After US<br>Flower<br>Journey<br>蟹蟹寻宝奇遇<br>暗影火炬城<br>数字魅影: 极限竞赛<br>VRising<br>无间冥寺<br>Mobile_Vivid Knight<br>Mobile_恶果之地<br>Mobile_SotN<br>Mobile_泰坦之旅<br>Mobile_Kingdom Rush 1/Frontier/Origins<br>Mobile_DeadCells<br>Mobile_Cytus<br>Mobile_Balatro<br>Mobile_怒之铁拳4<br>Mobile_爷爷的城市(V)<br>Mobile_星露谷物语(V)<br>Mobile_A Dance of Fire and Ice<br>Mobile_几何冲刺<br>Balatro<br>怒之铁拳4<br>对马岛之魂<br>以撒的结合(V)<br>记忆边境<br>地平线:西之绝境(V)<br>蜘蛛侠:迈尔斯(V)<br>蜘蛛侠:重置版(V)<br>Trine5(V)<br>极乐迪斯科(V)<br>完美音浪<br>最后生还者:I/II(V)<br>极限竞速:地平线 5<br>FIFA23<br>Switch_星之卡比:探索发现<br>黑神话:悟空<br>Deadlock(Pre)<br>瘟疫传说:无罪/安魂曲<br>勇敢的哈克<br>龙背3/龙背1/尼尔:人工生命(V)<br>战神5<br>Mandragora(Demo)<br>勇敢小骑士<br>最终幻想7:重制(V)<br>死亡搁浅(V)<br>龙腾世纪:影障守护者<br>Typing Survival<br>Art of War:Red Tides<br>Shooterspool<br>CueClub2<br>Snooker 19<br>瑞奇与叮当:时空跳转<br>Mobile_Snooker<br>Mobile_Snooker Stars<br>Mobile_Pool Break Lite<br>Mobile_Pro Pool 2023</p></blockquote><h1 id="Mistery"><a href="#Mistery" class="headerlink" title="Mistery"></a><em>Mistery</em></h1><blockquote><h2 id="角色"><a href="#角色" class="headerlink" title="角色"></a>角色</h2><p>昭和米国物語(2025)<br>明末:渊虚之羽(2025)<br>泰坦之旅2(TBD)<br>达巴:水痕之地(TBD)<br>影之刃零(TBD)<br>塞尔达传说:王国之泪<br>荒野大镖客:1/2</p><h2 id="独立"><a href="#独立" class="headerlink" title="独立"></a>独立</h2><p>Mandragora(2024-12)<br>银河战士:生存恐惧<br>动物井<br>传说之下<br>双人成行</p><h2 id="竞技"><a href="#竞技" class="headerlink" title="竞技"></a>竞技</h2></blockquote><h1 id="Present"><a href="#Present" class="headerlink" title="Present"></a><em>Present</em></h1><h2 id="Nintendo"><a href="#Nintendo" class="headerlink" title="Nintendo"></a>Nintendo</h2><p>Switch<br>WiiU<br>Wii<br>3DS<br>NDS<br>GBA<br>Arcade</p><h2 id="Diablo4"><a href="#Diablo4" class="headerlink" title="Diablo4"></a>Diablo4</h2><h3 id="S0"><a href="#S0" class="headerlink" title="S0"></a>S0</h3><p>sor(100): icmyfuture<br>rog(088): icmyfuture(deleted)</p><h3 id="S1-恶念魔"><a href="#S1-恶念魔" class="headerlink" title="S1: 恶念魔"></a>S1: 恶念魔</h3><p>nec(084): icmyfuture(deleted)<br>dru(078): icmyfuture(deleted)<br>bar(075): icmyfuture(deleted)</p><h3 id="S2-鲜血"><a href="#S2-鲜血" class="headerlink" title="S2: 鲜血"></a>S2: 鲜血</h3><p>sor(100): 庐山烟雨浙江潮(deleted)<br>bar(100): 庐山烟雨浙江潮(deleted)<br>nec(100): 庐山烟雨浙江潮(deleted)<br>rog(100): 庐山烟雨浙江潮(deleted)<br>sor(100): icmyfuture(HC)</p><h3 id="S3-构造体"><a href="#S3-构造体" class="headerlink" title="S3: 构造体"></a>S3: 构造体</h3><p>sor(100): 魔法披风(deleted)</p><h3 id="S4-PTR"><a href="#S4-PTR" class="headerlink" title="S4: PTR"></a>S4: PTR</h3><p>sor(100): icmyfuture(deleted)<br>rog(100): icmyfuture(deleted)<br>nec(100): icmyfuture(deleted)</p><h3 id="S4-寻宝重生"><a href="#S4-寻宝重生" class="headerlink" title="S4:寻宝重生"></a>S4:寻宝重生</h3><p>sor(100): uZHanMiuLR(deleted)<br>nec(100): uZHanMiuLC(deleted)<br>rog(100): uZHanMiuLG(deleted)<br>bar(100): uZHanMiuLJ(deleted)<br>dru(100): icmyfuture(deleted)</p><h3 id="S5-PTR"><a href="#S5-PTR" class="headerlink" title="S5: PTR"></a>S5: PTR</h3><p>sor(100): KantDueT(deleted)</p><h3 id="S5-炼狱魔潮"><a href="#S5-炼狱魔潮" class="headerlink" title="S5: 炼狱魔潮"></a>S5: 炼狱魔潮</h3><p>sor(100): KantDueT(deleted)</p><h3 id="S6-憎恨崛起-DLC1"><a href="#S6-憎恨崛起-DLC1" class="headerlink" title="S6: 憎恨崛起(DLC1)"></a>S6: 憎恨崛起(DLC1)</h3><p>spb(60): 未竟<br>sor(60): 未竟<br>rog(60): 未竟</p>]]></content>
      
      <categories>
          
          <category> Game </category>
          
      </categories>
      
      
        <tags>
            
            <tag> List </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
